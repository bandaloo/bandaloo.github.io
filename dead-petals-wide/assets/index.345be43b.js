(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const x of o.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&n(x)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();function be(e){throw new Error(e!==void 0?`${e} was unexpectedly nullish`:"unexpected nullish value")}function zs(e,t){const r=new Array(e);for(let n=0;n<e;n++)r[n]=t();return r}function Kt(e,t,r){const[n,s]=[e.x,t.x],[o,x]=[e.y,t.y];for(let f=n;f<=s;f++)for(let l=o;l<=x;l++)r(f,l)}function Xt(e,t){let r=0;for(const n of e)t(n)&&(e[r]=n,r++);e.length=r}function $(e,t){return e+Math.random()*(t-e)}function qs(e){if(e[0]==="#"&&(e=e.slice(1)),e.length!==3&&e.length!==6)throw new Error("invalid length for hex color");const t=e.length===3?1:2,r=t===2?e.match(/../g):e.match(/./g);if(r===null)throw new Error("no match in color");const n=r.map(s=>parseInt(s,16)/(t===1?15:255));if(n.includes(NaN))throw new Error("not a valid color");if(n.length!==3)throw new Error("bad vec length");return n}function tt(e,t,r){const n=1-r;return e*n+t*r}function Ys(e,t,r){const n=1-r;return[e[0]*n+t[0]*r,e[1]*n+t[1]*r]}function zn(e,t,r){const n=1-r;return[e[0]*n+t[0]*r,e[1]*n+t[1]*r,e[2]*n+t[2]*r]}function Vs(e){return Math.floor(e)%2===0?e%1:1-e%1}function Ks(e,t){if(e.length!==t.length)throw new Error("array lengths not correct sizes");const r=[];for(let n=0;n<e.length;n++)r.push([e[n],t[n]]);return r}const Xs=e=>.5*(Math.sin(Math.PI/2*(2*e-1))+1),$s={black:"#000000",navy:"#000080",darkblue:"#00008B",mediumblue:"#0000CD",blue:"#0000FF",darkgreen:"#006400",green:"#008000",teal:"#008080",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",lime:"#00FF00",springgreen:"#00FF7F",aqua:"#00FFFF",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",rebeccapurple:"#663399",mediumaquamarine:"#66CDAA",dimgray:"#696969",dimgrey:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",slategrey:"#708090",lightslategray:"#778899",lightslategrey:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",maroon:"#800000",purple:"#800080",olive:"#808000",gray:"#808080",grey:"#808080",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370DB",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",silver:"#C0C0C0",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",palevioletred:"#DB7093",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",red:"#FF0000",fuchsia:"#FF00FF",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",yellow:"#FFFF00",lightyellow:"#FFFFE0",ivory:"#FFFFF0",white:"#FFFFFF"};function Zs(e){const t={};for(const[r,n]of Object.entries(e)){const s=r;t[s]=qs(n)}return t}const js=Zs($s);class L{_data;topLeftBrightness=0;middleBrightness=0;bottomRightBrightness=0;constructor(t,r,n){this._data=[t,r,n]}static hsl(t,r,n){return new L(0,0,0).setHsl(t,r,n)}static rgb(t,r,n){return new L(t,r,n)}static named(t){return new L(...js[t])}static WHITE_DATA=[1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0];get data(){return this._data}copy(){return new L(...this._data).setBrightnesses(this.topLeftBrightness,this.middleBrightness,this.bottomRightBrightness)}setHsl(t,r,n){let s=r*Math.min(n,1-n),o=(x,f=(x+t/30)%12)=>n-s*Math.max(Math.min(f-3,9-f,1),-1);return this._data=[o(0),o(8),o(4)],this}setRgb(t,r,n){return this._data=[t,r,n],this}setBrightnesses(t,r,n){return this.topLeftBrightness=t,this.middleBrightness=r,this.bottomRightBrightness=n,this}get r(){return this._data[0]}get g(){return this._data[1]}get b(){return this._data[2]}setR(t){return this._data[0]=t,this}setG(t){return this._data[1]=t,this}setB(t){return this._data[2]=t,this}get h(){const t=Math.max(this.r,this.g,this.b),r=t-Math.min(this.r,this.g,this.b);let n=r&&(t==this.r?(this.g-this.b)/r:t==this.g?2+(this.b-this.r)/r:4+(this.r-this.g)/r);return 60*(n<0?n+6:n)}get s(){const t=Math.max(this.r,this.g,this.b),r=t-Math.min(this.r,this.g,this.b),n=1-Math.abs(t+t-r-1);return n?r/n:0}get l(){const t=Math.max(this.r,this.g,this.b),r=t-Math.min(this.r,this.g,this.b);return(t+t-r)/2}setH(t){return this.setHsl(t,this.s,this.l),this}setS(t){return this.setHsl(this.h,t,this.l),this}setL(t){return this.setHsl(this.h,this.s,t),this}toVertexDataForQuad(){return[this.r,this.g,this.b,this.topLeftBrightness,this.r,this.g,this.b,this.middleBrightness,this.r,this.g,this.b,this.middleBrightness,this.r,this.g,this.b,this.middleBrightness,this.r,this.g,this.b,this.middleBrightness,this.r,this.g,this.b,this.bottomRightBrightness]}}function Ae(e){return[Math.cos(e),Math.sin(e)]}function Oe(e,t,r){return e<t?t:e>r?r:e}function Qs(e,t){return(e%t+t)%t}function Js(e,t,r){return(e-t)/(r-t)}function eo(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}class he{data;constructor(t,r){this.data=[t,r]}get x(){return this.data[0]}get y(){return this.data[1]}get lengthSquared(){return this.x**2+this.y**2}get length(){return Math.sqrt(this.lengthSquared)}clone(){return new he(this.x,this.y)}equals(t){return this.x===t.x&&this.y===t.y}equalsComps(t,r=t){return this.x===t&&this.y===r}add(t){return new he(this.x+t.x,this.y+t.y)}addComps(t,r=t){return new he(this.x+t,this.y+r)}mult(t){return new he(this.x*t.x,this.y*t.y)}multComps(t,r=t){return new he(this.x*t,this.y*r)}sub(t){return new he(this.x-t.x,this.y-t.y)}subComps(t,r=t){return new he(this.x-t,this.y-r)}div(t){return new he(this.x/t.x,this.y/t.y)}divComps(t,r=t){return new he(this.x/t,this.y/r)}round(){return new he(Math.round(this.x),Math.round(this.y))}floor(){return new he(Math.floor(this.x),Math.floor(this.y))}ceil(){return new he(Math.ceil(this.x),Math.ceil(this.y))}clamp(t,r){return new he(Oe(this.x,t.x,r.x),Oe(this.y,t.y,r.y))}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}normalize(){const t=this.length;if(t!==0)return new he(this.x/t,this.y/t)}normalizeOrZero(){const t=this.length;return t===0?Q:new he(this.x/t,this.y/t)}normalizeOrThrow(){const t=this.length;if(t===0)throw new Error("cannot normalize zero vector");return new he(this.x/t,this.y/t)}rotate(t){const[r,n]=Ae(t);return new he(this.x*r-this.y*n,this.x*n+this.y*r)}angleBetween(t){if(t.length*this.length!==0)return Math.acos(t.dot(this)/(t.length*this.length))}}function h(e,t){return new he(e,t)}const Q=h(0,0),Q0=h(1,1),to=h(2,2),ro=h(3840,1080),pe=ro.divComps(4),ft=pe.multComps(.75,1),no=.01,$t=.03,so=.1,oo=.2,ao=.3,io=.4,Ar=.5,co=3,lo=12,J0=100,G0=200,qe=(()=>({left:-ft.x/2+4,right:ft.x/2-4,bottom:-ft.y/2+4,top:ft.y/2-8-4}))(),ho=(()=>{const e=lo/2-co;return{left:qe.left+e,right:qe.right-e,bottom:qe.bottom+e,top:qe.top-e}})(),me=[.4,0,-.4],er=L.rgb(0,1,1).setBrightnesses(1,0,-.5),qn=L.rgb(1,0,1).setBrightnesses(1,0,-.5),De="__UNIT";function Ft(e,t,r){const n={};return n[r]=t,Object.assign(e,n)}class tr{constructor(t){this.key=t}is(t){return t[this.key]!==void 0}remove(t){return delete t[this.key],t}}class de extends tr{add(t,r){return Ft(t,r,this.key)}}class fo extends de{constructor(t,r){super(t),this.init=r}add(t){return Ft(t,this.init(t),this.key)}}class kr extends tr{constructor(t,r){super(t),this.init=r}add(t,r){return Ft(t,this.init(r),this.key)}}class Pe extends de{constructor(t,r){super(t),this.prereq=r}add(t,r){if(!this.prereq.is(t))throw new Error(`${String(this.key)} comp missing ${String(this.prereq.key)} comp`);return super.add(t,r)}is(t){return super.is(t)}}class He extends Pe{constructor(t,r,n){super(t,r),this.prereq2=n}add(t,r){if(!this.prereq2.is(t))throw new Error(`${String(this.key)} comp missing ${String(this.prereq2.key)} comp`);return super.add(t,r)}is(t){return super.is(t)}}class Ce extends tr{constructor(t,r){super(t),this.unit=r}add(t){return Ft(t,this.unit,this.key)}}var u;(e=>{e.Pos=new de("pos"),e.Vel=new de("vel"),e.Acc=new de("acc"),e.ResetAcc=new Ce("resetAcc",De),e.Gravity=new de("gravity"),e.MaxSpeed=new de("maxSpeed"),e.Drag=new de("drag"),e.AngleVel=new de("angleVel"),e.ScaleVel=new de("scaleVel"),e.AngleInDirection=new Ce("angleInDirection",De),e.Orbital=new Pe("orbital",e.Pos),e.Sprite=new de("sprite"),e.Hidden=new de("hidden"),e.FaceHorizontally=new He("faceHorizontally",e.Vel,e.Sprite),e.Tweened=new fo("tweened",t=>({pos:void 0,prev:void 0})),e.Ticks=new Ce("ticks",0),e.Lifetime=new Pe("lifetime",e.Ticks),e.SpawnOnDestroy=new Pe("spawnOnDestroy",e.Pos),e.SpawnOnTick=new He("spawnOnTick",e.Ticks,e.Pos),e.MixColor=new Pe("mixColor",e.Ticks),e.Rainbow=new Pe("rainbow",e.Ticks),e.Animate=new kr("animate",t=>({...t,_counter:0})),e.AnimateWithSpeed=new Pe("animateWithSpeed",e.Vel),e.Destroyed=new Ce("destroyed",De),e.DestroyIfSmall=new Ce("destroyIfSmall",De),e.Text=new de("text"),e.CircleCollider=new de("circleCollider"),e.GrowingCollider=new Pe("growingCollider",e.CircleCollider),e.Nudge=new He("nudge",e.Pos,e.CircleCollider),e.AccelerateTo=new He("accelerateTo",e.Acc,e.Pos),e.Wander=new He("wander",e.Vel,e.Acc),e.StayInside=new He("stayInside",e.Pos,e.CircleCollider),e.DestroyInside=new He("destroyAtBounds",e.Pos,e.CircleCollider),e.ReverseAtBounds=new Ce("reverseAtBounds",De),e.Menu=new kr("menu",t=>Object.assign(t,{_selectionIndex:0,_parent:void 0})),e.Named=new de("named")})(u||(u={}));const uo=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Space","Tab"];function z0(e,t,r,n){return h((e?-1:0)+(t?1:0),(r?-1:0)+(n?1:0)).normalize()??Q}function Me(){return{held:!1,pressed:!1,released:!1}}function Ge(e){e.held=!1,e.pressed=!1,e.released=!1}function ue(e,t){e.pressed=!e.held&&t,e.released=e.held&&!t,e.held=t}function xo(){return{primaryButton:Me(),secondaryButton:Me(),leftShoulderButton:Me(),rightShoulderButton:Me(),left:Me(),right:Me(),down:Me(),up:Me(),leftStick:Q,rightStick:Q,start:Me()}}function po(e){Ge(e.primaryButton),Ge(e.secondaryButton),Ge(e.leftShoulderButton),Ge(e.rightShoulderButton),Ge(e.left),Ge(e.right),Ge(e.down),Ge(e.up),e.leftStick=Q,e.rightStick=Q}class Yn{_controlState=xo();get controlState(){return this._controlState}}function mo(){return{moveLeft:!1,moveRight:!1,moveDown:!1,moveUp:!1,shootLeft:!1,shootRight:!1,shootDown:!1,shootUp:!1,okay:!1,back:!1,shoot:!1,dash:!1,useItem:!1,pause:!1}}const vo=0,go=2;function _o(e,t,r){const{left:n,top:s,width:o,height:x}=t.getBoundingClientRect(),f=x/o,l=r.y/r.x,c=h(e.clientX-n,e.clientY-s).divComps(o,x);return h(c.x,1-c.y).subComps(.5,.5).multComps(1,f/l).mult(r)}class vt extends Yn{constructor(t,r){super(),this.renderRes=r,this.addMouseMoveListener(t),this.addKeyListener("keyup",t),this.addKeyListener("keydown",t),this.addMouseButtonListener("mousedown",t),this.addMouseButtonListener("mouseup",t),document.addEventListener("keydown",n=>{const s=n.key;uo.includes(s)?n.preventDefault():s==="F"&&document.body.requestFullscreen()})}keyboardAndMouseState=mo();_mousePos=Q;switchDash=!1;get mousePos(){return this._mousePos}addMouseMoveListener(t){t.addEventListener("contextmenu",r=>{r.preventDefault()}),document.addEventListener("mousemove",r=>{this._mousePos=_o(r,t,this.renderRes)})}addFullscreenExitCallback(t){document.addEventListener("fullscreenchange",r=>{document.fullscreenElement===null&&t()})}addKeyListener(t,r){const n=t==="keydown",s=()=>{r.style.cursor!=="none"&&(r.style.cursor="none")};document.addEventListener(t,o=>{switch(o.key){case"Escape":o.preventDefault(),this.keyboardAndMouseState.pause=n,this.keyboardAndMouseState.back=n;return;case"w":case"W":this.keyboardAndMouseState.moveUp=n;break;case"a":case"A":this.keyboardAndMouseState.moveLeft=n;break;case"s":case"S":this.keyboardAndMouseState.moveDown=n;break;case"d":case"D":this.keyboardAndMouseState.moveRight=n;break;case"ArrowUp":this.keyboardAndMouseState.shootUp=n,s();break;case"ArrowLeft":this.keyboardAndMouseState.shootLeft=n,s();break;case"ArrowDown":this.keyboardAndMouseState.shootDown=n,s();break;case"ArrowRight":this.keyboardAndMouseState.shootRight=n,s();break;case"Enter":case"e":case"E":this.keyboardAndMouseState.okay=n;break;case"Tab":case"q":case"Q":this.keyboardAndMouseState.back=n;break;case"P":case"p":this.keyboardAndMouseState.pause=n;break;case"Shift":this.switchDash?this.keyboardAndMouseState.dash=n:this.keyboardAndMouseState.useItem=n;break;case" ":case"Space":this.switchDash?this.keyboardAndMouseState.useItem=n:this.keyboardAndMouseState.dash=n;break}})}addMouseButtonListener(t,r){const n=t==="mousedown";document.addEventListener(t,s=>{switch(r.style.cursor!=="crosshair"&&(r.style.cursor="crosshair"),s.button){case vo:this.keyboardAndMouseState.shoot=n;break;case go:this.keyboardAndMouseState.dash=n;break}})}calcStickDirectionFromKeys(t,r,n,s){return h((t?-1:0)+(r?1:0),(n?-1:0)+(s?1:0)).normalizeOrZero()}update(){this._controlState.leftStick=z0(this.keyboardAndMouseState.moveLeft,this.keyboardAndMouseState.moveRight,this.keyboardAndMouseState.moveDown,this.keyboardAndMouseState.moveUp),this._controlState.rightStick=z0(this.keyboardAndMouseState.shootLeft,this.keyboardAndMouseState.shootRight,this.keyboardAndMouseState.shootDown,this.keyboardAndMouseState.shootUp),ue(this._controlState.left,this.keyboardAndMouseState.moveLeft||this.keyboardAndMouseState.shootLeft),ue(this._controlState.right,this.keyboardAndMouseState.moveRight||this.keyboardAndMouseState.shootRight),ue(this._controlState.down,this.keyboardAndMouseState.moveDown||this.keyboardAndMouseState.shootDown),ue(this._controlState.up,this.keyboardAndMouseState.moveUp||this.keyboardAndMouseState.shootUp),ue(this._controlState.primaryButton,this.keyboardAndMouseState.okay),ue(this._controlState.secondaryButton,this.keyboardAndMouseState.back),ue(this._controlState.leftShoulderButton,this.keyboardAndMouseState.dash),ue(this._controlState.rightShoulderButton,this.keyboardAndMouseState.useItem),ue(this._controlState.start,this.keyboardAndMouseState.pause)}}class Vn extends Yn{constructor(t,r,n,s){super(),this.gamepadNum=t,this.deadzone=r,this.fullTiltZone=n,this.numAngles=s,this._connected=!1}_connected;get connected(){return this._connected}calcDirectionFromRawStickVec(t){if(t.length<this.deadzone)return"neutral";const r=Math.atan2(t.y,t.x);return Math.abs(r)>3*Math.PI/4?"left":r>Math.PI/4?"up":r>-Math.PI/4?"right":"down"}sanitizeStickVec(t){const r=t.length;if(r<this.deadzone)return Q;const n=r>this.fullTiltZone?1:Js(r,this.deadzone,this.fullTiltZone),s=Math.atan2(t.y,t.x),o=Math.round(this.numAngles*s/(2*Math.PI)),x=2*Math.PI/this.numAngles,f=o*x,[l,i]=Ae(f);return h(l,i).normalizeOrThrow().multComps(n)}update(){const t=navigator.getGamepads()[this.gamepadNum];if(t==null){po(this._controlState),this._connected=!1;return}this._connected=!0,ue(this._controlState.primaryButton,t.buttons[0].pressed),ue(this._controlState.secondaryButton,t.buttons[1].pressed),ue(this._controlState.leftShoulderButton,t.buttons[4].pressed),ue(this._controlState.rightShoulderButton,t.buttons[5].pressed),ue(this._controlState.start,t.buttons[9].pressed);const r=h(t.axes[0],-t.axes[1]),n=z0(t.buttons[14].pressed,t.buttons[15].pressed,t.buttons[13].pressed,t.buttons[12].pressed),s=r.length>n.length?r:n,o=this.calcDirectionFromRawStickVec(s);this._controlState.leftStick=this.sanitizeStickVec(s),ue(this._controlState.left,o==="left"),ue(this._controlState.right,o==="right"),ue(this._controlState.down,o==="down"),ue(this._controlState.up,o==="up");const x=h(t.axes[2],-t.axes[3]);this._controlState.rightStick=x}}class bo{constructor(t,r,n){this.keyboardControlManager=t,this.gamepad1ControlManager=r,this.gamepad2ControlManager=n}update(){this.keyboardControlManager.update(),this.gamepad1ControlManager.update(),this.gamepad2ControlManager.update()}get(t,r){return t===1?this.gamepad1ControlManager.connected?this.gamepad1ControlManager:this.keyboardControlManager:this.gamepad2ControlManager.connected?this.gamepad2ControlManager:this.gamepad1ControlManager.connected?this.keyboardControlManager:void 0}}class J{_entityBrand=null}var H;(e=>{(t=>{t[t.DASH_INVINCIBLE=0]="DASH_INVINCIBLE",t[t.DASH_COOLDOWN=1]="DASH_COOLDOWN",t[t.NONE=2]="NONE"})(e.DashState||(e.DashState={})),e.Player=new He("player",u.Pos,u.Vel),e.Health=new de("health"),e.MaxHealth=new de("maxHealth"),e.Enemy=new Ce("enemy",De),e.Spawner=new Ce("spawner",De),e.Boss=new Pe("boss",e.Health),e.Bullet=new de("bullet"),e.Explode=new de("explode"),e.Shoot=new Pe("shoot",u.Pos),e.Revenge=new de("revenge"),e.DidDamage=new Ce("didDamage",De),e.Disappeared=new Ce("disappeared",De),e.AnimateWithHealth=new He("animateWithHealth",u.Sprite,e.Health),e.Gem=new de("gem"),e.BulletCancel=new de("bulletCancel"),e.BossDrop=new Pe("bossDrop",u.Ticks),e.Charmed=new Ce("charmed",De),e.Shadow=new Ce("shadow",De),e.Points=new de("points")})(H||(H={}));class U{constructor(t,r){this.dimensions=t,this.locations=r}}var O;(e=>{e.thirdEye=new U(h(56,56),[h(1,1),h(59,1),h(117,1)]),e.bubble=new U(h(32,32),[h(175,1)]),e.bulletExplosion=new U(h(32,32),[h(209,1),h(1,59),h(35,59),h(69,59)]),e.circleDiameter32=new U(h(32,32),[h(103,59)]),e.closedEyeOutline=new U(h(32,18),[h(175,35)]),e.kevin=new U(h(32,32),[h(137,59),h(171,59),h(205,59)]),e.largerEyeOutline=new U(h(32,18),[h(209,35)]),e.window=new U(h(32,32),[h(1,93),h(35,93),h(69,93)]),e.alarmClock=new U(h(24,24),[h(103,93),h(129,93)]),e.basketball=new U(h(24,24),[h(155,93)]),e.circleDiameter24=new U(h(24,24),[h(181,93)]),e.eyeOutline=new U(h(24,16),[h(207,93)]),e.football=new U(h(24,16),[h(1,127)]),e.scribbleMask=new U(h(24,24),[h(1,145),h(27,145),h(53,145)]),e.sop=new U(h(24,24),[h(79,145)]),e.head=new U(h(23,24),[h(105,145)]),e.lobotomy=new U(h(23,24),[h(130,145)]),e.bugaloo=new U(h(18,18),[h(155,145),h(175,145)]),e.circleDiameter18=new U(h(18,18),[h(195,145)]),e.baseball=new U(h(16,16),[h(239,59)]),e.bigGem=new U(h(16,16),[h(233,93)]),e.chessPieces=new U(h(16,16),[h(27,127),h(45,127),h(63,127),h(81,127),h(99,127)]),e.circleDiameter16=new U(h(16,16),[h(117,127)]),e.die=new U(h(16,16),[h(135,127),h(153,127),h(171,127),h(189,127),h(207,127),h(225,127)]),e.duck=new U(h(16,16),[h(215,145),h(233,145)]),e.eyeBase=new U(h(16,8),[h(239,77)]),e.eyesHoles=new U(h(16,8),[h(1,171),h(19,171)]),e.flower=new U(h(16,16),[h(1,181),h(19,181)]),e.headBear=new U(h(16,16),[h(37,181)]),e.headCat=new U(h(16,16),[h(55,181)]),e.headGoat=new U(h(16,16),[h(73,181)]),e.headTriangle=new U(h(16,16),[h(91,181)]),e.iceCream=new U(h(16,16),[h(109,181)]),e.pill=new U(h(16,8),[h(37,171)]),e.puff=new U(h(16,16),[h(127,181)]),e.scribbleCornerEye=new U(h(16,16),[h(145,181)]),e.spawnerTarget=new U(h(16,16),[h(163,181)]),e.ufo=new U(h(16,14),[h(181,181),h(199,181)]),e.knife=new U(h(15,15),[h(1,199)]),e.poisonBottle=new U(h(14,24),[h(1,216)]),e.circleDiameter12=new U(h(12,12),[h(243,1)]),e.click=new U(h(12,20),[h(17,216)]),e.circleDiameter8=new U(h(8,8),[h(243,15)]),e.eyesAngry=new U(h(8,8),[h(243,25),h(243,35)]),e.eyesCat=new U(h(8,8),[h(243,45),h(243,127)]),e.eyesFrog=new U(h(8,8),[h(55,171),h(65,171)]),e.eyesTired=new U(h(8,8),[h(75,171),h(85,171)]),e.eyesWide=new U(h(8,8),[h(95,171),h(105,171)]),e.fontAlphabet=new U(h(8,8),[h(115,171),h(125,171),h(135,171),h(145,171),h(155,171),h(165,171),h(175,171),h(185,171),h(195,171),h(205,171),h(215,171),h(225,171),h(235,171),h(245,171),h(217,181),h(227,181),h(237,181),h(247,181),h(18,199),h(28,199),h(38,199),h(48,199),h(58,199),h(68,199),h(78,199),h(88,199)]),e.fontHeart=new U(h(8,8),[h(98,199)]),e.fontNumbers=new U(h(8,8),[h(108,199),h(118,199),h(128,199),h(138,199),h(148,199),h(158,199),h(168,199),h(178,199),h(188,199),h(198,199)]),e.fontPunctuation=new U(h(8,8),[h(208,199),h(218,199),h(228,199),h(238,199),h(31,216),h(41,216),h(51,216),h(61,216),h(71,216),h(81,216),h(91,216),h(101,216),h(111,216),h(121,216),h(131,216),h(141,216),h(151,216),h(161,216),h(171,216),h(181,216),h(191,216),h(201,216),h(211,216),h(221,216),h(231,216),h(241,216),h(31,226),h(41,226),h(51,226),h(61,226),h(71,226),h(81,226)]),e.fontSmile=new U(h(8,8),[h(91,226)]),e.fontUp=new U(h(8,8),[h(101,226)]),e.gem=new U(h(8,8),[h(111,226)]),e.unknownCharacter=new U(h(8,8),[h(121,226)]),e.sparkle=new U(h(7,7),[h(248,199),h(131,226),h(140,226)]),e.circleDiameter6=new U(h(6,6),[h(207,111)]),e.smallAlphabet=new U(h(3,5),[h(251,93),h(251,100),h(215,111),h(220,111),h(225,111),h(230,111),h(235,111),h(240,111),h(245,111),h(250,111),h(103,119),h(108,119),h(113,119),h(118,119),h(123,119),h(128,119),h(133,119),h(138,119),h(143,119),h(148,119),h(153,119),h(158,119),h(163,119),h(168,119),h(173,119),h(178,119)]),e.smallDigits=new U(h(3,5),[h(183,119),h(188,119),h(193,119),h(198,119),h(203,119),h(208,119),h(213,119),h(218,119),h(223,119),h(228,119),h(233,119),h(238,119),h(243,119)]),e.whiteDot=new U(h(2,2),[h(253,15)])})(O||(O={}));const yo=8,ut=8;function Fe(e,t,r){return e>=t.charCodeAt(0)&&e<=r.charCodeAt(0)}const So=15,Eo=22,wo=28;function Ao(e){const t=e.charCodeAt(0);return Fe(t,"a","z")?[O.fontAlphabet,t-"a".charCodeAt(0)]:Fe(t,"A","Z")?[O.fontAlphabet,t-"A".charCodeAt(0)]:Fe(t,"0","9")?[O.fontNumbers,t-"0".charCodeAt(0)]:Fe(t,"!","/")?[O.fontPunctuation,t-"!".charCodeAt(0)]:Fe(t,":","@")?[O.fontPunctuation,t-":".charCodeAt(0)+So]:Fe(t,"[","`")?[O.fontPunctuation,t-"[".charCodeAt(0)+Eo]:Fe(t,"{","~")?[O.fontPunctuation,t-"{".charCodeAt(0)+wo]:e==="\u2665"?[O.fontHeart,0]:e==="\u25B2"?[O.fontUp,0]:[O.unknownCharacter,0]}function ko(e){return e.split(`
`).map(t=>t.length)}function Co(e){let t=1;for(const r of e)r===`
`&&t++;return t}const To=2;function Kn(e){const t=e.hSpacing??To;return yo+t}const Bo=4;function Po(e){const t=e.vSpacing??Bo;return ut+t}const Do="left",Ro="top",Ie=-.5;function Pt(e,t,r=Ie){const n=e.hAlign??Do,s=e.vAlign??Ro,o=Kn(e),x=Po(e),f=ko(e.message).map(p=>p*o),l=Co(e.message)*x;let i;switch(s){case"top":i=t;break;case"bottom":i=t.addComps(0,l);break;case"middle":i=t.addComps(0,l/2);break}i=i.addComps(o/2,-x/2);let c=0;const a=()=>{const p=x*c;switch(n){case"left":return i.subComps(0,p);case"right":return i.subComps(f[c],p);case"center":return i.subComps(f[c]/2,p)}};let d=a();c++;let m=[];for(const p of e.message){if(p!==" "&&p!==`
`){const[_,y]=Ao(p);m.push([{spriteSheet:_,frame:y,color:e.color,depth:r},d])}p===`
`?(d=a(),c++):d=d.addComps(o,0)}return m}const Cr=4,Io=6,Mo=.2,No=" ".charCodeAt(0);function Ho(e){const t=[],r=e.length*Cr/2;for(let n=0;n<e.length;n++){const s=e[n],o=s.charCodeAt(0);if(o===No)continue;let x,f;Fe(o,"a","z")?(f=O.smallAlphabet,x=o-"a".charCodeAt(0)):Fe(o,"A","Z")?(f=O.smallAlphabet,x=o-"A".charCodeAt(0)):(f=O.smallDigits,x=s==="+"?10:s==="-"?11:s==="*"?12:parseInt(s)),t.push({spriteSheet:f,frame:x,offset:h(n*Cr-r,Io/2),depth:Ie+.01})}return t}function ht(e,t,r,n,s,o=!1,x){const f=`${x??""}${o?"*":""}${r&&t>0?"+":""}${t}`,l=Ho(f),i=new J;return u.Sprite.add(i,l),u.Ticks.add(i),u.Lifetime.add(i,300),u.Pos.add(i,e),u.Vel.add(i,h(0,Mo)),u.Drag.add(i,8),u.MixColor.add(i,{start:n,end:s,ticks:100,animation:"repeat",type:"rgb"}),i}function Lt(e){return e._block===!0}function Tr(e,t){Lt(e)||typeof e.contents=="string"||(e._selectionIndex=Qs(e._selectionIndex+t,e.contents.length))}function Fo(e){if(Lt(e)||typeof e.contents=="string")return e;const t=e.contents[e._selectionIndex];if("action"in t){t.action();return}else if("onChange"in t)return;return t._parent=e,t._selectionIndex=0,t.onEnter!==void 0&&t.onEnter(),e.onExit!==void 0&&e.onExit(),t}function Xn(e,t,r,n){return eo(Oe(e,t,r),n<1?2:0)}function Br(e,t,r){if(Lt(e))return;const n=e.contents[e._selectionIndex];if(!(typeof n=="string"||!("onChange"in n)))if("numericSelect"in n){const{min:s,max:o,value:x,incr:f}=n.numericSelect,l=Xn(x+f*t*r,s,o,f);n.numericSelect.value=l,n.onChange(l)}else{const s=!n.booleanSelect.value;n.booleanSelect.value=s,n.onChange(s)}}function Lo(e){if(!(Lt(e)||e._parent===void 0))return e._selectionIndex=0,e.onExit!==void 0&&e.onExit(),e._parent.onEnter!==void 0&&e._parent.onEnter(),e._parent}function Oo(e,t,r=Ie){if(typeof e.contents=="string")return Pt({message:e.contents,color:e.baseColor,hAlign:"center",vAlign:"middle"},t,r);const n=[];let o=(e.contents.length*2+1)*ut/2;const x={message:e.title,color:e.baseColor,hAlign:"center",vAlign:"middle"};n.push(...Pt(x,t.add(h(0,o)),r)),n.push([{spriteSheet:O.whiteDot,frame:0,scale:h(e.title.length*Kn(x)/2,1),color:e.baseColor,depth:r},t.add(h(0,o-ut))]),o-=ut;let f=0;for(const l of e.contents){o-=ut*2;const i=f===e._selectionIndex,c=i?e.highlightColor:e.baseColor,a="action"in l?l.message:"onChange"in l?`${l.title} <${"numericSelect"in l?l.numericSelect.value:l.booleanSelect.value}>`:l.title;n.push(...Pt({message:i?`*${a}*`:a,color:c,hAlign:"center",vAlign:"middle"},t.add(h(0,o)),r)),f++}return n}const $n={crush:(e,t=50)=>{const r="",n=(l,i)=>{let c=i.length,a="";const d=_=>encodeURI(encodeURIComponent(_)).replace(/%../g,"i").length,m=_=>{let y=_.charCodeAt(0),E=_.charCodeAt(_.length-1);return y>=56320&&y<=57343||E>=55296&&E<=56319};let p={};for(let _=2;_<t;_++)for(let y=0;y<l.length-_;++y){let E=l.substr(y,_);if(p[E]||m(E))continue;let g=1;for(let v=l.indexOf(E,y+_);v>=0;++g)v=l.indexOf(E,v+_);g>1&&(p[E]=g)}for(;;){for(;c--&&l.includes(i[c]););if(c<0)break;let _=i[c],y,E=0,g=d(_);for(let b in p){let w=p[b],A=(w-1)*d(b)-(w+1)*g;a.length||(A-=d(r)),A<=0?delete p[b]:A>E&&(y=b,E=A)}if(!y)break;l=l.split(y).join(_)+_+y,a=_+a;let v={};for(let b in p){let w=b.split(y).join(_),A=0;for(let T=l.indexOf(w);T>=0;++A)T=l.indexOf(w,T+w.length);A>1&&(v[w]=A)}p=v}return{a:l,b:a}};let s=[];const o="-_.!~*'()";for(let l=127;--l;)(l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||o.includes(String.fromCharCode(l)))&&s.push(String.fromCharCode(l));for(let l=32;l<255;++l){let i=String.fromCharCode(l);i!="\\"&&!s.includes(i)&&s.unshift(i)}e=e.replace(new RegExp(r,"g"),""),e=Pr(e);const x=n(e,s);let f=x.a;return x.b.length&&(f+=r+x.b),f+="_",f},uncrush:e=>{e=e.substring(0,e.length-1);const t=e.split("");let r=t[0];if(t.length>1){let n=t[1];for(let s of n){let o=r.split(s);r=o.join(o.pop())}}return Pr(r,0)}},Pr=(e,t=1)=>{const r=[['"',"'"],["':","!"],[",'","~"],["}",")","\\","\\"],["{","(","\\","\\"]],n=(s,o)=>{let x=new RegExp(`${(o[2]?o[2]:"")+o[0]}|${(o[3]?o[3]:"")+o[1]}`,"g");return s.replace(x,f=>f===o[0]?o[1]:o[0])};if(t)for(let s=0;s<r.length;++s)e=n(e,r[s]);else for(let s=r.length;s--;)e=n(e,r[s]);return e};function Zn(e,t,r,n){const s=document.createElement("div"),o=document.createElement("p");o.innerHTML=e;const x=document.createElement("button");x.innerText="OK",x.addEventListener("click",()=>{n(),t._block=!1,s.remove()}),s.appendChild(o);for(const f of r)s.appendChild(f);return s.appendChild(x),s.id="popup",s}function jn(e){e._block=!0,e._unblockNextDraw=!1}function Uo(e,t,r){if(document.getElementById("popup")!==null)return;jn(t);const n=Zn(e,t,[],r);document.body.appendChild(n)}function Wo(e,t,r){if(document.getElementById("popup")!==null)return;const n=document.createElement("input");n.setAttribute("type","text");const s=()=>r(n.value);n.addEventListener("keydown",x=>{x.key==="Enter"&&(s(),o.remove(),t._unblockNextDraw=!0)}),jn(t);const o=Zn(e,t,[n],s);document.body.appendChild(o),n.focus()}const Go=12,zo=5,qo=3.5,Yo=3,Vo=4,Ko=6,Xo=4,$o=.35;function ie(e){return e.value??e.default}const Dt=[];function ce(e){return Dt.push(e),e}var G;(e=>{e.playerHealth=ce({name:"player health",min:1,max:99,incr:1,default:5,save:{type:"custom game",id:"pHealth"}}),e.playerSpeed=ce({name:"player speed",min:.01,max:.5,incr:.01,default:.1,save:{type:"custom game",id:"pSpeed"}}),e.wavesPerLevel=ce({name:"waves per boss",min:1,max:99,incr:1,default:Yo,save:{type:"custom game",id:"wavesPerLevel"}}),e.numBosses=ce({name:"num bosses",min:2,max:99,incr:1,default:zo,save:{type:"custom game",id:"numBosses"}}),e.maxWaveSize=ce({name:"max wave size",min:Vo,max:10,incr:1,default:Ko,save:{type:"custom game",id:"maxWaveSize"}}),e.normalEnemiesGenerated=ce({name:"normal enemies generated",min:10,max:30,incr:1,default:Go,save:{type:"custom game",id:"numNormalEnemies"}}),e.normalEnemyWindow=ce({name:"normal enemy window",min:3,max:9,incr:1,default:Xo,save:{type:"custom game",id:"normalEnemyWindow"}}),e.shadowChance=ce({name:"shadow spawn chance",min:0,max:1,incr:.05,default:$o,save:{type:"custom game",id:"shadowChance"}}),e.normalEnemyHealthScalar=ce({name:"enemy health mult",min:.2,max:50,incr:.1,default:1,save:{type:"custom game",id:"normalHealthMult"}}),e.bossEnemyHealthScalar=ce({name:"boss health mult",min:.2,max:50,incr:.1,default:1,save:{type:"custom game",id:"bossHealthMult"}}),e.maxDifficulty=ce({name:"max difficulty",min:0,max:7,incr:.1,default:qo,save:{type:"custom game",id:"maxDifficulty"}}),e.hyperGain=ce({name:"hyper gain",min:.1,max:20,incr:.1,default:2,save:{type:"custom game",id:"hyperGain"}}),e.hyperFireDrain=ce({name:"hyper firing drain",min:.1,max:10,incr:.1,default:1,save:{type:"custom game",id:"hyperFireDrain"}}),e.hyperHoldFireDrain=ce({name:"hyper hold fire drain",min:.1,max:10,incr:.1,default:.5,save:{type:"custom game",id:"hyperHoldDrain"}}),e.fullAimAssist=ce({name:"360 degree aim assist",default:!1,save:{type:"controls",id:"fullAimAssist"}}),e.flashOnHit=ce({name:"flash on hit",default:!0,save:{type:"controls",id:"flashOnHit"}}),e.speakBossNames=ce({name:"boss name voice synthesis",default:!1,save:{type:"basic",id:"speakBossNames"}}),e.preventGiant=ce({name:"prevent normal enemy giant bullets",default:!0,save:{type:"custom game",id:"noNormalGiant"}}),e.originalShadowShot=ce({name:"original shadow shot",default:!1,save:{type:"custom game",id:"origShadow"}}),e.playerSpread=ce({name:"player spread",min:1,max:32,incr:1,default:2,save:{type:"custom game",id:"pSpread"}}),e.playerFireDelay=ce({name:"player fire delay",min:3,max:100,incr:1,default:10,save:{type:"custom game",id:"pDelay"}}),e.playerBulletLifetime=ce({name:"player bullet lifetime",min:10,max:1e3,incr:1,default:100,save:{type:"custom game",id:"pLifetime"}}),e.playerBulletSpeed=ce({name:"player bullet speed",min:.1,max:3,incr:.1,default:.8,save:{type:"custom game",id:"pBulletSpeed"}});function t(s){for(const o of Dt){const x=o.save.type==="custom game";"min"in o?o.value=Xn(s.getSettingsJsonNum(o.save.id,x)??o.default,o.min,o.max,o.incr):o.value=s.getSettingsJsonBool(o.save.id,x)??o.default}}e.updateAllSettings=t;function r(s,o){for(const x of Dt)(o&&x.save.type==="custom game"||!o&&x.save.type!=="custom game")&&(x.value=x.default);s.clearSettings(o),o||s.saveSettingsJson()}e.resetSettings=r;function n(){const s={};for(const o of Dt)o.save.type==="custom game"&&o.value!==void 0&&o.value!==o.default&&(s[o.save.id]=`${o.value}`);return encodeURIComponent($n.crush(JSON.stringify(s)))}e.encodeCustomGame=n})(G||(G={}));function Zo(e,t){const r=e.save.type==="custom game",n=s=>{e.value=s,e.value===e.default?t.removeSettingJson(e.save.id,r):t.setSettingsJson(e.save.id,`${s}`,r)};return"min"in e?{title:e.name,numericSelect:{min:e.min,max:e.max,incr:e.incr,value:e.value??t.getSettingsJsonNum(e.save.id,r)??e.default},onChange:n}:{title:e.name,booleanSelect:{value:e.value??t.getSettingsJsonBool(e.save.id,r)??e.default},onChange:n}}function jo(e,t,r,n,s,o,x,f){const l=d=>Zo(d,r),i=d=>({message:"reset to default",action:()=>{r.clearSettings(d),G.updateAllSettings(r),n()}}),c={title:"custom game",contents:[{message:"copy link to clipboard",action:()=>{r.saveSettingsJson();const d=f?`${{BASE_URL:"./",MODE:"itch",DEV:!0,PROD:!1}.VITE_NG_PORTAL_URL}?NewgroundsAPI_CustomParams=`:window.location.href.split("?")[0],m=f?d:(d[d.length-1]==="/"?d.slice(0,-1):d)+"?",p=G.encodeCustomGame(),_=m+p;navigator.clipboard.writeText(_).then(s,()=>{o(),Uo(`Copy the code below:<br><br><tt>${f?_:p}</tt>`,c,()=>{})})}},{message:"load from custom game link",action:()=>{Wo("Paste custom game code or link here:",c,d=>{d=d.trim();const m=d.includes("?")?d.split("?")[1]:d;r.updateCustomGameFromCode(m)?n():x()})}},{title:"generation",contents:[l(G.wavesPerLevel),l(G.numBosses),l(G.normalEnemiesGenerated),l(G.normalEnemyWindow),l(G.shadowChance),l(G.maxDifficulty),l(G.maxWaveSize),l(G.preventGiant),l(G.originalShadowShot)],baseColor:e,highlightColor:t,_selectionIndex:0,_parent:void 0},{title:"health",contents:[l(G.playerHealth),l(G.normalEnemyHealthScalar),l(G.bossEnemyHealthScalar)],baseColor:e,highlightColor:t,_selectionIndex:0,_parent:void 0},{title:"hyper",contents:[l(G.hyperGain),l(G.hyperFireDrain),l(G.hyperHoldFireDrain)],baseColor:e,highlightColor:t,_selectionIndex:0,_parent:void 0},{title:"player",contents:[l(G.playerFireDelay),l(G.playerSpread),l(G.playerBulletLifetime),l(G.playerBulletSpeed),l(G.playerSpeed)],baseColor:e,highlightColor:t,_selectionIndex:0,_parent:void 0},i(!0)],baseColor:e,highlightColor:t,_selectionIndex:0,_parent:void 0},a={title:"settings",contents:[l(G.fullAimAssist),l(G.flashOnHit),l(G.speakBossNames),i(!1)],baseColor:e,highlightColor:t,_selectionIndex:0,_parent:void 0};return[c,a]}class fe{info;totalWeight;constructor(...t){if(t.length===0)throw new Error("empty pairs for chance table");this.info=new Map;let r=0;for(const n of t){if(this.info.get(n[0])!==void 0)throw new Error("key not unique for chance table");r+=n[1],this.info.set(n[0],n[1])}this.totalWeight=r}pickHelper(t,r){const n=Math.random()*t;let s=0;for(const[o,x]of r.entries()){if(n>=s&&n<s+x)return[o,x];s+=x}}pick(){return this.pickHelper(this.totalWeight,this.info)?.[0]??[...this.info.entries()][0][0]}draw(t,r){const n=new Map;let s=this.totalWeight;for(const[f,l]of this.info.entries())r.includes(f)?s-=l:n.set(f,l);const o=[],x=Math.min(n.size,t);for(let f=0;f<x;f++){const l=this.pickHelper(s,n);if(l===void 0)return o;const[i,c]=l;s-=c,o.push(i),n.delete(i)}return o}}class Qo{info;constructor(...t){if(t.length===0)throw new Error("empty list for chance table");this.info=t}pick(){return this.info[Math.floor(Math.random()*this.info.length)]}}const Jo=new fe(["punished",2],["occult",1],["wicked",1],["curious",.5],["nefarious",1],["damned",1],["twisted",1],["arcane",1],["inferior",1],["devious",1],["unyielding",1],["tortured",1],["fallen",1],["writhing",.5],["flailing",.5],["corrupt",1],["hateful",1],["hideous",1],["destructive",1],["unworthy",1],["foolish",.5],["undead",1],["satanic",1],["forgotten",1],["reanimated",1],["rotten",.25],["decomposing",.25],["decrepit",.25],["broken",.5],["anguished",.5],["tormented",.5],["grieving",.5],["phantom",.25],["screaming",.25],["reconstructed",.25],["imperfect",.25],["unfinished",.25],["delirious",.25],["suffering",.25],["mechanical",.25]),ea=new fe(["beautiful",1],["ethereal",1],["eternal",.5],["luminous",1],["immaculate",.25],["crystalline",.25],["incandescent",1],["resplendent",1],["brilliant",1],["superior",1],["angelic",.5],["divine",1],["awoken",1],["exalted",1],["cosmic",1],["reborn",1],["cyber",1],["celestial",1],["perfect",1],["synthetic",.05]),ta=new fe(["acolyte",1],["thrall",1],["warrior",1],["knight",.5],["seraph",1],["guardian",1],["defender",1],["cryptid",.05],["golem",.25],["wanderer",.25],["hero",.25],["champion",.25],["mage",.25],["berserker",.25],["tormentor",.25],["robot",.25],["automaton",.25],["supercomputer",.25],["ghost",.25],["angel",.25],["demon",.25],["banshee",.25],["machine",.25]),ra=new fe(["temple",1],["crypt",1],["dungeon",1],["chamber",1],["forest",1],["labyrinth",1],["wasteland",.25],["cavern",.25],["high order",.5],["catacombs",.5],["morgue",.5],["cosmos",.5],["subspace",.25],["nexus",.25],["crossroads",.25]),na=100;function Zt(e,t,r){const n=t==="heavenly"?ea:Jo;let s,o=0;for(;s===void 0;){const x=n.pick();!r.includes(x)||o>=na?s=x:o++}return r.push(s),`${s} ${e}`}function jt(e){return Math.random()<e?"heavenly":"hellish"}function Dr(e,t){return r=>Math.random()<e?t(r):r}function sa(e,t,r,n=100){for(let s=0;s<n;s++){const o=t();if(e(o))return o}return r}function oa(e,t=.8,r=.1,n=.4,s=.9){const o=ta.pick(),x=ra.pick(),f=[],l=Dr(t,a=>Zt(a,jt(e),f)),i=Dr(r,a=>Zt(a,jt(e),f));if(Math.random()>=n)return i(Zt(o,jt(e),f));const c=l(x);return Math.random()<s?`${i(l(o))} of the ${c}`:`${c} ${o}`}const aa=[[O.eyesAngry,10],[O.eyesCat,10],[O.eyesFrog,10],[O.eyesTired,10],[O.eyesWide,10],[O.eyesHoles,1]],ia=new fe(...aa);function ca(){return ia.pick()}const la=100,da=20;class Qn{constructor(t,r,n,s,o,x){this.hueLow=t,this.hueHigh=r,this.saturationLow=n,this.saturationHigh=s,this.lightnessLow=o,this.lightnessHigh=x}toColor(){return L.hsl($(this.hueLow,this.hueHigh),$(this.saturationLow,this.saturationHigh),$(this.lightnessLow,this.lightnessHigh)).copy()}}class ha{constructor(t,r,n,s,o,x){this.redLow=t,this.redHigh=r,this.greenLow=n,this.greenHigh=s,this.blueLow=o,this.blueHigh=x}toColor(){return L.rgb($(this.redLow,this.redHigh),$(this.greenLow,this.greenHigh),$(this.blueLow,this.blueHigh)).copy()}}class fa{table;constructor(...t){this.table=new Qo(...t)}toColor(){return this.table.pick().copy()}}class Qe{constructor(t){this.color=t}toColor(){return this.color}}class Je{table;constructor(...t){this.table=new fe(...t)}toColor(){return this.table.pick().toColor()}}class ae{constructor(t,r,n,s,o=t.dimensions.x/2){this.spriteSheet=t,this.faceHorizontally=r,this.animation=n,this.eyeChance=s,this.collisionRadius=o}}const Ee=new Qn(0,360,.5,1,.4,.6),Qt=new ha(0,1,0,1,0,1),Jt=new fa(L.named("brown"),L.named("gray"),L.named("white"),L.named("beige"),L.named("yellow"),L.named("orange"),L.named("red"),L.named("green"),L.named("blue")),ua=new Qn(0,0,0,0,.5,1),Ct=new Je([new Qe(L.rgb(1,1,1)),8],[Ee,2]);class le{constructor(t,r){this.bodySpriteInfo=t,this.colorGenerator=r}}const xa=[[new le(new ae(O.duck,!0,"speed",0),Ee),50],[new le(new ae(O.alarmClock,!1,"speed",0),Ee),20],[new le(new ae(O.pill,!1,"fixed",.1),Ee),20],[new le(new ae(O.headCat,!1,"fixed",1),Jt),5],[new le(new ae(O.headBear,!1,"fixed",1),Jt),5],[new le(new ae(O.headGoat,!1,"fixed",1),Jt),5],[new le(new ae(O.headTriangle,!1,"fixed",1),Qt),5],[new le(new ae(O.scribbleMask,!1,"fixed",0),ua),2],[new le(new ae(O.ufo,!1,"fixed",.1),Ee),30],[new le(new ae(O.click,!0,"fixed",.5),Ct),10],[new le(new ae(O.window,!1,"fixed",.5),Ct),5],[new le(new ae(O.sop,!1,"fixed",.1),new Je([new Qe(L.rgb(1,0,0)),9],[Ee,1])),10],[new le(new ae(O.iceCream,!1,"fixed",.3),Ee),20],[new le(new ae(O.head,!1,"fixed",.1),Ee),30],[new le(new ae(O.lobotomy,!1,"fixed",.5),Ee),5],[new le(new ae(O.poisonBottle,!1,"fixed",.5),Qt),10],[new le(new ae(O.baseball,!1,"fixed",.5),Ct),5],[new le(new ae(O.basketball,!1,"fixed",.7),new Je([new Qe(L.named("orange")),8],[Ee,2])),5],[new le(new ae(O.football,!1,"fixed",.7),new Je([new Qe(L.named("brown")),8],[Ee,2])),5],[new le(new ae(O.kevin,!1,"fixed",.8),new Je([new Qe(L.named("yellow")),8],[Ee,2])),5],[new le(new ae(O.chessPieces,!1,"health",.5),Qt),5],[new le(new ae(O.die,!1,"health",.9),Ct),5],[new le(new ae(O.bugaloo,!0,"speed",0),new Je([new Qe(L.named("green")),3],[Ee,2])),5]],pa=new fe(...xa),Rr=4;class Jn{constructor(t,r,n,s){this.bodySpriteInfo=t,this.chosenColor=r,this.chosenScale=n,this.chosenEyes=s}toSpriteDataList(){const t=[];return this.chosenEyes!==void 0&&t.push({spriteSheet:this.chosenEyes,frame:0,depth:$t,offset:h(-Rr,0),color:L.rgb(1,1,1)},{spriteSheet:this.chosenEyes,frame:0,scale:h(-1,1),depth:$t,offset:h(Rr,0),color:L.rgb(1,1,1)}),t.push({spriteSheet:this.bodySpriteInfo.spriteSheet,frame:0,scale:this.chosenScale,color:this.chosenColor.copy(),depth:$t}),t}addToEntity(t){if(u.Sprite.add(t,this.toSpriteDataList()),u.CircleCollider.add(t,this.bodySpriteInfo.collisionRadius*this.chosenScale.x),this.bodySpriteInfo.animation==="speed"||this.bodySpriteInfo.animation==="fixed"?u.Animate.add(t,{animation:"repeat",ticksPerFrame:la*this.chosenScale.x}):this.bodySpriteInfo.animation==="health"&&H.AnimateWithHealth.add(t,t.health),this.bodySpriteInfo.animation==="speed"&&u.AnimateWithSpeed.add(t,da),this.bodySpriteInfo.faceHorizontally){const r=this.chosenEyes?2:null;u.FaceHorizontally.add(t,r)}return t}}const ma=.1;function va(e){const t=pa.pick(),r=t.colorGenerator.toColor().setBrightnesses(...me),n=e??Math.random()<ma?to:Q0,s=Math.random()<t.bodySpriteInfo.eyeChance?ca():void 0;return new Jn(t.bodySpriteInfo,r,n,s)}const ga=new ae(O.thirdEye,!1,"health",0),_a=new Jn(ga,L.rgb(1,0,0),h(2,2));function Ir(e,t,r){e.setH(360*(t/r.ticksPerCycle)+(r.offset??0))}function Mr(e,t,r){const n=(t-(r.startTicks??0))/r.ticks,s=r.animation==="once"?Oe(n,0,1):r.animation==="repeat"?n%1:Vs(n),o=zn(r.start,r.end,s);r.type==="rgb"?e.setRgb(...o):r.type==="hsl"?e.setHsl(...o):e.setBrightnesses(...o)}function Nr(e){return e.controlState.leftShoulderButton.held||e.controlState.rightShoulderButton.held?10:1}function q0(e,t,r){if(t.x===0)return;e.scale===void 0&&(e.scale=Q0);const n=Math.abs(e.scale[r]),s=t[r]>0?n:-n;e.scale=r==="x"?h(s,e.scale.y):h(e.scale.x,s)}function Y0(e){return u.Orbital.is(e)&&e.orbital.center!==void 0}function es(e){return u.Lifetime.is(e)&&e.ticks>=e.lifetime}function ba(e,t){return e===1/0?Math.random()*2*Math.PI:2*Math.PI/e*Math.floor($(0,e))+t}var we;(e=>{function t(i,c){for(const a of i.entities)if(u.Menu.is(a)){const d=c.get(1,1);if(d!==void 0)if(d.controlState.primaryButton.pressed){const m=Fo(a.menu);m!==void 0&&(a.menu=m)}else if(d.controlState.secondaryButton.pressed){const m=Lo(a.menu);m!==void 0&&(a.menu=m)}else d.controlState.down.pressed?Tr(a.menu,1):d.controlState.up.pressed?Tr(a.menu,-1):d.controlState.left.pressed?Br(a.menu,-1,Nr(d)):d.controlState.right.pressed&&Br(a.menu,1,Nr(d))}}e.menu=t;function r(i,c){for(const a of i.entities){if(u.Orbital.is(a)&&a.orbital.center!==void 0&&(u.Destroyed.is(a.orbital.center)?a.orbital.center=void 0:(a.pos=a.orbital.center.pos.add(h(...Ae(a.orbital.angle)).multComps(a.orbital.radius)),a.orbital.angle+=a.orbital.speed)),u.Pos.is(a)&&u.Vel.is(a)){if(!Y0(a)){const d=a.pos;if((Math.abs(d.x)>240*2+50||Math.abs(d.y)>135+50)&&u.Destroyed.add(a),u.Nudge.is(a)&&(a.pos=a.pos.add(a.nudge),a.nudge=Q),u.Acc.is(a)){const m=u.Gravity.is(a)?a.acc.add(a.gravity):a.acc;a.vel=a.vel.add(m.multComps(c)),u.ResetAcc.is(a)&&(a.acc=Q)}if(u.Drag.is(a)){const m=1-c/1e3*a.drag;a.vel=a.vel.multComps(m)}if(u.MaxSpeed.is(a)&&a.vel.length>a.maxSpeed){const m=a.vel.normalize();m!==void 0&&(a.vel=m.multComps(a.maxSpeed))}}if(a.pos=a.pos.add(a.vel.multComps(c)),u.StayInside.is(a)){const d=Oe(a.pos.x,a.stayInside.left+a.circleCollider,a.stayInside.right-a.circleCollider),m=d!==a.pos.x,p=Oe(a.pos.y,a.stayInside.bottom+a.circleCollider,a.stayInside.top-a.circleCollider),_=p!==a.pos.y;a.pos=h(d,p),u.ReverseAtBounds.is(a)&&(u.Vel.is(a)&&(a.vel=a.vel.multComps(m?-1:1,_?-1:1)),u.Acc.is(a)&&(a.acc=a.acc.multComps(m?-1:1,_?-1:1)))}u.Tweened.is(a)&&(a.tweened.prev=a.pos)}if(u.GrowingCollider.is(a)&&(a.circleCollider+=a.growingCollider),u.Sprite.is(a)){if(u.AngleVel.is(a))for(const d of a.sprite)d.angle===void 0&&(d.angle=0),d.angle+=a.angleVel;if(u.ScaleVel.is(a))for(const d of a.sprite)d.scale===void 0&&(d.scale=h(1,1)),d.scale=d.scale.add(a.scaleVel),u.DestroyIfSmall.is(a)&&(d.scale.x<=0||d.scale.y<=0)&&(u.Destroyed.add(a),d.scale=h(0,0));if(u.MixColor.is(a))for(const d of a.sprite)d.color===void 0&&(d.color=L.rgb(0,0,0)),Mr(d.color,a.ticks,a.mixColor);if(u.Rainbow.is(a))for(const d of a.sprite)d.color===void 0&&(d.color=L.hsl(0,1,.5)),Ir(d.color,a.ticks,a.rainbow);if(u.Animate.is(a))for(const d of a.sprite){const m=Math.floor(a.animate._counter/a.animate.ticksPerFrame),p=d.spriteSheet.locations.length;if(a.animate.animation==="destroy"&&m>=p)u.Destroyed.add(a);else{const _=a.animate.animation==="repeat"?m%p:Math.min(m,p-1);d.frame=_}}}}}e.move=r;function n(i,c){c.clear();for(const a of i.entities)u.Pos.is(a)&&u.CircleCollider.is(a)&&c.place(a)}e.setupSpatialHash=n;function s(i,c,a,d){i.resolve(c,a,d)}e.collide=s;function o(i,c){for(const a of i.entities)if(!Y0(a)){if(u.AccelerateTo.is(a)){const d=c.closestInRange(a.accelerateTo.closest,a.accelerateTo.range,a.pos);if(d!==void 0){const m=a.accelerateTo.backUpRange!==void 0&&a.pos.sub(d.pos).length<a.accelerateTo.backUpRange?-1:1,p=d.pos.sub(a.pos).normalize()?.multComps(a.accelerateTo.acc*m);p!==void 0&&(a.acc=p)}}if(u.Wander.is(a)){let d=!1;if(u.Ticks.is(a)&&a.ticks===1?d=!0:"ticks"in a.wander.changeDirections?u.Ticks.is(a)&&a.ticks%a.wander.changeDirections.ticks===0&&(d=!0):Math.random()<a.wander.changeDirections.chance&&(d=!0),d){if(!u.Pos.is(a))throw new Error("wander missing pos");let m;if(a.wander.chase!==void 0&&Math.random()<a.wander.chase.chance){const p=c.closestInRange(a.wander.chase.closest,1/0,a.pos);p!==void 0&&(m=p.pos.sub(a.pos).normalizeOrZero())}m===void 0&&(m=h(...Ae(ba(a.wander.numAngles,a.wander.angleOffset)))),"acc"in a.wander.move?a.acc=m.multComps(a.wander.move.acc):a.vel=m.multComps(a.wander.move.vel)}}}}e.endStep=o;function x(i){for(const c of i.entities)if(u.Pos.is(c)&&u.Tweened.is(c)&&c.tweened.prev!==void 0){const a=i.scaledStepMs,d=i.leftoverTime,m=c.pos.sub(c.tweened.prev).multComps((a-d)/a);c.tweened.pos=c.pos.sub(m)}}e.tween=x;function f(i){for(const c of i.entities)u.Ticks.is(c)&&(c.ticks++,es(c)&&u.Destroyed.add(c),u.SpawnOnTick.is(c)&&c.ticks%c.spawnOnTick.ticks===0&&i.spawn(...c.spawnOnTick.spawner(c.pos))),u.Animate.is(c)&&(u.AnimateWithSpeed.is(c)&&(c.animate.speed=c.animateWithSpeed*c.vel.length),c.animate._counter+=c.animate.speed??1)}e.tick=f;function l(i,c){for(const a of i.entities){if(u.Hidden.is(a)&&a.hidden)continue;const d=u.Pos.is(a)?u.Tweened.is(a)?a.tweened.pos:a.pos:Q;if(d!==void 0){if(u.Sprite.is(a)){if(u.AngleInDirection.is(a)&&u.Vel.is(a))for(const m of a.sprite)m.angle=Math.atan2(a.vel.y,a.vel.x)+Math.PI/2;if(u.FaceHorizontally.is(a))if(a.faceHorizontally===null)for(const m of a.sprite)q0(m,a.vel,"x");else q0(a.sprite[a.faceHorizontally],a.vel,"x");c.addSprites(a.sprite,d)}if(u.Text.is(a)){a.text.func!==void 0&&(a.text.message=a.text.func(i));const m=Pt(a.text,u.Pos.is(a)?a.pos:h(0,0),a.text.depth);u.MixColor.is(a)&&(a.text.color===void 0&&(a.text.color=L.rgb(0,0,0)),Mr(a.text.color,a.ticks,a.mixColor)),u.Rainbow.is(a)&&(a.text.color===void 0&&(a.text.color=L.rgb(0,0,0)),Ir(a.text.color,a.ticks,a.rainbow));for(const p of m)c.addSprites([p[0]],p[1])}if(u.Menu.is(a)){const m=Oo(a.menu,u.Pos.is(a)?a.pos:h(0,0),Ie-.2);for(const p of m)c.addSprites([p[0]],p[1]);a.menu._unblockNextDraw&&a.menu._block===!0&&(a.menu._block=!1,a.menu._unblockNextDraw=!1)}}}}e.draw=l})(we||(we={}));function e0(e,t,r,n,s,o){t=t.addComps(r.x*n,r.y*n);const x=o?"player":e.team,f=new J;H.Bullet.add(f,{team:x,damage:o?1:e.damage}),u.Pos.add(f,t),u.Tweened.add(f),u.Vel.add(f,r.multComps(e.speed*s)),e.drag>0&&u.Drag.add(f,e.drag),e.homing!==void 0&&(u.Acc.add(f,h(0,0)),u.AccelerateTo.add(f,{acc:e.homing.acc,range:e.homing.range,closest:x==="player"?Nt:St}));const[l,i]=x==="enemy"?[oo,so]:[io,ao],[c,a,d]=e.size==="small"?[O.circleDiameter8,O.circleDiameter6,3]:e.size==="medium"?[O.circleDiameter16,O.circleDiameter12,6]:e.size==="large"?[O.circleDiameter24,O.circleDiameter18,9]:[O.circleDiameter32,O.circleDiameter24,12];return u.Sprite.add(f,[{spriteSheet:c,frame:0,depth:l,color:o?L.hsl(0,.4,.7):L.rgb(...e.rgb)},{spriteSheet:a,frame:0,depth:i,color:o?L.rgb(...e.rgb).setS(.3):e.damage===1?L.rgb(...e.rgb).setL(.8):L.rgb(0,0,0)}]),u.Ticks.add(f),o&&u.Rainbow.add(f,{ticksPerCycle:200}),x==="enemy"&&u.MixColor.add(f,{start:[.5,0,0],end:[0,.5,.5],ticks:Math.floor(100/e.damage),type:"brightness",animation:"boomerang"}),u.CircleCollider.add(f,d),u.Lifetime.add(f,e.lifetime),f}function t0(e){return $(-e/2,e/2)}var Mt;(e=>{function t(r,n,s,o,x,f){if(r.spread===void 0||r.spread.amount<=1){if(r.inaccuracy!==void 0){const d=Math.atan2(s.y,s.x)+t0(r.inaccuracy),[m,p]=Ae(d),_=h(m,p);return[e0(r,n,_,o,x,f)]}return[e0(r,n,s,o,x,f)]}const l=Math.atan2(s.y,s.x),i=r.spread.angle/(r.spread.amount-1),c=[],a=r.inaccuracy!==void 0?t0(r.inaccuracy):0;for(let d=0;d<r.spread.amount;d++){const m=r.spread.inaccuracy!==void 0?t0(r.spread.inaccuracy):0,p=a+m,[_,y]=Ae(l-r.spread.angle/2+d*i+p),E=h(_,y);c.push(e0(r,n,E,o,x,f))}return c}e.shoot=t})(Mt||(Mt={}));const ya={type:"sparkles",color:[.1,.1,.1],intensity:1},Sa=.02,Ea=.04,wa=h(0,-7e-5),Aa=100,ka=.01,Ca=5;function V0(e,t,r=!1){const n=t>1,s=new J;if(u.Pos.add(s,e),u.Tweened.add(s),r)u.Vel.add(s,Q);else{const[o,x]=Ae(Math.random()*Math.PI*2);u.Vel.add(s,h(o,x).multComps($(Sa,Ea)))}return u.Acc.add(s,Q),u.ResetAcc.add(s),u.Gravity.add(s,wa),u.Ticks.add(s),u.CircleCollider.add(s,n?8:4),u.Drag.add(s,3),u.Sprite.add(s,[{spriteSheet:n?O.bigGem:O.gem,frame:0,color:L.rgb(1,0,0)}]),u.Rainbow.add(s,{ticksPerCycle:100}),u.Lifetime.add(s,2e3),u.MixColor.add(s,{start:n?[1,.5,.5]:[1,0,0],end:[0,0,0],ticks:2e3,type:"rgb",animation:"once"}),H.Explode.add(s,[ya]),H.Gem.add(s,t),s}const Ta=e=>[V0(e,1,!0)];function r0(e,t){u.Rainbow.add(e,{ticksPerCycle:t,offset:Math.random()*360})}var Le;(e=>{const o=h(1.5,1.5),x=.02,f=-.01,l=-.005;e.smoke=(E,g)=>{const v=new J;u.Pos.add(v,E),u.Tweened.add(v),u.Sprite.add(v,[{spriteSheet:O.puff,frame:0,scale:o,depth:Ar,angle:Math.random()*2*Math.PI}]),u.Ticks.add(v),g==="rainbow"?r0(v,100):u.MixColor.add(v,{start:g,end:[.3,.3,.3],ticks:500,type:"rgb",animation:"once"});const[b,w]=Ae(Math.random()*Math.PI*2);u.Vel.add(v,h(b,w).multComps($(.005,.3))),u.Drag.add(v,5),u.AngleVel.add(v,$(-x,x));const A=$(f,l);return u.ScaleVel.add(v,h(A,A)),u.DestroyIfSmall.add(v),v},e.spark=(E,g)=>{const v=new J;u.Ticks.add(v),u.Pos.add(v,E),u.Tweened.add(v),u.Sprite.add(v,[{spriteSheet:O.whiteDot,frame:0,scale:h(1,10),color:g==="rainbow"?void 0:L.rgb(...g),depth:0}]),g==="rainbow"&&r0(v,100);const[b,w]=Ae(Math.random()*Math.PI*2);return u.Vel.add(v,h(b,w).multComps($(.5,1.5))),u.Drag.add(v,6),u.AngleInDirection.add(v),u.ScaleVel.add(v,h(0,-.1)),u.DestroyIfSmall.add(v),u.Acc.add(v,h(0,0)),v};const i=.03,c=.07,a=30,d=50;e.sparkle=(E,g)=>{const v=new J;u.Pos.add(v,E),u.Sprite.add(v,[{spriteSheet:O.sparkle,frame:0,color:g==="rainbow"?void 0:L.rgb(...g)}]),u.Ticks.add(v),g==="rainbow"&&r0(v,100);const[b,w]=Ae(Math.random()*Math.PI*2);return u.Vel.add(v,h(b,w).multComps($(i,c))),u.Drag.add(v,3),u.Animate.add(v,{ticksPerFrame:Math.floor($(a,d)),animation:"destroy"}),v};const m=10,p=h(-.01,-.01);function _(E,g,v,b){const w=new J;u.Pos.add(w,E);const A=2*v/32;return u.Sprite.add(w,[{spriteSheet:b?O.bulletExplosion:O.circleDiameter32,frame:0,color:g.copy().setBrightnesses(...me),scale:h(A,A),depth:b?no:Ar}]),b?u.Animate.add(w,{ticksPerFrame:m,animation:"destroy"}):(u.ScaleVel.add(w,p),u.DestroyIfSmall.add(w)),w}e.bulletDestroyed=_;function y(E,g){const v=H.DidDamage.is(E),b=H.Disappeared.is(E);!v&&!b||g.spawn(e.bulletDestroyed(E.pos,E.sprite[0].color??L.rgb(1,1,1),E.circleCollider,v))}e.spawnBulletParticle=y})(Le||(Le={}));const Ba=64,Pa=32,Da=2,Ra=10,Ia=100,Ma=5;function ts(e,t=!0){const r=new J;return H.BulletCancel.add(r,t),u.Pos.add(r,e),u.CircleCollider.add(r,t?Ba:Pa),u.GrowingCollider.add(r,t?Da:Ra),u.Ticks.add(r),u.Lifetime.add(r,t?Ia:Ma),r}const Hr={volume:.3,sampleRate:44100,x:new(window.AudioContext||webkitAudioContext),play:function(...e){return this.playSamples(this.buildSamples(...e))},playSamples:function(...e){const t=this.x.createBuffer(e.length,e[0].length,this.sampleRate),r=this.x.createBufferSource();return e.map((n,s)=>t.getChannelData(s).set(n)),r.buffer=t,r.connect(this.x.destination),r.start(),r},buildSamples:function(e=1,t=.05,r=220,n=0,s=0,o=.1,x=0,f=1,l=0,i=0,c=0,a=0,d=0,m=0,p=0,_=0,y=0,E=1,g=0,v=0){const b=Math.PI*2;let w=this.sampleRate,A=te=>te>0?1:-1,T=l*=500*b/w/w,P=r*=(1+t*2*Math.random()-t)*b/w,F=[],S=0,k=0,B=0,R=1,W=0,z=0,q=0,ee,Z;for(n=n*w+9,g*=w,s*=w,o*=w,y*=w,i*=500*b/w**3,p*=b/w,c*=b/w,a*=w,d=d*w|0,Z=n+g+s+o+y|0;B<Z;F[B++]=q)++z%(_*100|0)||(q=x?x>1?x>2?x>3?Math.sin((S%b)**3):Math.max(Math.min(Math.tan(S),1),-1):1-(2*S/b%2+2)%2:1-4*Math.abs(Math.round(S/b)-S/b):Math.sin(S),q=(d?1-v+v*Math.sin(b*B/d):1)*A(q)*Math.abs(q)**f*e*this.volume*(B<n?B/n:B<n+g?1-(B-n)/g*(1-E):B<n+g+s?E:B<Z-y?(Z-B-y)/o*E:0),q=y?q/2+(y>B?0:(B<Z-y?1:(Z-B)/y)*F[B-y|0]/2):q),ee=(r+=l+=i)*Math.cos(p*k++),S+=ee-ee*m*(1-(Math.sin(B)+1)*1e9%2),R&&++R>a&&(r+=c,P+=c,R=0),d&&!(++W%d)&&(r=P,l=T,R=R||1);return F},getNote:function(e=0,t=440){return t*2**(e/12)}};var V;(e=>{const t=new Map;function r(x){"ticks"in x?t.get(x.sound)===void 0&&(t.set(x.sound,{ticks:x.ticks}),Hr.play(...x.sound)):Hr.play(...x)}e.play=r;function n(){let x=[];for(const[f,l]of t.entries())l.ticks--,l.ticks<=0&&x.push(f);for(const f of x)t.delete(f)}e.tickSounds=n,e.EXPLOSION=[1.01,,382,.04,.12,.53,4,4.64,.4,.8,,-.01,,.4,1.3,.8,,.36,.18,.4],e.PLAYER_SHOOT_HIGH_PITCH={ticks:40,sound:[1.01,.2,426,,.03,.06,,1.38,-8.7,-.5,,,,,,.3,,.65,.07,.16]},e.PLAYER_SHOOT={ticks:40,sound:[1.01,.75,146.8324,,.03,.06,1,1.38,-8.7,-.5,,,,,,.3,,.65,.07,.16]},e.HYPER_2_SHOOT={ticks:40,sound:[.9,,267,.02,.02,.07,3,1.71,-6.6,,50,,,.2,,.1,,.54,.06,.36]},e.HYPER_1_SHOOT={ticks:40,sound:[.8,,245,.02,.01,.07,3,1.71,-6.6,,,,,.2,,.1,,.54,.06,.36]},e.PLAYER_HIT=[2.12,,29,.04,.16,.43,,1.5,1.1,-1,-500,.01,,1.7,1,.3,.03,.6,.1,.27],e.LOW_LONG_TONE=[1.02,0,65.40639,.02,.33,.36,,.6,,,,,,.4,,,,.4,.14],e.HIGH_LONG_TONE=[2.48,0,261.6256,.04,.93,.09,1,1.96,,,,,.09,,,,.02,.3,.2,.29],e.RISING_NOTES=[1.04,,450,,.1,.34,2,.07,,,221,.03,.1,,,,,.51,.26,.3],e.WAKA=[1.03,,322,.04,.08,.08,2,1.47,-5.8,1.2,,,,.9,,.1,,.47,.03],e.DEATH=[2.02,,930,.02,.06,.56,1,.05,,,,,.1,1.2,-3.1,.5,.47,.31,.17,.1],e.BLUB=[2.05,,159,.01,.03,.07,1,1.8,-8.4,-.8,,,,,,,.07,.68,.02],e.SPOOKY_TRILLS=[1.44,,254,.09,.26,.26,1,1.8,4.2,.3,584,.17,.1,,,,.05,.7,.15],e.PASSING_BY=[1.6,,486,.04,.14,.28,1,1.94,,,7,.18,.01,,,,.12,.85,.26,.43],e.SINISTER_CRACKLE=[2.96,,22,.06,.29,.31,2,1.12,-1,,,,.16,,,,.13,.45,.26,.25],e.COMPUTER=[1.05,,673,.05,.17,.28,1,1.54,,-5.9,-583,.06,.08,,,,,.89,.11,.23],e.AYA=[,,567,.04,.13,.08,1,1.32,29,,-396,.23,,,,.2,,,.05],e.ZOOP=[2.02,,305,.02,.2,.51,,.2,.7,.9,,,,.2,,.2,.23,.35,.12],e.ENEMY_EXPLOSION=[2.22,,679,.03,.07,.39,1,1.73,,.1,,,.05,.2,-3.1,.6,.12,.41,.13],e.GEM_COLLECT={ticks:4,sound:[2.03,,696,.01,,.02,1,2.97,4.1,-5.8,,,,,,,.16,.85,.01]},e.HYPER_BEGIN=[1.01,,26,.06,.12,.46,,.11,,-7.7,-475,.2,.17,.1,,.1,,.8,.29],e.DOUBLE_HIT=[2.12,,387,.02,.01,.17,3,1.31,1.3,,,,.16,2,,.2,.15,.58,.05,.2],e.ENEMY_HIT=[1.99,,483,,.01,0,1,0,-15,-12,,,,,,,.05,.19,.02],e.SCREAMING_HIT={ticks:200,sound:[1.01,1,65.40639,.04,.1,.06,1,.6,26,3.3,,,,1,1,.2,.06,.68,.09]},e.BOSS_HIT={ticks:200,sound:[1.9,,321,,.04,.13,2,2.29,-5.5,,,,,1.6,,.4,.03,.71,.07]},e.EYE_OPEN={ticks:200,sound:[2.03,,500,.03,.04,.36,,1.5,.7,,,,,.9,,.6,.34,.39,.12,.44]},e.EYE_OPEN_WIN=[,,110,.03,.2,.41,2,.95,,,32,.08,.05,,4.6,,,.47,.28];function s(x){return[2.11,0,tt(500,706,x),.02,.05,.18,2,1.35,,,89,.07,.02,,,,.07,.66,.03,.17]}e.makeQuickKillSound=s;function o(x){return[1.88,0,Math.min(600+x*20,1100),.01,.02,.12,1,.71,,-6.9,388,.02,,,,,.07,.96,.01,.02]}e.makeChainSound=o,e.SPAWN_NORMAL={ticks:10,sound:[1.35,,0,.05,.11,.16,,.86,2.6,,,,,1,,,.24,,.13,.03]},e.SPAWN_BOSS={ticks:10,sound:[1.35,,-2,.05,.11,.16,,.86,2.6,-.1,-50,.01,,1,1,,.24,,.13,.03]},e.ACHIEVEMENT_GET={ticks:1,sound:[1.3,0,900,.01,,.12,1,.17,,,497,.08,,,,,,.49,.04]}})(V||(V={}));const Na=[1,1,0],Ha=[0,1,1];function Fa(e){switch(e){case 0:return"giant";case 1:return"large";case 2:return"small"}}function La(e){switch(e){case 0:return 1.25;case 1:return 1.125;case 2:return 1}}function Oa(e){switch(e){case 0:return 3;case 1:return 2;case 2:return 1}}function Ua(e){switch(e){case 0:return V.HYPER_2_SHOOT;case 1:return V.HYPER_1_SHOOT;case 2:return V.PLAYER_SHOOT}}function K0(e){return e===1?Na:Ha}function rs(e){return L.rgb(...K0(e)).setBrightnesses(...me)}function Wa(e){return{spriteSheet:O.flower,frame:0,depth:0,scale:Q0,color:rs(e)}}function Ga(e){u.MixColor.add(e,{start:[1,0,0],end:[0,1,0],ticks:30,type:"brightness",animation:"boomerang"})}function za(e,t){u.MixColor.is(e)&&u.Sprite.is(e)&&(u.MixColor.remove(e),e.sprite[0].color=t)}function Rt(e,t){const r=new J,n=ie(G.playerHealth),s={num:e,health:n,maxHealth:n,damage:1,speed:ie(G.playerSpeed),shotSpeed:ie(G.playerBulletSpeed),shotLifetime:ie(G.playerBulletLifetime),shotSpread:ie(G.playerSpread)*Math.PI/32,bulletSize:"small",shotDelayTicks:0,shotDelayMax:ie(G.playerFireDelay),superchargeMeter:0,superchargeTicks:0,superchargeMax:100,dashTicks:0,dashMax:130,dashState:H.DashState.NONE,dashDirection:Q,invincibilityTicks:0,invincibilityMax:144*2,holdingFire:!0};return u.Pos.add(r,t),u.Tweened.add(r),u.Vel.add(r,t),u.Animate.add(r,{ticksPerFrame:40,animation:"repeat"}),u.Ticks.add(r),u.AnimateWithSpeed.add(r,20),u.Sprite.add(r,[Wa(e)]),u.CircleCollider.add(r,4),u.StayInside.add(r,ho),u.Nudge.add(r,Q),H.Explode.add(r,[{type:"smoke",intensity:10,color:K0(e)},{type:"spark",intensity:20,color:K0(e)}]),H.Player.add(r,s)}function qa(e){const{player:t}=e;t.dashTicks>0?(t.dashState=t.dashTicks>=t.dashMax/2?H.DashState.DASH_INVINCIBLE:H.DashState.DASH_COOLDOWN,t.dashTicks--):t.dashState=H.DashState.NONE,t.invincibilityTicks>0&&t.invincibilityTicks--}function ns(e){return e.player.dashState===H.DashState.DASH_INVINCIBLE||e.player.invincibilityTicks>0}function Ya(e){ns(e)?u.MixColor.is(e)||Ga(e):u.MixColor.is(e)&&za(e,rs(e.player.num))}function Va(e,t,r){const n=e.get(r.player.num,t.numPlayers);if(r.player.dashState===H.DashState.NONE){const s=n?.controlState.leftShoulderButton.pressed??!1,o=n?.controlState.leftStick??Q;s&&!o.equals(Q)?(r.vel=o.normalizeOrThrow().multComps(r.player.speed*2.5),r.player.dashTicks=r.player.dashMax):r.vel=o.multComps(r.player.speed)}if(qa(r),Ya(r),u.Sprite.is(r)){const{dashTicks:s,dashMax:o}=r.player,x=o/2,f=Oe((s-x)/x,0,1);r.sprite[0].angle=2*Math.PI*f*Math.sign(r.sprite[0]?.scale?.x??0)}r.player.dashState===H.DashState.DASH_COOLDOWN&&(r.vel=r.vel.multComps(.95))}const Ka=350;function Xa(e,t,r,n){const s=e.get(n.player.num,r.numPlayers);if(n.player.shotDelayTicks--,s!==void 0){if(s.controlState.rightShoulderButton.pressed&&r.useHyper()){for(let i=0;i<30;i++)r.spawn(Le.spark(n.pos,"rainbow"));r.spawn(ts(n.pos))}const o=s instanceof vt&&s.keyboardAndMouseState.shoot,x=s.controlState.rightStick.length>.15||o,f=!x&&n.player.shotDelayTicks<=0&&n.player.dashState===H.DashState.NONE;if(n.player.holdingFire=f,x&&n.player.shotDelayTicks<=0&&n.player.dashState===H.DashState.NONE){n.player.shotDelayTicks=n.player.shotDelayMax;let l;if(o?l=s.mousePos.sub(n.pos):l=s.controlState.rightStick.normalizeOrThrow(),!o){const d=ie(G.fullAimAssist)?Math.PI*2:s instanceof vt?Math.PI/4:Math.PI/8,m=t.bestWithinRange(p=>H.Enemy.is(p),Ka,n.pos,p=>{const _=p.pos.sub(n.pos).angleBetween(l)??0;return-Math.abs(_)});if(m!==void 0){const[p,_]=m;-_<d&&(l=p.pos.sub(n.pos).normalize()??l)}}const{player:i}=n,c=r.hyperDraining?r.hyperMeter>=J0?0:1:2,a=Mt.shoot({speed:i.shotSpeed,team:"player",rgb:[1,1,0],size:Fa(c),drag:0,lifetime:i.shotLifetime,damage:La(c),inaccuracy:i.shotSpread,spread:c!==2?{amount:Oa(c),angle:Math.PI/8,inaccuracy:Math.PI/16}:void 0,homing:c!==2?{acc:.02,range:100}:void 0},n.pos,l,u.CircleCollider.is(n)?n.circleCollider:0,1,!1);if(c!==2)for(const d of a)u.Rainbow.add(d,{ticksPerCycle:100});V.play(Ua(c)),r.spawn(...a)}if(u.Sprite.is(n)){const l=x?s.controlState.rightStick:n.vel;for(const i of n.sprite)q0(i,l,"x")}}}function $a(e,t){return ns(e)?!1:(e.player.health-=t,e.player.health<=0?(e.player.health=0,u.Destroyed.add(e)):e.player.invincibilityTicks=e.player.invincibilityMax,!0)}const St=e=>H.Player.is(e),Nt=e=>H.Enemy.is(e),Za=e=>H.Gem.is(e);function Fr(e,t,r,n){let s;if(e.targeting.aimed){const o=n?"player":e.shot.team,x=r.closest(t.pos,o==="player"?Nt:St);if(x!==void 0&&(s=x.pos.sub(t.pos).normalize(),s!==void 0&&e.targeting.angleOffset!==0)){const f=Math.atan2(s.y,s.x)+e.targeting.angleOffset;s=h(...Ae(f))}}else s=h(...Ae(e.targeting.angleOffset));if(s!==void 0){const o=Mt.shoot(e.shot,t.pos,s,u.CircleCollider.is(t)?t.circleCollider:0,e.speedMult??1,n);r.spawn(...o)}}var pt;(e=>{function t(s,o){let x=0;for(const f of s.entities)H.Player.is(f)&&Va(o,s,f),(H.Spawner.is(f)||H.Enemy.is(f))&&x++;s.spawnerOrEnemyCount=x}e.beginStep=t;function r(s){for(const o of s.entities)if(H.AnimateWithHealth.is(o))for(const x of o.sprite){const f=x.spriteSheet.locations.length,l=Oe(Math.floor((1-o.health/o.animateWithHealth)*f),0,f-1);x.frame=l}}e.onDraw=r;function n(s,o,x){s.bossTotalHealth=0,s.bossCurrentHealth=0,s.bossName="",s.bossDropActive=!1;for(const f of s.entities){if(u.Destroyed.is(f)&&u.Pos.is(f)){if(H.Explode.is(f)){let l;for(const i of f.explode){switch(i.type){case"smoke":l=Le.smoke;break;case"sparkles":l=Le.sparkle;break;case"spark":l=Le.spark;break}for(let c=0;c<i.intensity;c++)s.spawn(l(f.pos,i.color))}}if(H.Revenge.is(f)&&Math.random()<f.revenge.chance)for(const l of f.revenge.shots)Fr(l,f,s,H.Charmed.is(f))}if(H.Player.is(f)){if(f.player.holdingFire){const l=o.allWithinRange(Za,Aa,f.pos);for(const i of l){const c=i.acc,a=f.pos.sub(i.pos).normalizeOrZero().multComps(ka);i.acc=a.add(c)}}Xa(x,o,s,f)}if(H.Shoot.is(f)){const l=f.shoot.advance();typeof l=="object"&&Fr(l,f,s,H.Charmed.is(f))}if(H.Bullet.is(f)){const l=f;es(f)&&H.Disappeared.add(f),Le.spawnBulletParticle(l,s)}H.Boss.is(f)&&(s.bossTotalHealth+=f.boss.startingHealth,s.bossCurrentHealth+=f.health,s.bossName+=(s.bossName.length>0?"& ":"")+f.boss.name),H.BossDrop.is(f)&&(s.bossDropActive=!0)}}e.endStep=n})(pt||(pt={}));const ja=new fe(["cardinal",1],["diagonal",.5],["eight way",.5],["infinite",.25]);function Qa(e){switch(e){case"cardinal":case"diagonal":return 4;case"eight way":return 8;case"infinite":return 1/0}}function Ja(e){return e==="diagonal"?Math.PI/4:0}const ei=new fe(["acc",3],["vel",1]),ti=new fe(["periodic",1],["random",2]),ri=.01,ni=.04,si=.005;function ss(e){return $(ri,ni+e*si)}const oi=100,ai=500,os=.1,ii=.1,ci=.6;class as{numAngles;angleOffset;periodic;acc;wanderStrength;wanderPatience;wanderChaseChance;constructor(t){const r=ja.pick();this.numAngles=Qa(r),this.angleOffset=Ja(r),this.acc=ei.pick()==="acc",this.periodic=ti.pick()==="periodic",this.wanderStrength=ss(t),this.wanderPatience=Math.floor($(oi,ai)),this.wanderChaseChance=$(ii,ci)}addToEntity(t){return u.Wander.add(t,{numAngles:this.numAngles,angleOffset:this.angleOffset,move:this.acc?{acc:this.wanderStrength*os}:{vel:this.wanderStrength},changeDirections:this.periodic?{ticks:this.wanderPatience}:{chance:1/this.wanderPatience},chase:{chance:this.wanderChaseChance,closest:St}}),this.acc&&u.MaxSpeed.add(t,this.wanderStrength),u.ReverseAtBounds.add(t),t}}const li=new fe(["always chase",5],["keep distance",2]),di=30,hi=150;class fi{keepDist;chaseStrength;constructor(t){this.keepDist=li.pick()==="keep distance"?$(di,hi):void 0,this.chaseStrength=ss(t)}addToEntity(t){return u.AccelerateTo.add(t,{range:1/0,closest:St,acc:this.chaseStrength*os,backUpRange:this.keepDist}),u.MaxSpeed.add(t,this.chaseStrength),t}}const ui=new fe(["wander",4],["chase",7]);function xi(e){return ui.pick()==="wander"?new as(e):new fi(e)}const pi=new as(0);function Lr(e){return e===void 0?"not connected":e instanceof vt?"keyboard":"gamepad"}class gt{constructor(t){this.controlsManagerProvider=t}activeEntities=[];spawnedEntities=[];ticks=0;realTime=0;leftoverTime=0;timeScalar=1;numPlayers=1;spawner;titleScreenFirstTime=!0;static STEP_MS=1e3/(144*2);get controllerTypes(){const t=Lr(this.controlsManagerProvider.get(1,2)),r=Lr(this.controlsManagerProvider.get(2,2));return[t,r]}get scaledStepMs(){return gt.STEP_MS*this.timeScalar}get tweenedTicks(){return this.ticks+this.leftoverTime/this.scaledStepMs}get entities(){return this.activeEntities}clearActiveAndSpawnedEntities(){this.activeEntities.length=0,this.spawnedEntities.length=0}spawn(...t){this.spawnedEntities.push(...t)}activateSpawnedEntities(){this.activeEntities.push(...this.spawnedEntities),this.spawnedEntities.length=0}removeDestroyedEntities(){for(const t of this.activeEntities)u.Destroyed.is(t)&&u.SpawnOnDestroy.is(t)&&this.spawn(...t.spawnOnDestroy(t.pos));Xt(this.activeEntities,t=>!u.Destroyed.is(t))}filterEntities(t,r=!1){Xt(this.activeEntities,t),r&&Xt(this.spawnedEntities,t)}forEachEntityWithCriteria(t,r){for(const n of this.activeEntities)r(n)&&t(n)}animateUniform(t,r,n,s){t.interpTo(r,this.realTime,this.realTime+n,s)}closest(t,r){const n=this.entities.flatMap(s=>r(s)&&u.Pos.is(s)?[s]:[]).sort((s,o)=>s.pos.sub(t).lengthSquared-o.pos.sub(t).lengthSquared);if(n.length!==0)return n[0]}forceSpawn(t){this.activeEntities.push(t)}}var _e=(e=>(e[e.PLAY=0]="PLAY",e[e.PAUSE=1]="PAUSE",e[e.TITLE=2]="TITLE",e))(_e||{});const mi=.08,is=10;class rr extends gt{timeScalarTarget=void 0;timeScalarStep=0;spawnerOrEnemyCount=0;bossTotalHealth=0;bossCurrentHealth=0;bossName="";bossDropActive=!1;lastWaveResult=void 0;points=0;roundTimer=0;waveHits=0;chain=1;_luck=10;get luck(){return this._luck}addLuck(t){this._luck+=t,this._luck=Oe(this._luck,0,is)}resetLuck(){this._luck=0}_hyperDraining=!1;get hyperDraining(){return this._hyperDraining}useHyper(){return!this.hyperDraining&&this.hyperMeter>=J0?(this._hyperDraining=!0,V.play(V.HYPER_BEGIN),!0):!1}resetHyper(){this._hyperDraining=!1,this._hyperMeter=0}_hyperMeter=0;get hyperMeter(){return this._hyperMeter}addHyper(t){this._hyperMeter+=t,this._hyperMeter>G0&&(this._hyperMeter=G0)}tempSlowMo(t,r){if(t<=1)throw new Error("time scalar start must be > 1");if(r<=0)throw new Error("time scalar step must be > 0");this.timeScalarTarget=1,this.timeScalar=t,this.timeScalarStep=r}resetSlowMo(){this.timeScalarTarget=void 0,this.timeScalar=1}stepSlowMo(){this.timeScalarTarget!==void 0&&(this.timeScalar-=this.timeScalarStep*this.timeScalar,this.timeScalar<=this.timeScalarTarget&&(this.timeScalar=this.timeScalarTarget,this.timeScalarTarget=void 0))}_gameState=2;get gameState(){return this._gameState}get scaledStepMs(){return this.gameState===1?gt.STEP_MS:super.scaledStepMs}setGameState(t){this._gameState=t}_player1=void 0;_player2=void 0;clearPlayers(){this._player1=void 0,this._player2=void 0}setPlayer(t){t.player.num===1?this._player1=t:this._player2=t}getPlayer(t){const r=t===1?this._player1:this._player2;return r!==void 0&&!u.Destroyed.is(r)?r:void 0}dashingOrHolding(t){return t===void 0||t.player.holdingFire||t.player.dashState!==H.DashState.NONE}allPlayersHoldingFire(){const t=this.getPlayer(1),r=this.getPlayer(2);return this.dashingOrHolding(t)&&this.dashingOrHolding(r)}drainHyper(){if(this._hyperDraining){const t=this.allPlayersHoldingFire()?ie(G.hyperHoldFireDrain):ie(G.hyperFireDrain);this._hyperMeter-=mi*t,this._hyperMeter<=0&&(this._hyperMeter=0,this._hyperDraining=!1)}}}const cs=144*4,vi=cs*7,gi=144*25,_i=100,bi=1,yi=1e3,Si=1e5,Ei=[1,1,0],wi=[0,1,1],Ai=[0,0,1],ki=[0,1,1],Ci=[.8,.8,.8],Ti=[.2,.2,.2];function Bi(e){const t=new J;return u.Text.add(t,{message:"",color:L.named("white").setBrightnesses(1,0,-1),func:r=>r instanceof rr&&r.bossTotalHealth===0?r.points.toLocaleString():"",hSpacing:0,hAlign:"center",vAlign:"top"}),u.Pos.add(t,e),t}class Ot{}class nr extends Ot{constructor(t,r,n){super(),this.duration=t,this.repetitions=r,this.aimedShot=n}ticks=0;clone(){return new nr(this.duration,this.repetitions,this.aimedShot)}advance(){if(this.ticks++%this.duration===0)return this.aimedShot;if(this.ticks>=this.duration*this.repetitions)return this.ticks=0,"done"}}class ls extends Ot{constructor(t){super(),this.steps=t}stepsTaken=0;advance(){const t=this.child.advance();return t==="done"?(this.stepsTaken++,this.child=this.nextChild(),this.stepsTaken===this.steps?(this.stepsTaken=0,"done"):this.advance()):t}}class sr extends ls{constructor(t,r=t.length){super(r),this.children=t,this.child=this.nextChild()}index=0;child;clone(){return new sr(this.children,this.steps)}nextChild(){const t=this.children[this.index];return this.index++,this.index%=this.children.length,t}}class or extends ls{constructor(t,r){super(r),this.children=t,this.child=this.nextChild()}child;clone(){return new or(this.children,this.steps)}nextChild(){return this.children.pick()}}class ar extends Ot{constructor(t,r,n,s,o,x){super(),this.angle=t,this.delay=r,this.numShots=n,this.aimed=s,this.direction=o,this.shot=x,this.stepAngle=t/n}ticks=0;stepAngle;advance(){if(this.ticks++%this.delay===0)return{targeting:{aimed:this.aimed,angleOffset:this.direction*(this.stepAngle*this.ticks/this.delay-(this.aimed?this.angle/2:Math.PI/2))},shot:this.shot};if(this.ticks>=this.delay*this.numShots)return this.ticks=0,"done"}clone(){return new ar(this.angle,this.delay,this.numShots,this.aimed,this.direction,this.shot)}}class ir extends Ot{constructor(t,r,n,s,o,x){super(),this.minSpeedMult=t,this.maxSpeedMult=r,this.delay=n,this.numShots=s,this.targeting=o,this.shot=x}ticks=0;advance(){if(this.ticks++%this.delay===0)return{targeting:this.targeting,speedMult:tt(this.minSpeedMult,this.maxSpeedMult,this.ticks/(this.numShots*this.delay)),shot:this.shot};if(this.ticks>=this.delay*this.numShots)return this.ticks=0,"done"}clone(){return new ir(this.minSpeedMult,this.maxSpeedMult,this.delay,this.numShots,this.targeting,this.shot)}}const Pi=[1,.5,0],Di=[1,0,1],Ri=[0,1,0],Ii=[0,1,1],Mi=[1,0,0];function Ni(e,t,r){return r-Math.abs(t-e)}function Hi(e){const t=Math.max(80-e*20,30);return Math.round($(t,2*t))}const n0=["small","medium","large","giant"];function Fi(e,t=!1){const r=Math.min(Math.floor(e/2),n0.length-1),n=[...new Array(n0.length)].map((f,l)=>Ni(l,r,3)),s=Ks(n0,n),x=new fe(...s).pick();return t&&x==="giant"?"large":x}const Li=.5,Oi=Math.PI/2;function Ui(){return Math.random()<Li?0:Math.random()*Oi}function Wi(){return $(Math.PI/32,Math.PI/4)}function Gi(e){return 2+Math.floor(.5+Math.random()*e)}function zi(e){return $(.06,.06*Math.random()*(1+e))}function qi(e){return e<1?0:e<2?.005:e<3?.02:e<3?.04:e<4?.08:.12}function Yi(e){return Math.random()<qi(e)?2:1}const Vi=.5,Ki=.3,Xi=8,$i=5,Zi=new fe(["normal",3],["spiral",1],["line",2]);function ji(e){return e.aimed?e.line?Ri:Pi:e.line?Ii:Di}function Qi(e,t){if(t||Math.random()<Vi){const r=Gi(e)*(t?2:1)+(t&&Math.random()<.5?-1:0);return{angle:t?2*Math.PI-2*Math.PI*1/r:Wi(),amount:r}}}const Ji=.01,ec=1;function ds(e,t,r,n=!1){return{speed:zi(e),team:"enemy",rgb:r,size:Fi(e,n),drag:Math.random()<Ji?ec:0,lifetime:1e3,damage:Yi(e),inaccuracy:Ui(),spread:Qi(e,t)}}const tc=.5;function rc(e){const t=Math.random()<tc,r=ds(e,!t,Mi),n=t?0:Math.PI/2*(Math.random()<.5?1:-1);return{targeting:{aimed:t,angleOffset:n},shot:r}}function nc(e,t,r=!1){const n=Math.round($(1,Xi)),s=!t||Math.random()<Ki,o=Zi.pick(),f=ji({aimed:s,line:o==="line"}),l=ds(e,t,f,r),i=l.spread!==void 0?l.spread.amount+Math.max(Math.floor(3-e),0)*4:0,c=Hi(e)+i;switch(o){case"normal":return new nr(c,n,{targeting:{aimed:s,angleOffset:t?Math.PI/2:0},shot:l});case"line":return new ir(.5,1.5,c,n,{aimed:s,angleOffset:0},l);case"spiral":const a=Math.round($(1,$i));return new ar(Math.PI*2*a,c,n,s,Math.random()>.5?1:-1,l)}}function hs(e,t,r=.5,n=.2,s=.2,o=!1){const x=[],f=Math.floor($(t,1.5*t));for(let l=0;l<f;l++){const i=Math.random()<n?hs(e,t,r,n/2,void 0,o):nc(e,Math.random()<=r,o);x.push(i)}if(Math.random()<s){const l=x.map(i=>[i,$(1,3)]);return new or(new fe(...l),Math.floor($(1,f)))}return new sr(x,x.length)}function fs(e,t,r,n){u.MixColor.add(e,{start:[t+s0,r+s0,n+s0],end:[t,r,n],ticks:Or,startTicks:-Or,type:"brightness",animation:"once"})}function sc(e){return Math.floor(5+$(e/5,e))}const Or=50,s0=.7,cr=40;function oc(e){return Math.random()<e*.1}function ac(e){return Math.floor(1+Math.random()*e)}function ic(e){return e<=1?.5:1}function cc(e,t){return t>=cr?.5:e*.05}function lc(e){return Math.min(e/6,.8)}function dc(e){return .5+e*.5}function hc(e){return e*.5}function fc(e){return e*.3}function uc(e){return e*.2}const xc=20,pc=.001,mc=.01,vc=48;class et{constructor(t,r,n,s,o,x,f=!1,l=!1,i=!1){this.preventOrbital=f,this.finalBoss=l,this.dropsEye=i;const c=n>=cr;if(l?this.bossName="???":i?this.bossName="eye keeper":this.bossName=c?sa(d=>d.length<=vc,()=>oa(lc(t),dc(t),hc(t),fc(t),uc(t)),"defeater of odds",100):void 0,this.enemyGraphics=l?_a:va(c?h(3,3):void 0),this.enemyMovement=this.finalBoss?pi:xi(t),this.shotPattern=hs(t,r,s,o,x,ie(G.preventGiant)&&!this.isBoss()),this.health=sc(t)*n*(c||this.finalBoss?ie(G.bossEnemyHealthScalar):ie(G.normalEnemyHealthScalar)),oc(t)){const d=ac(t);d>0&&(this.revengeShots=[...new Array(d)].map(m=>rc(t))),this.revengeChance=ic(t)}!this.preventOrbital&&Math.random()<cc(t,n)&&(this.orbital=new et(t/2,Math.max(r/2,1),n/2,s/2,o/2,x/2,!0));const a=this.finalBoss?30:this.isBoss()?10:1;this.baseScore=Math.floor((t+1)*_i*a)}enemyGraphics;enemyMovement;shotPattern;health;orbital;baseScore;revengeShots;revengeChance=0;bossName;isBoss(){return this.bossName!==void 0}genEnemyEntity(t){const r=new J,n=u.Pos.add(r,t);u.Tweened.add(r),u.Vel.add(r,Q),u.Acc.add(r,Q),H.Enemy.add(r),H.Health.add(r,this.health),H.MaxHealth.add(r,this.health),H.Points.add(r,this.baseScore),this.bossName!==void 0&&H.Boss.add(r,{startingHealth:this.health,name:this.bossName,final:this.finalBoss,dropsEye:this.dropsEye});const s=this.isBoss()?20:10,o=[{type:"spark",intensity:s,color:this.enemyGraphics.chosenColor.data}];this.isBoss()&&o.push({type:"smoke",intensity:s/2,color:this.enemyGraphics.chosenColor.data}),H.Explode.add(r,o),this.enemyGraphics.addToEntity(r),this.enemyMovement.addToEntity(r),H.Shoot.add(r,this.shotPattern.clone());const x=this.enemyGraphics.chosenColor,{topLeftBrightness:f,middleBrightness:l,bottomRightBrightness:i}=x;u.Ticks.add(r),fs(r,f,l,i),u.Nudge.add(r,Q),u.StayInside.add(r,qe),this.revengeShots!==void 0&&H.Revenge.add(r,{shots:[...this.revengeShots],chance:this.revengeChance});const c=[];if(this.orbital!==void 0){const a=this.orbital.genEnemyEntity(t).entity;u.Orbital.add(a,{radius:(u.CircleCollider.is(r)?r.circleCollider:0)+Math.random()*xc,speed:$(pc,mc),angle:Math.PI/2,center:n}),c.push(a)}return this.finalBoss&&u.Rainbow.add(r,{ticksPerCycle:2e3}),{entity:r,orbitals:c}}genEnemyEntitiesAsList(t){const r=this.genEnemyEntity(t);return[r.entity,...r.orbitals]}}const gc=.1,_c=.1,bc=.5,yc=1,Sc=3;function Ec(e,t,r){return[...new Array(e)].map((n,s)=>{const o=s/(e-1),x=tt(t,r,o),f=Math.floor($(yc,Sc));return new et(x,f,1.5,gc,_c,bc)})}const wc=.5,Ac=.2,kc=.2,Cc=2,Tc=5;function Bc(e,t,r){return[...new Array(e)].map((n,s)=>{const o=s/(e-1),x=tt(t,r,o),f=Math.floor($(Cc,Tc));return new et(x,f,cr,wc,Ac,kc)})}const us=[0,0,0],Pc=e=>[Le.smoke(e,us)],Dc={targeting:{aimed:!1,angleOffset:Math.PI/4},shot:{speed:.3,team:"enemy",rgb:[0,0,0],size:"medium",lifetime:200,drag:2,damage:1,spread:{amount:4,angle:1.5*Math.PI}}},Rc={targeting:{aimed:!1,angleOffset:Math.PI/4},shot:{speed:.15,team:"enemy",rgb:[0,0,0],size:"medium",lifetime:200,drag:2,damage:1,inaccuracy:2*Math.PI,spread:{amount:4,angle:1.5*Math.PI}}},Ic={type:"smoke",intensity:5,color:us},Mc=.7,Nc=35;function Hc(e){const t=new J;if(H.Enemy.add(t),H.MaxHealth.is(e)&&H.Health.add(t,Math.min(Nc,e.maxHealth)),u.Pos.is(e)&&u.Pos.add(t,e.pos),u.Vel.add(t,Q),u.Acc.add(t,Q),u.Ticks.add(t),u.CircleCollider.is(e)&&u.CircleCollider.add(t,e.circleCollider),u.Nudge.add(t,Q),u.Sprite.is(e)){const r=e.sprite[e.sprite.length-1];u.Sprite.add(t,[{spriteSheet:O.circleDiameter6,frame:0,color:L.rgb(0,0,0)},{spriteSheet:O.eyeBase,frame:0,color:L.rgb(1,1,1)},{spriteSheet:r.spriteSheet,frame:r.frame,color:L.rgb(0,0,0),scale:r.scale}])}return u.FaceHorizontally.is(e)&&u.FaceHorizontally.add(t,null),u.Animate.is(e)&&u.Animate.add(t,{ticksPerFrame:e.animate.ticksPerFrame,animation:e.animate.animation,speed:e.animate.speed}),u.AnimateWithSpeed.is(e)&&u.AnimateWithSpeed.add(t,e.animateWithSpeed),H.Bullet.add(t,{team:"enemy",damage:1}),u.AccelerateTo.add(t,{range:1/0,closest:St,acc:.001}),u.Drag.add(t,4),H.Revenge.add(t,{shots:[ie(G.originalShadowShot)?Dc:Rc],chance:1}),H.Shadow.add(t),H.Explode.add(t,[Ic]),u.SpawnOnTick.add(t,{ticks:20,spawner:Pc}),fs(t,0,0,0),t}function Fc(e,t,r,n){return e.sub(r).length<t+n}class Lc{constructor(t,r){this.dim=t,this.cells=r,this.grid=zs(r.x*r.y,()=>[]),this.cellDim=t.div(r)}grid;cellDim;indicesValid(t,r){return t>=0&&t<this.cells.x&&r>=0&&r<this.cells.y}getMutable(t,r){return this.grid[r*this.cells.x+t]}get(t,r){return this.indicesValid(t,r)?this.getMutable(t,r):[]}flatToCell(t){return[t%this.cells.x,Math.floor(t/this.cells.x)]}calcCorners(t,r){const n=this.dim.divComps(2),s=t.add(n),o=s.subComps(r).div(this.cellDim).floor(),x=s.addComps(r).div(this.cellDim).floor();return[o.clamp(h(0,0),this.cells.subComps(1)),x.clamp(h(0,0),this.cells.subComps(1))]}clear(){for(const t of this.grid)t.length=0}place(t){const[r,n]=this.calcCorners(t.pos,t.circleCollider);Kt(r,n,(s,o)=>{this.getMutable(s,o).push(t)})}resolve(t,r,n){const s=new Map,o=(l,i)=>{const c=s.get(l);c===void 0?s.set(l,new Set([i])):c.add(i)},x=(l,i)=>{const c=s.get(l);return c===void 0?!1:c.has(i)};let f=0;for(const l of this.grid){for(const i of l)if(t(i)){const[c,a]=this.flatToCell(f);Kt(h(c-1,a-1),h(c+1,a+1),(d,m)=>{this.get(d,m).forEach(p=>{r(p)&&!x(i,p)&&i!==p&&Fc(i.pos,i.circleCollider,p.pos,p.circleCollider)&&(n(i,p),o(i,p))})})}f++}}allWithinRange(t,r,n){const[s,o]=this.calcCorners(n,r),x=new Set;return Kt(s,o,(f,l)=>{this.get(f,l).forEach(i=>{!x.has(i)&&t(i)&&n.sub(i.pos).length<r&&x.add(i)})}),[...x]}bestWithinRange(t,r,n,s){const o=this.allWithinRange(t,r,n);if(o.length===0)return;const x=o.reduce((f,l)=>s(l)>s(f)?l:f);return[x,s(x)]}closestInRange(t,r,n){return this.bestWithinRange(t,r,n,s=>-n.sub(s.pos).length)?.[0]}}function Oc(e,t,r=Ie+.01){const n=t.right-t.left+2,s=t.top-t.bottom+2,o=(t.left+t.right)/2,x=(t.bottom+t.top)/2,f={spriteSheet:e,scale:h(1,s/2),offset:h(t.left,x),frame:0,depth:r},l={spriteSheet:e,scale:h(1,s/2),offset:h(t.right,x),frame:0,depth:r},i={spriteSheet:e,scale:h(n/2,1),offset:h(o,t.bottom),frame:0,depth:r},c={spriteSheet:e,scale:h(n/2,1),offset:h(o,t.top),frame:0,depth:r};return[f,l,i,c]}const Uc=new fe([0,.2],[1,1],[2,.5]),Ur=.4;function Wc(){const e=L.hsl(Math.random()*360,$(.2,1),$(.3,.7)),t=[...e.data];let r;switch(Uc.pick()){case 0:const n=Math.random()<.5?Ur:-Ur;r=e.setHsl(e.h+180,e.s,e.l+n).data;break;case 1:r=L.rgb(.1,.1,.1).data;break;case 2:r=L.rgb(.9,.9,.9).data;break}return[t,r]}function Wr(e){u.MixColor.is(e)&&(e.mixColor.startTicks===void 0||e.ticks-e.mixColor.startTicks>50)&&(e.mixColor.startTicks=e.ticks,H.Boss.is(e)&&(e.boss.final?V.play(V.SCREAMING_HIT):V.play(V.BOSS_HIT)),V.play(V.ENEMY_HIT))}function It(e,t,r){const n=t==="random"?Wc():[[0,0,0],[0,0,0]];e.animateUniform(r.color1Uniform,n[0],1e3),e.animateUniform(r.color2Uniform,n[1],1e3)}function _t(e,t,r,n){e.animateUniform(n.distUniform,t,r,Xs)}const Gr=1e3,Gc=4e3;function zc(e,t,r){_t(e,1,t,r)}function zr(e,t,r){_t(e,.5,t,r)}const qc=450;function X0(e,t,r){const n=new J;u.Pos.add(n,e),u.Vel.add(n,h(...Ae(Math.random()*Math.PI*2)).multComps(.8)),u.Acc.add(n,Q),u.Drag.add(n,3),u.Ticks.add(n),H.BossDrop.add(n,{type:t,amount:r});let s;switch(t){case"health":s=L.named("red");break;case"hyper":s=L.named("cyan");break;case"companion":s=L.hsl(0,1,.5);break;case"luck":s=L.named("lawngreen");break;case"eye":s=L.rgb(1,1,1);break}s.setBrightnesses(...me),u.Sprite.add(n,[...t==="eye"?[{spriteSheet:O.largerEyeOutline,frame:0,color:L.rgb(1,1,1)}]:[],{spriteSheet:O.bubble,frame:0,color:s}]);let o;switch(t){case"health":o=`\u2665${r}`;break;case"hyper":o=`${r}%`;break;case"companion":o=`${jc(r)}`;break;case"luck":o=`\u25B2${r}`;break;case"eye":o="";break}return o!==""&&u.Text.add(n,{message:o,color:s.copy().setHsl(s.h,s.s-.3,s.l+.2),hAlign:"center",vAlign:"middle"}),t==="companion"?u.Rainbow.add(n,{ticksPerCycle:400}):u.MixColor.add(n,{start:[0,0,1],end:[-.5,-.25,0],type:"brightness",ticks:100,animation:"repeat"}),u.CircleCollider.add(n,16),u.Nudge.add(n,Q),u.StayInside.add(n,qe),u.ReverseAtBounds.add(n),H.Explode.add(n,[{intensity:3,type:"sparkles",color:s.copy().data}]),n}function Yc(e){const t=50+e/20*50,r=100+e/10*50;return Math.floor($(t,r))}function Vc(e){return Math.min($(e/20,1),1)}function Kc(e){const t=e/7;return Math.random()<t?2:1}function Xc(e){return 2+(Math.random()<e/10?1:0)}const $c=new fe([1,1],[2,1],[3,.25]);function Zc(e,t){switch(t){case"health":return Kc(e);case"hyper":return Yc(e);case"companion":return Vc(e);case"luck":return $c.pick();case"eye":return 0}}function jc(e){return e>=.9?"S":e>=.8?"A":e>.6?"B":"C"}const Qc=new fe(["health",1],["hyper",1],["companion",.5],["luck",5]);function Jc(e,t,r){const n=r??Xc(e);return Qc.draw(n,t).map(o=>({type:o,amount:Zc(e,o)}))}function el(e,t,r,n){return Jc(e,r,n).map(s=>X0(t,s.type,s.amount))}const qr=Ie+.1,tl=136;class rl{constructor(t=pe.x-tl,r=10,n=h(0,pe.y/2-r/2-1)){this.width=t,this.height=r,this.pos=n,this.bossHealthBottomSpriteData={spriteSheet:O.whiteDot,frame:0,scale:h(t/2+1,r/2),color:L.named("black").setBrightnesses(0,0,.25),depth:qr},this.bossHealthTopSpriteData={spriteSheet:O.whiteDot,frame:0,scale:h(t/2,r/2-1),color:L.named("red").setBrightnesses(.5,0,-.5),depth:qr};const s=new J;u.Pos.add(s,this.pos),u.Sprite.add(s,[this.bossHealthTopSpriteData,this.bossHealthBottomSpriteData]),this.textData={message:"",hAlign:"center",vAlign:"middle",hSpacing:-1,color:L.named("purple").setBrightnesses(1,.1,0)},u.Text.add(s,this.textData),u.Hidden.add(s,!0),this.entity=s}entity;bossHealthBottomSpriteData;bossHealthTopSpriteData;textData;setFill(t){const r=this.width/2*t;this.bossHealthTopSpriteData.scale=h(r,this.height/2-1),this.bossHealthTopSpriteData.color?.setH(t*100),this.bossHealthTopSpriteData.offset=h(-(this.width/2-r),0)}setName(t){this.textData.message=t}spawn(t){t.spawn(this.entity)}setHidden(t){this.entity.hidden=t}}function nl(){const e=new J;return u.Pos.add(e,pe.divComps(2).subComps(3,0).subComps(8*4.5,0)),u.Text.add(e,{message:"",hAlign:"right",vAlign:"top",hSpacing:0,color:L.rgb(0,0,0).setBrightnesses(...me),func:t=>{const r=t;return r.hyperDraining?r.chain>99?"omg":`x${r.chain}`:""}}),u.Ticks.add(e),u.MixColor.add(e,{start:[1,0,0],end:[1,1,0],ticks:100,type:"rgb",animation:"boomerang"}),e}function sl(e,t,r){const n=Math.min(Math.floor(r*t.normalEnemies.length),t.normalEnemies.length-1),o=t.normalEnemies[n].genEnemyEntitiesAsList(e);for(const x of o){const f=x;f.health*=5,H.Enemy.remove(x);const l=x.sprite;l[l.length-1].color=L.hsl(0,.3,.7);const i=h(0,x.circleCollider+8);l.unshift({spriteSheet:O.fontHeart,frame:0,offset:i,color:L.rgb(1,0,0)}),u.Rainbow.add(x,{ticksPerCycle:400}),u.AccelerateTo.is(x)?x.accelerateTo.closest=Nt:u.Wander.is(x)&&x.wander.chase!==void 0&&(x.wander.chase.closest=Nt),H.Charmed.add(x)}return o}class ol{rainbowData;textData;entity;constructor(){const t=new J;u.Pos.add(t,pe.divComps(2).subComps(3,0)),this.textData={message:"",hAlign:"right",vAlign:"top",hSpacing:0,color:L.hsl(0,1,.5).setBrightnesses(1,0,-.5)},u.Text.add(t,this.textData),u.Ticks.add(t),this.rainbowData={ticksPerCycle:200},u.Rainbow.add(t,this.rainbowData),this.entity=t}setNumber(t){t=Math.ceil(t);const r=t>=J0,n=t>=G0;n?this.rainbowData.ticksPerCycle=100:r?this.rainbowData.ticksPerCycle=300:this.rainbowData.ticksPerCycle=2e3,this.textData.message=n?"max!":`${t}%`}spawn(t){t.spawn(this.entity)}}const al=4,il=-.04,cl=4e-5,ll=-.02,dl=5e-6,Yr="notification";function mt(e,t,r,n=!1){r.filterEntities(f=>!(u.Named.is(f)&&f.named===Yr),!0);const s=new J;u.Text.add(s,{message:e,hAlign:"center",vAlign:"middle",color:t,depth:Ie-.01}),u.Pos.add(s,h(0,pe.y/2+al)),u.Tweened.add(s);const[o,x]=n?[ll,dl]:[il,cl];return u.Vel.add(s,h(0,o)),u.Acc.add(s,h(0,x)),u.Ticks.add(s),u.Lifetime.add(s,3e3),u.Named.add(s,Yr),r.spawn(s),s}const hl="pause menu";function Tt(e){return{spriteSheet:O.scribbleCornerEye,frame:0,color:L.named("white").setBrightnesses(0,-.2,-.4),depth:Ie-.001,offset:e,scale:h(Math.sign(e.x),Math.sign(e.y))}}const Ne=40,fl=8;class ul{entity;constructor(t,r,n){const s=new J;u.Pos.add(s,Q),u.Menu.add(s,{title:"paused",contents:[{message:"resume",action:t},{message:"restart",action:r},{message:"exit",action:n}],baseColor:L.named("lightslategray").setBrightnesses(...me),highlightColor:L.named("cornflowerblue").setBrightnesses(...me)}),this.entity=s;const o=Ne+fl;u.Named.add(s,"pause menu"),u.Sprite.add(s,[Tt(h(Ne,Ne)),Tt(h(-Ne,Ne)),Tt(h(Ne,-Ne)),Tt(h(-Ne,-Ne)),{spriteSheet:O.whiteDot,frame:0,scale:h(o,o),color:L.named("black").setBrightnesses(.1,.05,0),depth:Ie-.001}])}}const Vr="deadPetalsWinStreak",Kr="deadPetalsHiScore",Xr="deadPetalsHiScore2P",$r="deadPetalsGameProgress",Zr="deadPetalsInProgress",jr="deadPetalsScorePosted",xl="winStreak",pl="gameProgress",ml="inProgress",Qr="deadPetalsSettings";function Bt(e){try{return localStorage.getItem(e)}catch(t){return console.error("localStorage.getItem error",t),null}}function je(e,t){try{localStorage.setItem(e,t)}catch(r){console.error("localStorage.setItem error",r)}}function Jr(e){return e==="true"?!0:e==="false"?!1:void 0}function en(e){const t=parseFloat(e);if(Number.isFinite(t))return t}class vl{_winStreak;_highScore;_highScore2P;_gameProgress;_inProgress;_scorePosted;_settingJson;_customGameJson={};customHighScore=0;readNumLocalStorage(t){const r=Bt(t);if(r!==null)return en(r)}readBoolLocalStorage(t){const r=Bt(t);if(r!==null)return Jr(r)}readStringLocalStorage(t){const r=Bt(t);if(r!==null)return r}parsePositiveIntHelper(t){const r=this.readNumLocalStorage(t)??0;return Number.isInteger(r)&&r>0?r:0}constructor(t){this._inProgress=this.readBoolLocalStorage(Zr)??this.readBoolLocalStorage(ml)??!1,this._scorePosted=this.readBoolLocalStorage(jr)??!1;const r=this.readNumLocalStorage(Vr)??this.readNumLocalStorage(xl)??0;Number.isInteger(r)&&r>0?this._winStreak=r:this._winStreak=0,this._highScore=this.parsePositiveIntHelper(Kr),this._highScore2P=this.parsePositiveIntHelper(Xr),this._inProgress&&this.setWinStreak(0);const n=this.readStringLocalStorage($r)??this.readStringLocalStorage(pl);n==="none"||n==="eye"||n==="win"?this._gameProgress=n:this._gameProgress="none",this.setWinStreak(this.winStreak),this.setGameProgress(this.gameProgress),this.setInProgress(this.inProgress);const s=Bt(Qr);if(s===null)this._settingJson={};else try{this._settingJson=JSON.parse(s)??{}}catch{console.error("could not parse settings json"),this._settingJson={}}this.updateCustomGameFromQuery(t)}get winStreak(){return this._winStreak}setWinStreak(t){this._winStreak=t,je(Vr,`${this._winStreak}`)}getHighScore(t){return t===1?this._highScore:this._highScore2P}setHighScore(t,r){r===1?this._highScore=t:this._highScore2P=t,je(r===1?Kr:Xr,`${t}`)}get gameProgress(){return this._gameProgress}setGameProgress(t){this._gameProgress=t,je($r,this._gameProgress)}get inProgress(){return this._inProgress}setInProgress(t){this._inProgress=t,je(Zr,`${this._inProgress}`)}get scorePosted(){return this._scorePosted}setScorePosted(t){this._scorePosted=t,je(jr,`${this._scorePosted}`)}setSettingsJson(t,r,n){n?this._customGameJson[t]=r:this._settingJson[t]=r}removeSettingJson(t,r){r?delete this._customGameJson[t]:delete this._settingJson[t]}getSettingsJsonBool(t,r){const s=(r?this._customGameJson:this._settingJson)[t];return s===void 0?s:Jr(s)}getSettingsJsonNum(t,r){const s=(r?this._customGameJson:this._settingJson)[t];return s===void 0?s:en(s)}saveSettingsJson(){je(Qr,JSON.stringify(this._settingJson))}updateCustomGameFromCode(t){let r;try{r=JSON.parse($n.uncrush(decodeURIComponent(t)))}catch(n){return console.error("could not parse query string",n),!1}for(const[n,s]of Object.entries(r)){if(typeof s!="string"){console.error("not a string",s);continue}this._customGameJson[n]=s}return G.updateAllSettings(this),!0}updateCustomGameFromQuery(t){let r;t?(r=new URLSearchParams(document.location.search).get("NewgroundsAPI_CustomParams"),r===null&&console.error("failed to get newgrounds custom params")):r=window.location.href.split("?")[1]??null,r!==null&&this.updateCustomGameFromCode(r)}clearSettings(t){t?this._customGameJson={}:this._settingJson={}}isCustomGame(){return Object.keys(this._customGameJson).length!==0}}function gl(e,t){return t==="vertex"?e.VERTEX_SHADER:e.FRAGMENT_SHADER}function _l(e){const t=e.split(`
`),r=(t.length+1).toString().length;return t.map((n,s)=>(s+1).toString().padEnd(r)+"| "+n)}function bl(e){const t=new Map;return e.split(`
`).forEach(r=>{const n=r.match(/^ERROR: [0-9]+:([0-9]+): (.+)$/);if(n===null)return;const s=parseInt(n[1]),o=n[2],x=t.get(s);x===void 0?t.set(s,[o]):x.push(o)}),t}function yl(e,t,r,n){const s=e.getShaderInfoLog(t);if(s!==""&&s!==null){const o=_l(r),x=bl(s);for(const[f,l]of o.entries()){const i=f+1;console.log(l);const c=x.get(i);if(c!==void 0)for(const a of c)console.error(a)}throw new Error(`${n} shader failed to compile:
${s}`)}}function tn(e,t,r){const n=e.createShader(gl(e,r))??be("shader");return e.shaderSource(n,t),e.compileShader(n),yl(e,n,t,r),n}function xs(e,t,r){const n=e.createProgram()??be("program"),s=tn(e,t,"vertex"),o=tn(e,r,"fragment");return e.attachShader(n,s),e.attachShader(n,o),e.linkProgram(n),n}function ps(e,t,r){const n=e.createFramebuffer()??be("framebuffer");return e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),r!==void 0&&e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,r,0),n}function Sl(){const e=document.querySelector("#canvas")??be("canvas"),t=e.getContext("webgl2",{antialias:!1})??be("gl");return{canvas:e,gl:t}}class Ut{constructor(t,r,n,s){this.gl=t,this.location=t.getUniformLocation(r,n)??be(`uniform location for "${n}"`),this.value=s,this.update(this.value)}location;needsUpdate=!1;value;set(t){this.value=t,this.needsUpdate=!0}updateIfNeeded(){this.needsUpdate&&(this.update(this.value),this.needsUpdate=!1)}}class Wt extends Ut{interpTarget;interpTo(t,r,n,s){this.interpTarget={startValue:this.value,endValue:t,startTime:r,endTime:n,transform:s}}updateInterp(t){if(this.interpTarget!==void 0){if(this.interpTarget.endTime<=t){this.set(this.interpTarget.endValue),this.interpTarget=void 0;return}const r=(t-this.interpTarget.startTime)/(this.interpTarget.endTime-this.interpTarget.startTime),n=this.interpolate(this.interpTarget.startValue,this.interpTarget.endValue,this.interpTarget.transform!==void 0?this.interpTarget.transform(r):r);this.set(n)}}}class El extends Wt{interpolate(t,r,n){return tt(t,r,n)}update(t){this.gl.uniform1f(this.location,t)}}class wl extends Ut{update(t){this.gl.uniform1i(this.location,t)}}class Al extends Wt{interpolate(t,r,n){return Ys(t,r,n)}update(t){this.gl.uniform2f(this.location,...t)}}class kl extends Ut{update(t){this.gl.uniform2i(this.location,...t)}}class Cl extends Wt{interpolate(t,r,n){return zn(t,r,n)}update(t){this.gl.uniform3f(this.location,...t)}}class Tl extends Ut{update(t){this.gl.uniform3i(this.location,...t)}}class ms{constructor(t,r){this.gl=t,this.program=r}uniforms=[];add(t){return this.uniforms.push(t),t}animateUniforms(t){for(const r of this.uniforms)r instanceof Wt&&r.updateInterp(t)}updateIfNeeded(){for(const t of this.uniforms)t.updateIfNeeded()}float(t,r){return this.add(new El(this.gl,this.program,t,r))}int(t,r){return this.add(new wl(this.gl,this.program,t,r))}vec2(t,r){return this.add(new Al(this.gl,this.program,t,r))}ivec2(t,r){return this.add(new kl(this.gl,this.program,t,r))}vec3(t,r){return this.add(new Cl(this.gl,this.program,t,r))}ivec3(t,r){return this.add(new Tl(this.gl,this.program,t,r))}}const Bl=`#version 300 es

in vec4 a_position;

void main() {
  gl_Position = a_position;
}
`;class vs{constructor(t,r,n,s,o){this.gl=t,this.framebuffer=n,this.program=xs(t,Bl,r),t.useProgram(this.program);const x=t.getAttribLocation(this.program,"a_position");this.vao=t.createVertexArray()??be("vao"),t.bindVertexArray(this.vao);const f=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,f),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),t.STATIC_DRAW),t.enableVertexAttribArray(x),t.vertexAttribPointer(x,2,t.FLOAT,!1,0,0);const l=t.getUniformLocation(this.program,"u_scene")??be("scene texture location");if(t.uniform1i(l,s),o!==void 0){const i=t.getUniformLocation(this.program,"u_depth")??be("depth texture location");t.uniform1i(i,o)}this.uniformFactory=new ms(t,this.program)}vao;program;uniformFactory;ready(t){this.gl.bindVertexArray(this.vao),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer),this.gl.useProgram(this.program),this.uniformFactory.animateUniforms(t),this.uniformFactory.updateIfNeeded()}draw(){this.gl.drawArrays(this.gl.TRIANGLES,0,6)}}const Pl=""+new URL("../atlas.png",import.meta.url).href;function Dl(e){return new Promise((t,r)=>{const n=new Image;n.src=e,n.onload=()=>{t(n)},n.onerror=()=>{r(new Error("could not load image"))}})}function lr(e){e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)}const $0=await Dl(Pl),Rl=h($0.width,$0.height);function rn(e,t,r){const n=e.createTexture()??be("texture");return e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,r,0,e.RGBA,e.UNSIGNED_BYTE,null),lr(e),n}function Il(e,t){const r=e.createTexture()??be("texture");return e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),lr(e),r}function Ml(e,t,r){const n=e.createTexture()??be("texture");return e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.DEPTH_COMPONENT24,t,r,0,e.DEPTH_COMPONENT,e.UNSIGNED_INT,null),lr(e),n}class bt{atlas;scene;depth;background;static ATLAS_NUM=0;static SCENE_NUM=1;static DEPTH_NUM=2;static BACKGROUND_NUM=3;constructor(t,r){this.atlas=Il(t,$0),this.scene=rn(t,r.x,r.y),this.depth=Ml(t,r.x,r.y),this.background=rn(t,r.x,r.y),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.atlas),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this.scene),t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,this.depth),t.activeTexture(t.TEXTURE3),t.bindTexture(t.TEXTURE_2D,this.background)}}const Nl=`#version 300 es

precision highp float;
precision highp usampler2D;

out vec4 outColor;

uniform sampler2D u_scene;
uniform float u_aberration;

#define RES vec2(3840., 1080.)

void main() {
  vec2 pos = gl_FragCoord.xy;
  float brightness = int(pos.y / 2.) % 2 == 0 ? -0.23 : 0.02;
  float vignette = 1. - length(0.5 * (pos - RES / 2.) / RES);
  vec3 color = vec3(
    texture(u_scene, (pos + vec2(u_aberration, 0)) / RES).r,
    texture(u_scene, pos / RES).g,
    texture(u_scene, (pos - vec2(u_aberration, 0)) / RES).b
  );
  outColor = vec4(color * vignette + brightness, 1);
}
`;class Hl extends vs{aberration;constructor(t){super(t,Nl,null,bt.BACKGROUND_NUM),this.aberration=this.uniformFactory.float("u_aberration",0)}}function gs(e,t){const r=speechSynthesis.getVoices();if(r.length===0)return;const n=r.find(o=>o.name===e)??r[0],s=new SpeechSynthesisUtterance(t);s.voice=n,speechSynthesis.speak(s)}function Fl(e,t){return h(Math.round($(e.left+t,e.right-t)),Math.round($(e.bottom+t,e.top-t)))}const Ll=32,Ol=144*4,Ul=.3,Wl=6;var Re=(e=>(e[e.BOSS=0]="BOSS",e[e.NORMAL=1]="NORMAL",e[e.BOSS_RUSH=2]="BOSS_RUSH",e[e.DONE=3]="DONE",e[e.NEW_LEVEL=4]="NEW_LEVEL",e[e.FINAL_BOSS=5]="FINAL_BOSS",e))(Re||{});class Gl{constructor(t,r,n,s,o,x,f,l,i){this.wavesPerLevel=o,this.minWaveSize=x,this.maxWaveSize=f,this.normalEnemyFrameLength=l,this.trueFinalBossUnlocked=i,this.normalEnemies=Ec(t,n,s),this.bossEnemies=Bc(r,n,s),i?this.finalBoss=new et(s+1,6,100,.5,.5,.5,!0,!0,!1):this.finalBoss=new et(s,5,40,.4,.4,.4,!1,!1,!0),this.levels=this.bossEnemies.length,this.totalWaves=this.levels*this.wavesPerLevel}normalEnemies;bossEnemies;levels;totalWaves;currWave=0;currLevel=0;bossWave=!1;bossRushCounter=0;finalBoss;spawnedFinalBoss=!1;normalEnemyFrameIndex(){return Math.floor(this.currWave/this.totalWaves*(this.normalEnemies.length-this.normalEnemyFrameLength))}calcWaveSize(t){return Math.floor(tt(this.minWaveSize,this.maxWaveSize,t))}advanceLevelAndWave(){this.currWave++,this.currWave%this.wavesPerLevel===0?(this.currLevel++,this.bossWave=!0):this.bossWave=!1}nextWaveBuilders(){if(this.bossWave)return[this.bossEnemies[this.currLevel-1]];const t=this.normalEnemyFrameIndex(),r=this.currWave/this.totalWaves,n=this.calcWaveSize(r);return[...new Array(n)].map(s=>{const o=Math.floor(Math.random()*(this.normalEnemyFrameLength+1));return this.normalEnemies[Math.min(t+o,this.normalEnemies.length-1)]})}bossRushBuilders(){const t=this.bossRushCounter/this.bossEnemies.length,r=Math.min(Math.ceil(this.calcWaveSize(t)*Ul),Wl);return[...new Array(r)].map(n=>{const s=Math.floor(Math.random()*this.normalEnemies.length);return this.normalEnemies[s]}).concat([this.bossEnemies[this.bossRushCounter-1]])}buildersToSpawners(t){return t.map(n=>Vl(n.finalBoss||n.dropsEye?Q:Fl(qe,Ll),Ol,n))}spawnNextWave(t){if(this.currWave>=this.totalWaves)return this.bossRushCounter++,this.bossRushCounter>this.bossEnemies.length?this.spawnedFinalBoss?3:(t.spawn(...this.buildersToSpawners([this.finalBoss])),this.spawnedFinalBoss=!0,5):(t.spawn(...this.buildersToSpawners(this.bossRushBuilders())),2);const r=this.bossWave||this.currWave===0;return this.advanceLevelAndWave(),t.spawn(...this.buildersToSpawners(this.nextWaveBuilders())),this.bossWave?0:r?4:1}}const zl=3,ql={type:"smoke",intensity:5,color:[.5,.5,.5]},Yl={type:"spark",intensity:50,color:"rainbow"};function Vl(e,t,r){const n=new J;r.finalBoss?t=Math.floor(t*2.5):r.isBoss()&&(t=Math.floor(t*1.5));const s=r.finalBoss?"???":r.isBoss()?"!!BOSS!!":"!",o=r.isBoss()?[1,.7,.7]:[1,1,1];u.Text.add(n,{message:s,color:L.rgb(...o).setBrightnesses(0,-.3,-.6),hAlign:"center",vAlign:"middle",hSpacing:0}),H.Spawner.add(n),u.Pos.add(n,e),u.Ticks.add(n),u.Lifetime.add(n,t);const x=r.bossName;ie(G.speakBossNames)&&x!==void 0?u.SpawnOnDestroy.add(n,c=>(gs("Victoria",x),V.play(V.SPAWN_BOSS),r.genEnemyEntitiesAsList(c))):u.SpawnOnDestroy.add(n,c=>(V.play(V.SPAWN_NORMAL),r.genEnemyEntitiesAsList(c)));const f=r.finalBoss?4:r.isBoss()?2:1,l=zl*f;u.Sprite.add(n,[{spriteSheet:O.spawnerTarget,frame:0,scale:h(l,l)}]),r.finalBoss?u.Rainbow.add(n,{ticksPerCycle:1e3}):u.MixColor.add(n,{start:[1,1,1],end:r.isBoss()?[1,0,0]:[0,0,0],ticks:30,type:"rgb",animation:"boomerang"});const i=-((l-1)/t)/f;return u.ScaleVel.add(n,h(i,i)),H.Explode.add(n,[r.finalBoss?Yl:ql]),n}const Kl=`#version 300 es

precision highp float;
precision highp usampler2D;

out vec4 outColor;

uniform sampler2D u_scene;
uniform sampler2D u_depth;

#define PI 3.14159
#define ANGLE (PI / 8.)

#define RES vec2(3840. / 4., 1080. / 4.)
#define ASPECT (32. / 9.)

uniform vec3 u_color1; // vec3(0.7961, 0.5333, 0.0039)
uniform vec3 u_color2; // vec3(0.1216, 0.5294, 0.4745)

uniform vec3 u_blendColor;
uniform float u_blendAmount;

uniform float u_ticks;
uniform float u_dist;

float luma(vec3 color) {
  return dot(color, vec3(0.299, 0.587, 0.114));
}

vec3 recolor(vec3 color, float mixAmount, vec3 tint) {
  return mix(color, vec3(luma(color)) * tint, mixAmount);
}

float linearizeDepth(float depth, float near, float far) {
  float z = depth * 2. - 1.;
  return 2. * near * far / (far + near - z * (far - near));
}

vec3 background() {
  float time = u_ticks / 388.;
  vec2 uv = (gl_FragCoord.xy / RES - 0.5) * vec2(ASPECT, 1.);
  float theta = atan(uv.y, uv.x);
  float r = length(uv) + 0.05; // to avoid center being nevative from sin wiggle

  float row = mod(r + sin(time) * 0.02 * sin(theta * 9.), u_dist) / u_dist;
  float slice = mod(theta + 0.5 * sin(time) * sin(r * 18.) * 0.2, ANGLE) / ANGLE;

  float steppedRow = step(0.5, row);
  float steppedSlice = step(0.5, slice);

  float brightness = (row + slice) / 2. - 0.5;
  return mix(u_color1, u_color2, mod(steppedRow + steppedSlice, 2.)) + brightness * 1.5;
}

void main() {
  vec2 pos = gl_FragCoord.xy;
  float depth = linearizeDepth(texture(u_depth, pos / RES).r, -1., 1.);

  // prevent recoloring of UI elements
  if (depth < 0.) {
    outColor = vec4(texture(u_scene, pos / RES).rgb, 1.);
    return;
  }

  vec3 color;
  if (depth == 1.) {
    float brightness = (texture(u_depth, (pos + vec2(-2, 2)) / RES).r != 1.) ? 0.2 : 1.;
    color = vec3(background()) * brightness;
  } else {
    color = texture(u_scene, pos / RES).rgb;
  }

  outColor = vec4(recolor(color, u_blendAmount, u_blendColor), 1);
}`;class Xl extends vs{color1Uniform;color2Uniform;ticksUniform;blendColor;blendAmount;distUniform;constructor(t,r){const n=ps(t,r.background),s=bt.SCENE_NUM,o=bt.DEPTH_NUM;super(t,Kl,n,s,o),this.color1Uniform=this.uniformFactory.vec3("u_color1",[0,0,0]),this.color2Uniform=this.uniformFactory.vec3("u_color2",[0,0,0]),this.ticksUniform=this.uniformFactory.float("u_ticks",0),this.blendColor=this.uniformFactory.vec3("u_blendColor",[1,1,1]),this.blendAmount=this.uniformFactory.float("u_blendAmount",0),this.distUniform=this.uniformFactory.float("u_dist",.5)}}function $l(e,t){const r=new J;return u.Ticks.add(r),u.Lifetime.add(r,e),u.Pos.add(r,Q),u.SpawnOnDestroy.add(r,()=>(t(),[])),r}const Zl=new fe(["utterly dead",1],["completely dead",1],["perfectly dead",1],["absolutely dead",1],["thoroughly dead",1],["categorically dead",1],["declared dead",1],["unundead",.125],["dead as a doornail",1],["dead on arrival",.125],["expired",.25],["passed on",1],["bloodless",1],["bought the farm",.125],["pushing up daisies",.5],["R.I.P.",.125],["perished",.125],["departed",.125],["not alive",.125],["kaput",.125],["bona fide died",.125],["just the deadest",1]),dr="win streak eye";function jl(e){const t=new J;return u.Named.add(t,dr),u.Pos.add(t,e),u.Sprite.add(t,[{spriteSheet:O.largerEyeOutline,frame:0,color:L.hsl(0,1,.5).setBrightnesses(...me)}]),u.Ticks.add(t),u.Rainbow.add(t,{ticksPerCycle:1e3}),t}function Ql(e,t,r,n){const s=new J;return u.Named.add(s,dr),u.Pos.add(s,e),u.Sprite.add(s,[{spriteSheet:O.closedEyeOutline,frame:0,color:t?L.hsl(0,.3,.6).setBrightnesses(...me):er}]),t&&(u.Ticks.add(s),u.Lifetime.add(s,r),u.SpawnOnDestroy.add(s,o=>(n(),[jl(o)])),u.Rainbow.add(s,{ticksPerCycle:1e3}),H.Explode.add(s,[{type:"spark",color:"rainbow",intensity:10},{type:"sparkles",color:"rainbow",intensity:10}])),s}const Jl=`wasd: move
arrow keys: shoot
space: dash
shift: hyper

enter/e: menu select
tab/q: menu back
p: pause
shift + f: fullscreen

in lieu of real keybinding which will come
later, you may press 9 to switch dash and hyper
if it is more comfortable for you.`,ed=`left stick: move
right stick: shoot
left shoulder: dash
right shoulder: hyper

button 0: select
button 1: back
start: pause

control rebinding will be available in a
post-jam version of the game!`,td=`hyper is charged with gems. you attract
gems when not shooting or dashing. you can
charge hyper up to 200%. using a hyper
cancels bullets into more gems. hyper depletes
more slowly when neither player is firing.
hyper >100% does bonus damage.`,rd=`bosses drop one of four items:
green: boss drop luck
cyan: charge hyper meter
red: heal hp
rainbow: companion. quality from A to S

boss rush bosses only drop one pickup.
you can only pick up one item...
so choose wisely!`,nd=`bosses and enemies have randomly generated
appearance and behavior with increasing
difficulty. try to pick up on their behavior
because you will see them again in the same
run. companions (see boss drops) are friendly
versions of these enemies drawn
from the same pool.`,sd=`yes. in both a "you can do it i believe
in you" way and a "yes the game as an end" way.`,od="title screen menu";class ad{entity;data;constructor(t,r,n,s,o,x,f=er,l=qn,i,c){this.data={title:"dead petals",onExit:()=>{x.filterEntities(d=>!(u.Named.is(d)&&d.named===dr)),o()},onEnter:s,contents:[{message:"1 player",action:t},{message:"2 player",action:r},...n!==void 0?[{message:"fullscreen",action:n}]:[],{title:"how to play",contents:[{title:"keyboard controls",contents:Jl,baseColor:f,highlightColor:l,_selectionIndex:0,_parent:void 0},{title:"gamepad controls",contents:ed,baseColor:f,highlightColor:l,_selectionIndex:0,_parent:void 0},{title:"hyper",contents:td,baseColor:f,highlightColor:l,_selectionIndex:0,_parent:void 0},{title:"boss drops",contents:rd,baseColor:f,highlightColor:l,_selectionIndex:0,_parent:void 0},{title:"enemies and bosses",contents:nd,baseColor:f,highlightColor:l,_selectionIndex:0,_parent:void 0},{title:"can i win?",contents:sd,baseColor:f,highlightColor:l,_selectionIndex:0,_parent:void 0}],baseColor:f,highlightColor:l,_selectionIndex:0,_parent:void 0},...jo(f,l,i,s,()=>{mt("copied!",L.named("limegreen"),x)},()=>{mt("not copied...",L.named("red"),x)},()=>{mt("invalid game code",L.named("red"),x)},c)],baseColor:f,highlightColor:l};const a=u.Menu.add(new J,this.data);u.Named.add(a,od),this.entity=a}setTitle(t){this.data.title=t}spawn(t){t.spawn(this.entity)}block(){this.entity.menu._block=!0}unblock(){this.entity.menu._block=!1}}const _s="click to focus",id=`arrows:  nav menu
enter/e: select
tab/q:   back`,cd=`left stick: nav menu
button 0:   select
button 1:   back`;function ld(e){return`custom hi: ${e.toLocaleString()}`}function dd(e,t){return`1p hi: ${e.toLocaleString()}
2p hi: ${t.toLocaleString()}`}function hd(e){const t=new J;return u.Pos.add(t,pe.divComps(-2)),u.Text.add(t,{message:`${e.isCustomGame()?`custom game!
`:""}streak: ${e.isCustomGame()?"frozen":e.winStreak}
${e.isCustomGame()?ld(e.customHighScore):dd(e.getHighScore(1),e.getHighScore(2))}`,hAlign:"left",vAlign:"bottom",hSpacing:0,color:L.named("darkgray").setBrightnesses(...me)})}function fd(){const e=new J;return u.Pos.add(e,pe.divComps(2,-2)),u.Text.add(e,{message:`v1.3.4-wide
game by bandaloo`,hAlign:"right",vAlign:"bottom",hSpacing:0,color:L.named("darkgray").setBrightnesses(...me)})}function ud(){const e=new J;return u.Named.add(e,_s),u.Pos.add(e,h(0,-pe.y/2)),u.Ticks.add(e),u.MixColor.add(e,{start:[-.8,-.8,-.8],end:[.5,.5,1],type:"brightness",ticks:100,animation:"boomerang"}),u.Text.add(e,{message:"click to focus window!",hAlign:"center",vAlign:"bottom",hSpacing:0,color:L.named("yellow").setBrightnesses(...me)})}function xd(){const e=new J;return u.Pos.add(e,pe.divComps(-2,2)),u.Ticks.add(e),u.MixColor.add(e,{start:[1,.2,0],end:[-.1,.5,1],type:"brightness",ticks:200,animation:"boomerang"}),u.Text.add(e,{message:"",hAlign:"left",vAlign:"top",hSpacing:0,color:L.named("darkgray").setBrightnesses(...me),func:t=>t.controllerTypes[0]==="keyboard"?id:cd})}function pd(){const e=new J;return u.Pos.add(e,pe.divComps(2,2)),u.Ticks.add(e),u.MixColor.add(e,{start:[1,.2,0],end:[-.1,.5,1],type:"brightness",ticks:200,animation:"boomerang"}),u.Text.add(e,{message:`gamepads supported!

(required for
2 players)`,hAlign:"right",vAlign:"top",hSpacing:0,color:L.named("darkgray").setBrightnesses(...me),func:t=>{const[r,n]=t.controllerTypes;return`p1: ${r}
p2: ${n}
${r==="keyboard"?`
not seeing gamepad?
hit buttons!`:""}`}})}class yt{constructor(t,r,n,s){this.bottomLeft=t,this.bottomRight=r,this.topLeft=n,this.topRight=s}static forPosition(t){return new yt(h(-t.x/2,-t.y/2),h(t.x/2,-t.y/2),h(-t.x/2,t.y/2),h(t.x/2,t.y/2))}static forTexcoord(t,r){return new yt(h(t.x,t.y+r.y),h(t.x+r.x,t.y+r.y),t,h(t.x+r.x,t.y))}forEach(t){return this.bottomLeft=t(this.bottomLeft),this.bottomRight=t(this.bottomRight),this.topLeft=t(this.topLeft),this.topRight=t(this.topRight),this}toData(t){return t===void 0?[this.topLeft.x,this.topLeft.y,this.bottomLeft.x,this.bottomLeft.y,this.topRight.x,this.topRight.y,this.topRight.x,this.topRight.y,this.bottomLeft.x,this.bottomLeft.y,this.bottomRight.x,this.bottomRight.y]:[this.topLeft.x,this.topLeft.y,t,this.bottomLeft.x,this.bottomLeft.y,t,this.topRight.x,this.topRight.y,t,this.topRight.x,this.topRight.y,t,this.bottomLeft.x,this.bottomLeft.y,t,this.bottomRight.x,this.bottomRight.y,t]}}class md{constructor(t,r,n,s){this.gl=t,this.vertexManager=r,this.backgroundPostManager=n,this.finalPostManager=s,this.gl.enable(this.gl.DEPTH_TEST)}ready(){this.vertexManager.ready()}addSprites(t,r){for(const n of t){const s=yt.forPosition(n.spriteSheet.dimensions),o=n.scale;o!==void 0&&s.forEach(d=>d.mult(o));const x=n.angle;x!==void 0&&s.forEach(d=>d.rotate(x));const f=n.offset===void 0?r:r.add(n.offset);s.forEach(d=>d.add(f));const l=yt.forTexcoord(n.spriteSheet.locations[n.frame],n.spriteSheet.dimensions),i=s.toData(n.depth??0),c=l.toData(),a=n.color!==void 0?n.color.toVertexDataForQuad():L.WHITE_DATA;this.vertexManager.copyAttributesIntoArrays(i,c,a)}}draw(t){this.vertexManager.draw(),this.backgroundPostManager.ready(t),this.backgroundPostManager.draw(),this.finalPostManager.ready(t),this.finalPostManager.draw()}}const vd=`#version 300 es

in vec4 a_position;
in vec2 a_texcoord;
in vec4 a_blendColor;

out vec2 v_texcoord;
out vec4 v_blendColor;

uniform vec2 u_atlasRes;
 
void main() {
  gl_Position = a_position * vec4(2./3840., 2./1080., 1., 1.) - vec4(.75, .75, 0., 0.);
  v_texcoord = a_texcoord / u_atlasRes;
  v_blendColor = a_blendColor;
}
`,gd=`#version 300 es

precision highp float;

in vec2 v_texcoord;
in vec4 v_blendColor;

out vec4 outColor;

uniform sampler2D u_texture;

void main() {
  vec4 color = texture(u_texture, v_texcoord);

  if (color.a != 1.) discard;

  if (color.r == color.g && color.g == color.b) {
    outColor = vec4(color.rgb * v_blendColor.rgb + vec3(v_blendColor.a), 1);
  } else {
    outColor = vec4(color.rgb + vec3(v_blendColor.a), 1);
  }
}
`,_d=65536,bs=Math.floor(_d/3);function bd(e,t,r){for(let n=0;n<e.length;n++)t[r+n]=e[n]}class o0{constructor(t,r,n,s,o){this.size=o,this.buffer=t.createBuffer()??be("buffer"),this.location=t.getAttribLocation(r,n),this.array=new Float32Array(bs*o*3),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.enableVertexAttribArray(this.location),t.vertexAttribPointer(this.location,o,t.FLOAT,s,0,0),t.bufferData(t.ARRAY_BUFFER,this.array,t.DYNAMIC_DRAW)}buffer;location;array;update(t,r){bd(t,this.array,r*this.size*3)}pushDataToGpu(t,r){t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferSubData(t.ARRAY_BUFFER,0,this.array,0,r*3*this.size)}}class yd{constructor(t,r){this.gl=t,this.textureManager=r,this.program=xs(t,vd,gd),t.useProgram(this.program),this.vao=t.createVertexArray()??be("vao"),t.bindVertexArray(this.vao),this.positions=new o0(t,this.program,"a_position",!1,3),this.texcoords=new o0(t,this.program,"a_texcoord",!0,2),this.colors=new o0(t,this.program,"a_blendColor",!0,4),this.uniformFactory=new ms(t,this.program),this.texture=this.uniformFactory.int("u_texture",bt.ATLAS_NUM),this.atlasRes=this.uniformFactory.vec2("u_atlasRes",Rl.data),this.framebuffer=ps(this.gl,this.textureManager.scene,this.textureManager.depth)}index=0;program;vao;positions;colors;texcoords;uniformFactory;atlasRes;texture;framebuffer;check(t,r,n){const s=t.length/this.positions.size,o=r.length/this.texcoords.size,x=n.length/this.colors.size;if(!(s==o&&x==o&&Number.isInteger(s)))throw new Error("attribute array lengths not correct sizes");const l=s;return this.index+l<=bs}pushDataToGpu(){this.positions.pushDataToGpu(this.gl,this.index),this.texcoords.pushDataToGpu(this.gl,this.index),this.colors.pushDataToGpu(this.gl,this.index)}ready(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer),this.gl.useProgram(this.program),this.gl.bindVertexArray(this.vao),this.uniformFactory.updateIfNeeded(),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.index=0}copyAttributesIntoArrays(t,r,n){this.check(t,r,n)||(this.draw(),this.index=0),this.positions.update(t,this.index),this.texcoords.update(r,this.index),this.colors.update(n,this.index);const o=t.length/this.positions.size/3;this.index+=o}draw(){this.pushDataToGpu(),this.gl.drawArrays(this.gl.TRIANGLES,0,this.index*3)}}var X=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sd(e){var t=e.default;if(typeof t=="function"){var r=function(){return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var Ed={exports:{}};function wd(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var a0={exports:{}};const Ad=new Proxy({},{get(e,t){throw new Error(`Module "" has been externalized for browser compatibility. Cannot access ".${t}" in client code.`)}}),kd=Object.freeze(Object.defineProperty({__proto__:null,default:Ad},Symbol.toStringTag,{value:"Module"})),Cd=Sd(kd);var nn;function j(){return nn||(nn=1,function(e,t){(function(r,n){e.exports=n()})(X,function(){var r=r||function(n,s){var o;if(typeof window<"u"&&window.crypto&&(o=window.crypto),typeof self<"u"&&self.crypto&&(o=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(o=globalThis.crypto),!o&&typeof window<"u"&&window.msCrypto&&(o=window.msCrypto),!o&&typeof X<"u"&&X.crypto&&(o=X.crypto),!o&&typeof wd=="function")try{o=Cd}catch{}var x=function(){if(o){if(typeof o.getRandomValues=="function")try{return o.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof o.randomBytes=="function")try{return o.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},f=Object.create||function(){function g(){}return function(v){var b;return g.prototype=v,b=new g,g.prototype=null,b}}(),l={},i=l.lib={},c=i.Base=function(){return{extend:function(g){var v=f(this);return g&&v.mixIn(g),(!v.hasOwnProperty("init")||this.init===v.init)&&(v.init=function(){v.$super.init.apply(this,arguments)}),v.init.prototype=v,v.$super=this,v},create:function(){var g=this.extend();return g.init.apply(g,arguments),g},init:function(){},mixIn:function(g){for(var v in g)g.hasOwnProperty(v)&&(this[v]=g[v]);g.hasOwnProperty("toString")&&(this.toString=g.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),a=i.WordArray=c.extend({init:function(g,v){g=this.words=g||[],v!=s?this.sigBytes=v:this.sigBytes=g.length*4},toString:function(g){return(g||m).stringify(this)},concat:function(g){var v=this.words,b=g.words,w=this.sigBytes,A=g.sigBytes;if(this.clamp(),w%4)for(var T=0;T<A;T++){var P=b[T>>>2]>>>24-T%4*8&255;v[w+T>>>2]|=P<<24-(w+T)%4*8}else for(var F=0;F<A;F+=4)v[w+F>>>2]=b[F>>>2];return this.sigBytes+=A,this},clamp:function(){var g=this.words,v=this.sigBytes;g[v>>>2]&=4294967295<<32-v%4*8,g.length=n.ceil(v/4)},clone:function(){var g=c.clone.call(this);return g.words=this.words.slice(0),g},random:function(g){for(var v=[],b=0;b<g;b+=4)v.push(x());return new a.init(v,g)}}),d=l.enc={},m=d.Hex={stringify:function(g){for(var v=g.words,b=g.sigBytes,w=[],A=0;A<b;A++){var T=v[A>>>2]>>>24-A%4*8&255;w.push((T>>>4).toString(16)),w.push((T&15).toString(16))}return w.join("")},parse:function(g){for(var v=g.length,b=[],w=0;w<v;w+=2)b[w>>>3]|=parseInt(g.substr(w,2),16)<<24-w%8*4;return new a.init(b,v/2)}},p=d.Latin1={stringify:function(g){for(var v=g.words,b=g.sigBytes,w=[],A=0;A<b;A++){var T=v[A>>>2]>>>24-A%4*8&255;w.push(String.fromCharCode(T))}return w.join("")},parse:function(g){for(var v=g.length,b=[],w=0;w<v;w++)b[w>>>2]|=(g.charCodeAt(w)&255)<<24-w%4*8;return new a.init(b,v)}},_=d.Utf8={stringify:function(g){try{return decodeURIComponent(escape(p.stringify(g)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(g){return p.parse(unescape(encodeURIComponent(g)))}},y=i.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(g){typeof g=="string"&&(g=_.parse(g)),this._data.concat(g),this._nDataBytes+=g.sigBytes},_process:function(g){var v,b=this._data,w=b.words,A=b.sigBytes,T=this.blockSize,P=T*4,F=A/P;g?F=n.ceil(F):F=n.max((F|0)-this._minBufferSize,0);var S=F*T,k=n.min(S*4,A);if(S){for(var B=0;B<S;B+=T)this._doProcessBlock(w,B);v=w.splice(0,S),b.sigBytes-=k}return new a.init(v,k)},clone:function(){var g=c.clone.call(this);return g._data=this._data.clone(),g},_minBufferSize:0});i.Hasher=y.extend({cfg:c.extend(),init:function(g){this.cfg=this.cfg.extend(g),this.reset()},reset:function(){y.reset.call(this),this._doReset()},update:function(g){return this._append(g),this._process(),this},finalize:function(g){g&&this._append(g);var v=this._doFinalize();return v},blockSize:16,_createHelper:function(g){return function(v,b){return new g.init(b).finalize(v)}},_createHmacHelper:function(g){return function(v,b){return new E.HMAC.init(g,b).finalize(v)}}});var E=l.algo={};return l}(Math);return r})}(a0)),a0.exports}var i0={exports:{}},sn;function Gt(){return sn||(sn=1,function(e,t){(function(r,n){e.exports=n(j())})(X,function(r){return function(n){var s=r,o=s.lib,x=o.Base,f=o.WordArray,l=s.x64={};l.Word=x.extend({init:function(i,c){this.high=i,this.low=c}}),l.WordArray=x.extend({init:function(i,c){i=this.words=i||[],c!=n?this.sigBytes=c:this.sigBytes=i.length*8},toX32:function(){for(var i=this.words,c=i.length,a=[],d=0;d<c;d++){var m=i[d];a.push(m.high),a.push(m.low)}return f.create(a,this.sigBytes)},clone:function(){for(var i=x.clone.call(this),c=i.words=this.words.slice(0),a=c.length,d=0;d<a;d++)c[d]=c[d].clone();return i}})}(),r})}(i0)),i0.exports}var c0={exports:{}},on;function Td(){return on||(on=1,function(e,t){(function(r,n){e.exports=n(j())})(X,function(r){return function(){if(typeof ArrayBuffer=="function"){var n=r,s=n.lib,o=s.WordArray,x=o.init,f=o.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var i=l.byteLength,c=[],a=0;a<i;a++)c[a>>>2]|=l[a]<<24-a%4*8;x.call(this,c,i)}else x.apply(this,arguments)};f.prototype=o}}(),r.lib.WordArray})}(c0)),c0.exports}var l0={exports:{}},an;function Bd(){return an||(an=1,function(e,t){(function(r,n){e.exports=n(j())})(X,function(r){return function(){var n=r,s=n.lib,o=s.WordArray,x=n.enc;x.Utf16=x.Utf16BE={stringify:function(l){for(var i=l.words,c=l.sigBytes,a=[],d=0;d<c;d+=2){var m=i[d>>>2]>>>16-d%4*8&65535;a.push(String.fromCharCode(m))}return a.join("")},parse:function(l){for(var i=l.length,c=[],a=0;a<i;a++)c[a>>>1]|=l.charCodeAt(a)<<16-a%2*16;return o.create(c,i*2)}},x.Utf16LE={stringify:function(l){for(var i=l.words,c=l.sigBytes,a=[],d=0;d<c;d+=2){var m=f(i[d>>>2]>>>16-d%4*8&65535);a.push(String.fromCharCode(m))}return a.join("")},parse:function(l){for(var i=l.length,c=[],a=0;a<i;a++)c[a>>>1]|=f(l.charCodeAt(a)<<16-a%2*16);return o.create(c,i*2)}};function f(l){return l<<8&4278255360|l>>>8&16711935}}(),r.enc.Utf16})}(l0)),l0.exports}var d0={exports:{}},cn;function rt(){return cn||(cn=1,function(e,t){(function(r,n){e.exports=n(j())})(X,function(r){return function(){var n=r,s=n.lib,o=s.WordArray,x=n.enc;x.Base64={stringify:function(l){var i=l.words,c=l.sigBytes,a=this._map;l.clamp();for(var d=[],m=0;m<c;m+=3)for(var p=i[m>>>2]>>>24-m%4*8&255,_=i[m+1>>>2]>>>24-(m+1)%4*8&255,y=i[m+2>>>2]>>>24-(m+2)%4*8&255,E=p<<16|_<<8|y,g=0;g<4&&m+g*.75<c;g++)d.push(a.charAt(E>>>6*(3-g)&63));var v=a.charAt(64);if(v)for(;d.length%4;)d.push(v);return d.join("")},parse:function(l){var i=l.length,c=this._map,a=this._reverseMap;if(!a){a=this._reverseMap=[];for(var d=0;d<c.length;d++)a[c.charCodeAt(d)]=d}var m=c.charAt(64);if(m){var p=l.indexOf(m);p!==-1&&(i=p)}return f(l,i,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function f(l,i,c){for(var a=[],d=0,m=0;m<i;m++)if(m%4){var p=c[l.charCodeAt(m-1)]<<m%4*2,_=c[l.charCodeAt(m)]>>>6-m%4*2,y=p|_;a[d>>>2]|=y<<24-d%4*8,d++}return o.create(a,d)}}(),r.enc.Base64})}(d0)),d0.exports}var h0={exports:{}},ln;function Pd(){return ln||(ln=1,function(e,t){(function(r,n){e.exports=n(j())})(X,function(r){return function(){var n=r,s=n.lib,o=s.WordArray,x=n.enc;x.Base64url={stringify:function(l,i=!0){var c=l.words,a=l.sigBytes,d=i?this._safe_map:this._map;l.clamp();for(var m=[],p=0;p<a;p+=3)for(var _=c[p>>>2]>>>24-p%4*8&255,y=c[p+1>>>2]>>>24-(p+1)%4*8&255,E=c[p+2>>>2]>>>24-(p+2)%4*8&255,g=_<<16|y<<8|E,v=0;v<4&&p+v*.75<a;v++)m.push(d.charAt(g>>>6*(3-v)&63));var b=d.charAt(64);if(b)for(;m.length%4;)m.push(b);return m.join("")},parse:function(l,i=!0){var c=l.length,a=i?this._safe_map:this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var m=0;m<a.length;m++)d[a.charCodeAt(m)]=m}var p=a.charAt(64);if(p){var _=l.indexOf(p);_!==-1&&(c=_)}return f(l,c,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function f(l,i,c){for(var a=[],d=0,m=0;m<i;m++)if(m%4){var p=c[l.charCodeAt(m-1)]<<m%4*2,_=c[l.charCodeAt(m)]>>>6-m%4*2,y=p|_;a[d>>>2]|=y<<24-d%4*8,d++}return o.create(a,d)}}(),r.enc.Base64url})}(h0)),h0.exports}var f0={exports:{}},dn;function nt(){return dn||(dn=1,function(e,t){(function(r,n){e.exports=n(j())})(X,function(r){return function(n){var s=r,o=s.lib,x=o.WordArray,f=o.Hasher,l=s.algo,i=[];(function(){for(var _=0;_<64;_++)i[_]=n.abs(n.sin(_+1))*4294967296|0})();var c=l.MD5=f.extend({_doReset:function(){this._hash=new x.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(_,y){for(var E=0;E<16;E++){var g=y+E,v=_[g];_[g]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360}var b=this._hash.words,w=_[y+0],A=_[y+1],T=_[y+2],P=_[y+3],F=_[y+4],S=_[y+5],k=_[y+6],B=_[y+7],R=_[y+8],W=_[y+9],z=_[y+10],q=_[y+11],ee=_[y+12],Z=_[y+13],te=_[y+14],re=_[y+15],D=b[0],M=b[1],N=b[2],I=b[3];D=a(D,M,N,I,w,7,i[0]),I=a(I,D,M,N,A,12,i[1]),N=a(N,I,D,M,T,17,i[2]),M=a(M,N,I,D,P,22,i[3]),D=a(D,M,N,I,F,7,i[4]),I=a(I,D,M,N,S,12,i[5]),N=a(N,I,D,M,k,17,i[6]),M=a(M,N,I,D,B,22,i[7]),D=a(D,M,N,I,R,7,i[8]),I=a(I,D,M,N,W,12,i[9]),N=a(N,I,D,M,z,17,i[10]),M=a(M,N,I,D,q,22,i[11]),D=a(D,M,N,I,ee,7,i[12]),I=a(I,D,M,N,Z,12,i[13]),N=a(N,I,D,M,te,17,i[14]),M=a(M,N,I,D,re,22,i[15]),D=d(D,M,N,I,A,5,i[16]),I=d(I,D,M,N,k,9,i[17]),N=d(N,I,D,M,q,14,i[18]),M=d(M,N,I,D,w,20,i[19]),D=d(D,M,N,I,S,5,i[20]),I=d(I,D,M,N,z,9,i[21]),N=d(N,I,D,M,re,14,i[22]),M=d(M,N,I,D,F,20,i[23]),D=d(D,M,N,I,W,5,i[24]),I=d(I,D,M,N,te,9,i[25]),N=d(N,I,D,M,P,14,i[26]),M=d(M,N,I,D,R,20,i[27]),D=d(D,M,N,I,Z,5,i[28]),I=d(I,D,M,N,T,9,i[29]),N=d(N,I,D,M,B,14,i[30]),M=d(M,N,I,D,ee,20,i[31]),D=m(D,M,N,I,S,4,i[32]),I=m(I,D,M,N,R,11,i[33]),N=m(N,I,D,M,q,16,i[34]),M=m(M,N,I,D,te,23,i[35]),D=m(D,M,N,I,A,4,i[36]),I=m(I,D,M,N,F,11,i[37]),N=m(N,I,D,M,B,16,i[38]),M=m(M,N,I,D,z,23,i[39]),D=m(D,M,N,I,Z,4,i[40]),I=m(I,D,M,N,w,11,i[41]),N=m(N,I,D,M,P,16,i[42]),M=m(M,N,I,D,k,23,i[43]),D=m(D,M,N,I,W,4,i[44]),I=m(I,D,M,N,ee,11,i[45]),N=m(N,I,D,M,re,16,i[46]),M=m(M,N,I,D,T,23,i[47]),D=p(D,M,N,I,w,6,i[48]),I=p(I,D,M,N,B,10,i[49]),N=p(N,I,D,M,te,15,i[50]),M=p(M,N,I,D,S,21,i[51]),D=p(D,M,N,I,ee,6,i[52]),I=p(I,D,M,N,P,10,i[53]),N=p(N,I,D,M,z,15,i[54]),M=p(M,N,I,D,A,21,i[55]),D=p(D,M,N,I,R,6,i[56]),I=p(I,D,M,N,re,10,i[57]),N=p(N,I,D,M,k,15,i[58]),M=p(M,N,I,D,Z,21,i[59]),D=p(D,M,N,I,F,6,i[60]),I=p(I,D,M,N,q,10,i[61]),N=p(N,I,D,M,T,15,i[62]),M=p(M,N,I,D,W,21,i[63]),b[0]=b[0]+D|0,b[1]=b[1]+M|0,b[2]=b[2]+N|0,b[3]=b[3]+I|0},_doFinalize:function(){var _=this._data,y=_.words,E=this._nDataBytes*8,g=_.sigBytes*8;y[g>>>5]|=128<<24-g%32;var v=n.floor(E/4294967296),b=E;y[(g+64>>>9<<4)+15]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,y[(g+64>>>9<<4)+14]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,_.sigBytes=(y.length+1)*4,this._process();for(var w=this._hash,A=w.words,T=0;T<4;T++){var P=A[T];A[T]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360}return w},clone:function(){var _=f.clone.call(this);return _._hash=this._hash.clone(),_}});function a(_,y,E,g,v,b,w){var A=_+(y&E|~y&g)+v+w;return(A<<b|A>>>32-b)+y}function d(_,y,E,g,v,b,w){var A=_+(y&g|E&~g)+v+w;return(A<<b|A>>>32-b)+y}function m(_,y,E,g,v,b,w){var A=_+(y^E^g)+v+w;return(A<<b|A>>>32-b)+y}function p(_,y,E,g,v,b,w){var A=_+(E^(y|~g))+v+w;return(A<<b|A>>>32-b)+y}s.MD5=f._createHelper(c),s.HmacMD5=f._createHmacHelper(c)}(Math),r.MD5})}(f0)),f0.exports}var u0={exports:{}},hn;function hr(){return hn||(hn=1,function(e,t){(function(r,n){e.exports=n(j())})(X,function(r){return function(){var n=r,s=n.lib,o=s.WordArray,x=s.Hasher,f=n.algo,l=[],i=f.SHA1=x.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(c,a){for(var d=this._hash.words,m=d[0],p=d[1],_=d[2],y=d[3],E=d[4],g=0;g<80;g++){if(g<16)l[g]=c[a+g]|0;else{var v=l[g-3]^l[g-8]^l[g-14]^l[g-16];l[g]=v<<1|v>>>31}var b=(m<<5|m>>>27)+E+l[g];g<20?b+=(p&_|~p&y)+1518500249:g<40?b+=(p^_^y)+1859775393:g<60?b+=(p&_|p&y|_&y)-1894007588:b+=(p^_^y)-899497514,E=y,y=_,_=p<<30|p>>>2,p=m,m=b}d[0]=d[0]+m|0,d[1]=d[1]+p|0,d[2]=d[2]+_|0,d[3]=d[3]+y|0,d[4]=d[4]+E|0},_doFinalize:function(){var c=this._data,a=c.words,d=this._nDataBytes*8,m=c.sigBytes*8;return a[m>>>5]|=128<<24-m%32,a[(m+64>>>9<<4)+14]=Math.floor(d/4294967296),a[(m+64>>>9<<4)+15]=d,c.sigBytes=a.length*4,this._process(),this._hash},clone:function(){var c=x.clone.call(this);return c._hash=this._hash.clone(),c}});n.SHA1=x._createHelper(i),n.HmacSHA1=x._createHmacHelper(i)}(),r.SHA1})}(u0)),u0.exports}var x0={exports:{}},fn;function ys(){return fn||(fn=1,function(e,t){(function(r,n){e.exports=n(j())})(X,function(r){return function(n){var s=r,o=s.lib,x=o.WordArray,f=o.Hasher,l=s.algo,i=[],c=[];(function(){function m(E){for(var g=n.sqrt(E),v=2;v<=g;v++)if(!(E%v))return!1;return!0}function p(E){return(E-(E|0))*4294967296|0}for(var _=2,y=0;y<64;)m(_)&&(y<8&&(i[y]=p(n.pow(_,1/2))),c[y]=p(n.pow(_,1/3)),y++),_++})();var a=[],d=l.SHA256=f.extend({_doReset:function(){this._hash=new x.init(i.slice(0))},_doProcessBlock:function(m,p){for(var _=this._hash.words,y=_[0],E=_[1],g=_[2],v=_[3],b=_[4],w=_[5],A=_[6],T=_[7],P=0;P<64;P++){if(P<16)a[P]=m[p+P]|0;else{var F=a[P-15],S=(F<<25|F>>>7)^(F<<14|F>>>18)^F>>>3,k=a[P-2],B=(k<<15|k>>>17)^(k<<13|k>>>19)^k>>>10;a[P]=S+a[P-7]+B+a[P-16]}var R=b&w^~b&A,W=y&E^y&g^E&g,z=(y<<30|y>>>2)^(y<<19|y>>>13)^(y<<10|y>>>22),q=(b<<26|b>>>6)^(b<<21|b>>>11)^(b<<7|b>>>25),ee=T+q+R+c[P]+a[P],Z=z+W;T=A,A=w,w=b,b=v+ee|0,v=g,g=E,E=y,y=ee+Z|0}_[0]=_[0]+y|0,_[1]=_[1]+E|0,_[2]=_[2]+g|0,_[3]=_[3]+v|0,_[4]=_[4]+b|0,_[5]=_[5]+w|0,_[6]=_[6]+A|0,_[7]=_[7]+T|0},_doFinalize:function(){var m=this._data,p=m.words,_=this._nDataBytes*8,y=m.sigBytes*8;return p[y>>>5]|=128<<24-y%32,p[(y+64>>>9<<4)+14]=n.floor(_/4294967296),p[(y+64>>>9<<4)+15]=_,m.sigBytes=p.length*4,this._process(),this._hash},clone:function(){var m=f.clone.call(this);return m._hash=this._hash.clone(),m}});s.SHA256=f._createHelper(d),s.HmacSHA256=f._createHmacHelper(d)}(Math),r.SHA256})}(x0)),x0.exports}var p0={exports:{}},un;function Dd(){return un||(un=1,function(e,t){(function(r,n,s){e.exports=n(j(),ys())})(X,function(r){return function(){var n=r,s=n.lib,o=s.WordArray,x=n.algo,f=x.SHA256,l=x.SHA224=f.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var i=f._doFinalize.call(this);return i.sigBytes-=4,i}});n.SHA224=f._createHelper(l),n.HmacSHA224=f._createHmacHelper(l)}(),r.SHA224})}(p0)),p0.exports}var m0={exports:{}},xn;function Ss(){return xn||(xn=1,function(e,t){(function(r,n,s){e.exports=n(j(),Gt())})(X,function(r){return function(){var n=r,s=n.lib,o=s.Hasher,x=n.x64,f=x.Word,l=x.WordArray,i=n.algo;function c(){return f.create.apply(f,arguments)}var a=[c(1116352408,3609767458),c(1899447441,602891725),c(3049323471,3964484399),c(3921009573,2173295548),c(961987163,4081628472),c(1508970993,3053834265),c(2453635748,2937671579),c(2870763221,3664609560),c(3624381080,2734883394),c(310598401,1164996542),c(607225278,1323610764),c(1426881987,3590304994),c(1925078388,4068182383),c(2162078206,991336113),c(2614888103,633803317),c(3248222580,3479774868),c(3835390401,2666613458),c(4022224774,944711139),c(264347078,2341262773),c(604807628,2007800933),c(770255983,1495990901),c(1249150122,1856431235),c(1555081692,3175218132),c(1996064986,2198950837),c(2554220882,3999719339),c(2821834349,766784016),c(2952996808,2566594879),c(3210313671,3203337956),c(3336571891,1034457026),c(3584528711,2466948901),c(113926993,3758326383),c(338241895,168717936),c(666307205,1188179964),c(773529912,1546045734),c(1294757372,1522805485),c(1396182291,2643833823),c(1695183700,2343527390),c(1986661051,1014477480),c(2177026350,1206759142),c(2456956037,344077627),c(2730485921,1290863460),c(2820302411,3158454273),c(3259730800,3505952657),c(3345764771,106217008),c(3516065817,3606008344),c(3600352804,1432725776),c(4094571909,1467031594),c(275423344,851169720),c(430227734,3100823752),c(506948616,1363258195),c(659060556,3750685593),c(883997877,3785050280),c(958139571,3318307427),c(1322822218,3812723403),c(1537002063,2003034995),c(1747873779,3602036899),c(1955562222,1575990012),c(2024104815,1125592928),c(2227730452,2716904306),c(2361852424,442776044),c(2428436474,593698344),c(2756734187,3733110249),c(3204031479,2999351573),c(3329325298,3815920427),c(3391569614,3928383900),c(3515267271,566280711),c(3940187606,3454069534),c(4118630271,4000239992),c(116418474,1914138554),c(174292421,2731055270),c(289380356,3203993006),c(460393269,320620315),c(685471733,587496836),c(852142971,1086792851),c(1017036298,365543100),c(1126000580,2618297676),c(1288033470,3409855158),c(1501505948,4234509866),c(1607167915,987167468),c(1816402316,1246189591)],d=[];(function(){for(var p=0;p<80;p++)d[p]=c()})();var m=i.SHA512=o.extend({_doReset:function(){this._hash=new l.init([new f.init(1779033703,4089235720),new f.init(3144134277,2227873595),new f.init(1013904242,4271175723),new f.init(2773480762,1595750129),new f.init(1359893119,2917565137),new f.init(2600822924,725511199),new f.init(528734635,4215389547),new f.init(1541459225,327033209)])},_doProcessBlock:function(p,_){for(var y=this._hash.words,E=y[0],g=y[1],v=y[2],b=y[3],w=y[4],A=y[5],T=y[6],P=y[7],F=E.high,S=E.low,k=g.high,B=g.low,R=v.high,W=v.low,z=b.high,q=b.low,ee=w.high,Z=w.low,te=A.high,re=A.low,D=T.high,M=T.low,N=P.high,I=P.low,oe=F,ne=S,ve=k,K=B,st=R,Xe=W,Yt=z,ot=q,Te=ee,ye=Z,wt=te,at=re,At=D,it=M,Vt=N,ct=I,Be=0;Be<80;Be++){var ke,Ue,kt=d[Be];if(Be<16)Ue=kt.high=p[_+Be*2]|0,ke=kt.low=p[_+Be*2+1]|0;else{var ur=d[Be-15],$e=ur.high,lt=ur.low,Ps=($e>>>1|lt<<31)^($e>>>8|lt<<24)^$e>>>7,xr=(lt>>>1|$e<<31)^(lt>>>8|$e<<24)^(lt>>>7|$e<<25),pr=d[Be-2],Ze=pr.high,dt=pr.low,Ds=(Ze>>>19|dt<<13)^(Ze<<3|dt>>>29)^Ze>>>6,mr=(dt>>>19|Ze<<13)^(dt<<3|Ze>>>29)^(dt>>>6|Ze<<26),vr=d[Be-7],Rs=vr.high,Is=vr.low,gr=d[Be-16],Ms=gr.high,_r=gr.low;ke=xr+Is,Ue=Ps+Rs+(ke>>>0<xr>>>0?1:0),ke=ke+mr,Ue=Ue+Ds+(ke>>>0<mr>>>0?1:0),ke=ke+_r,Ue=Ue+Ms+(ke>>>0<_r>>>0?1:0),kt.high=Ue,kt.low=ke}var Ns=Te&wt^~Te&At,br=ye&at^~ye&it,Hs=oe&ve^oe&st^ve&st,Fs=ne&K^ne&Xe^K&Xe,Ls=(oe>>>28|ne<<4)^(oe<<30|ne>>>2)^(oe<<25|ne>>>7),yr=(ne>>>28|oe<<4)^(ne<<30|oe>>>2)^(ne<<25|oe>>>7),Os=(Te>>>14|ye<<18)^(Te>>>18|ye<<14)^(Te<<23|ye>>>9),Us=(ye>>>14|Te<<18)^(ye>>>18|Te<<14)^(ye<<23|Te>>>9),Sr=a[Be],Ws=Sr.high,Er=Sr.low,Se=ct+Us,We=Vt+Os+(Se>>>0<ct>>>0?1:0),Se=Se+br,We=We+Ns+(Se>>>0<br>>>0?1:0),Se=Se+Er,We=We+Ws+(Se>>>0<Er>>>0?1:0),Se=Se+ke,We=We+Ue+(Se>>>0<ke>>>0?1:0),wr=yr+Fs,Gs=Ls+Hs+(wr>>>0<yr>>>0?1:0);Vt=At,ct=it,At=wt,it=at,wt=Te,at=ye,ye=ot+Se|0,Te=Yt+We+(ye>>>0<ot>>>0?1:0)|0,Yt=st,ot=Xe,st=ve,Xe=K,ve=oe,K=ne,ne=Se+wr|0,oe=We+Gs+(ne>>>0<Se>>>0?1:0)|0}S=E.low=S+ne,E.high=F+oe+(S>>>0<ne>>>0?1:0),B=g.low=B+K,g.high=k+ve+(B>>>0<K>>>0?1:0),W=v.low=W+Xe,v.high=R+st+(W>>>0<Xe>>>0?1:0),q=b.low=q+ot,b.high=z+Yt+(q>>>0<ot>>>0?1:0),Z=w.low=Z+ye,w.high=ee+Te+(Z>>>0<ye>>>0?1:0),re=A.low=re+at,A.high=te+wt+(re>>>0<at>>>0?1:0),M=T.low=M+it,T.high=D+At+(M>>>0<it>>>0?1:0),I=P.low=I+ct,P.high=N+Vt+(I>>>0<ct>>>0?1:0)},_doFinalize:function(){var p=this._data,_=p.words,y=this._nDataBytes*8,E=p.sigBytes*8;_[E>>>5]|=128<<24-E%32,_[(E+128>>>10<<5)+30]=Math.floor(y/4294967296),_[(E+128>>>10<<5)+31]=y,p.sigBytes=_.length*4,this._process();var g=this._hash.toX32();return g},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p},blockSize:1024/32});n.SHA512=o._createHelper(m),n.HmacSHA512=o._createHmacHelper(m)}(),r.SHA512})}(m0)),m0.exports}var v0={exports:{}},pn;function Rd(){return pn||(pn=1,function(e,t){(function(r,n,s){e.exports=n(j(),Gt(),Ss())})(X,function(r){return function(){var n=r,s=n.x64,o=s.Word,x=s.WordArray,f=n.algo,l=f.SHA512,i=f.SHA384=l.extend({_doReset:function(){this._hash=new x.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var c=l._doFinalize.call(this);return c.sigBytes-=16,c}});n.SHA384=l._createHelper(i),n.HmacSHA384=l._createHmacHelper(i)}(),r.SHA384})}(v0)),v0.exports}var g0={exports:{}},mn;function Id(){return mn||(mn=1,function(e,t){(function(r,n,s){e.exports=n(j(),Gt())})(X,function(r){return function(n){var s=r,o=s.lib,x=o.WordArray,f=o.Hasher,l=s.x64,i=l.Word,c=s.algo,a=[],d=[],m=[];(function(){for(var y=1,E=0,g=0;g<24;g++){a[y+5*E]=(g+1)*(g+2)/2%64;var v=E%5,b=(2*y+3*E)%5;y=v,E=b}for(var y=0;y<5;y++)for(var E=0;E<5;E++)d[y+5*E]=E+(2*y+3*E)%5*5;for(var w=1,A=0;A<24;A++){for(var T=0,P=0,F=0;F<7;F++){if(w&1){var S=(1<<F)-1;S<32?P^=1<<S:T^=1<<S-32}w&128?w=w<<1^113:w<<=1}m[A]=i.create(T,P)}})();var p=[];(function(){for(var y=0;y<25;y++)p[y]=i.create()})();var _=c.SHA3=f.extend({cfg:f.cfg.extend({outputLength:512}),_doReset:function(){for(var y=this._state=[],E=0;E<25;E++)y[E]=new i.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(y,E){for(var g=this._state,v=this.blockSize/2,b=0;b<v;b++){var w=y[E+2*b],A=y[E+2*b+1];w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360;var T=g[b];T.high^=A,T.low^=w}for(var P=0;P<24;P++){for(var F=0;F<5;F++){for(var S=0,k=0,B=0;B<5;B++){var T=g[F+5*B];S^=T.high,k^=T.low}var R=p[F];R.high=S,R.low=k}for(var F=0;F<5;F++)for(var W=p[(F+4)%5],z=p[(F+1)%5],q=z.high,ee=z.low,S=W.high^(q<<1|ee>>>31),k=W.low^(ee<<1|q>>>31),B=0;B<5;B++){var T=g[F+5*B];T.high^=S,T.low^=k}for(var Z=1;Z<25;Z++){var S,k,T=g[Z],te=T.high,re=T.low,D=a[Z];D<32?(S=te<<D|re>>>32-D,k=re<<D|te>>>32-D):(S=re<<D-32|te>>>64-D,k=te<<D-32|re>>>64-D);var M=p[d[Z]];M.high=S,M.low=k}var N=p[0],I=g[0];N.high=I.high,N.low=I.low;for(var F=0;F<5;F++)for(var B=0;B<5;B++){var Z=F+5*B,T=g[Z],oe=p[Z],ne=p[(F+1)%5+5*B],ve=p[(F+2)%5+5*B];T.high=oe.high^~ne.high&ve.high,T.low=oe.low^~ne.low&ve.low}var T=g[0],K=m[P];T.high^=K.high,T.low^=K.low}},_doFinalize:function(){var y=this._data,E=y.words;this._nDataBytes*8;var g=y.sigBytes*8,v=this.blockSize*32;E[g>>>5]|=1<<24-g%32,E[(n.ceil((g+1)/v)*v>>>5)-1]|=128,y.sigBytes=E.length*4,this._process();for(var b=this._state,w=this.cfg.outputLength/8,A=w/8,T=[],P=0;P<A;P++){var F=b[P],S=F.high,k=F.low;S=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,k=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,T.push(k),T.push(S)}return new x.init(T,w)},clone:function(){for(var y=f.clone.call(this),E=y._state=this._state.slice(0),g=0;g<25;g++)E[g]=E[g].clone();return y}});s.SHA3=f._createHelper(_),s.HmacSHA3=f._createHmacHelper(_)}(Math),r.SHA3})}(g0)),g0.exports}var _0={exports:{}},vn;function Md(){return vn||(vn=1,function(e,t){(function(r,n){e.exports=n(j())})(X,function(r){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(n){var s=r,o=s.lib,x=o.WordArray,f=o.Hasher,l=s.algo,i=x.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=x.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),a=x.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),d=x.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),m=x.create([0,1518500249,1859775393,2400959708,2840853838]),p=x.create([1352829926,1548603684,1836072691,2053994217,0]),_=l.RIPEMD160=f.extend({_doReset:function(){this._hash=x.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(A,T){for(var P=0;P<16;P++){var F=T+P,S=A[F];A[F]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360}var k=this._hash.words,B=m.words,R=p.words,W=i.words,z=c.words,q=a.words,ee=d.words,Z,te,re,D,M,N,I,oe,ne,ve;N=Z=k[0],I=te=k[1],oe=re=k[2],ne=D=k[3],ve=M=k[4];for(var K,P=0;P<80;P+=1)K=Z+A[T+W[P]]|0,P<16?K+=y(te,re,D)+B[0]:P<32?K+=E(te,re,D)+B[1]:P<48?K+=g(te,re,D)+B[2]:P<64?K+=v(te,re,D)+B[3]:K+=b(te,re,D)+B[4],K=K|0,K=w(K,q[P]),K=K+M|0,Z=M,M=D,D=w(re,10),re=te,te=K,K=N+A[T+z[P]]|0,P<16?K+=b(I,oe,ne)+R[0]:P<32?K+=v(I,oe,ne)+R[1]:P<48?K+=g(I,oe,ne)+R[2]:P<64?K+=E(I,oe,ne)+R[3]:K+=y(I,oe,ne)+R[4],K=K|0,K=w(K,ee[P]),K=K+ve|0,N=ve,ve=ne,ne=w(oe,10),oe=I,I=K;K=k[1]+re+ne|0,k[1]=k[2]+D+ve|0,k[2]=k[3]+M+N|0,k[3]=k[4]+Z+I|0,k[4]=k[0]+te+oe|0,k[0]=K},_doFinalize:function(){var A=this._data,T=A.words,P=this._nDataBytes*8,F=A.sigBytes*8;T[F>>>5]|=128<<24-F%32,T[(F+64>>>9<<4)+14]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360,A.sigBytes=(T.length+1)*4,this._process();for(var S=this._hash,k=S.words,B=0;B<5;B++){var R=k[B];k[B]=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360}return S},clone:function(){var A=f.clone.call(this);return A._hash=this._hash.clone(),A}});function y(A,T,P){return A^T^P}function E(A,T,P){return A&T|~A&P}function g(A,T,P){return(A|~T)^P}function v(A,T,P){return A&P|T&~P}function b(A,T,P){return A^(T|~P)}function w(A,T){return A<<T|A>>>32-T}s.RIPEMD160=f._createHelper(_),s.HmacRIPEMD160=f._createHmacHelper(_)}(),r.RIPEMD160})}(_0)),_0.exports}var b0={exports:{}},gn;function fr(){return gn||(gn=1,function(e,t){(function(r,n){e.exports=n(j())})(X,function(r){(function(){var n=r,s=n.lib,o=s.Base,x=n.enc,f=x.Utf8,l=n.algo;l.HMAC=o.extend({init:function(i,c){i=this._hasher=new i.init,typeof c=="string"&&(c=f.parse(c));var a=i.blockSize,d=a*4;c.sigBytes>d&&(c=i.finalize(c)),c.clamp();for(var m=this._oKey=c.clone(),p=this._iKey=c.clone(),_=m.words,y=p.words,E=0;E<a;E++)_[E]^=1549556828,y[E]^=909522486;m.sigBytes=p.sigBytes=d,this.reset()},reset:function(){var i=this._hasher;i.reset(),i.update(this._iKey)},update:function(i){return this._hasher.update(i),this},finalize:function(i){var c=this._hasher,a=c.finalize(i);c.reset();var d=c.finalize(this._oKey.clone().concat(a));return d}})})()})}(b0)),b0.exports}var y0={exports:{}},_n;function Nd(){return _n||(_n=1,function(e,t){(function(r,n,s){e.exports=n(j(),hr(),fr())})(X,function(r){return function(){var n=r,s=n.lib,o=s.Base,x=s.WordArray,f=n.algo,l=f.SHA1,i=f.HMAC,c=f.PBKDF2=o.extend({cfg:o.extend({keySize:128/32,hasher:l,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,d){for(var m=this.cfg,p=i.create(m.hasher,a),_=x.create(),y=x.create([1]),E=_.words,g=y.words,v=m.keySize,b=m.iterations;E.length<v;){var w=p.update(d).finalize(y);p.reset();for(var A=w.words,T=A.length,P=w,F=1;F<b;F++){P=p.finalize(P),p.reset();for(var S=P.words,k=0;k<T;k++)A[k]^=S[k]}_.concat(w),g[0]++}return _.sigBytes=v*4,_}});n.PBKDF2=function(a,d,m){return c.create(m).compute(a,d)}}(),r.PBKDF2})}(y0)),y0.exports}var S0={exports:{}},bn;function Ke(){return bn||(bn=1,function(e,t){(function(r,n,s){e.exports=n(j(),hr(),fr())})(X,function(r){return function(){var n=r,s=n.lib,o=s.Base,x=s.WordArray,f=n.algo,l=f.MD5,i=f.EvpKDF=o.extend({cfg:o.extend({keySize:128/32,hasher:l,iterations:1}),init:function(c){this.cfg=this.cfg.extend(c)},compute:function(c,a){for(var d,m=this.cfg,p=m.hasher.create(),_=x.create(),y=_.words,E=m.keySize,g=m.iterations;y.length<E;){d&&p.update(d),d=p.update(c).finalize(a),p.reset();for(var v=1;v<g;v++)d=p.finalize(d),p.reset();_.concat(d)}return _.sigBytes=E*4,_}});n.EvpKDF=function(c,a,d){return i.create(d).compute(c,a)}}(),r.EvpKDF})}(S0)),S0.exports}var E0={exports:{}},yn;function xe(){return yn||(yn=1,function(e,t){(function(r,n,s){e.exports=n(j(),Ke())})(X,function(r){r.lib.Cipher||function(n){var s=r,o=s.lib,x=o.Base,f=o.WordArray,l=o.BufferedBlockAlgorithm,i=s.enc;i.Utf8;var c=i.Base64,a=s.algo,d=a.EvpKDF,m=o.Cipher=l.extend({cfg:x.extend(),createEncryptor:function(S,k){return this.create(this._ENC_XFORM_MODE,S,k)},createDecryptor:function(S,k){return this.create(this._DEC_XFORM_MODE,S,k)},init:function(S,k,B){this.cfg=this.cfg.extend(B),this._xformMode=S,this._key=k,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(S){return this._append(S),this._process()},finalize:function(S){S&&this._append(S);var k=this._doFinalize();return k},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function S(k){return typeof k=="string"?F:A}return function(k){return{encrypt:function(B,R,W){return S(R).encrypt(k,B,R,W)},decrypt:function(B,R,W){return S(R).decrypt(k,B,R,W)}}}}()});o.StreamCipher=m.extend({_doFinalize:function(){var S=this._process(!0);return S},blockSize:1});var p=s.mode={},_=o.BlockCipherMode=x.extend({createEncryptor:function(S,k){return this.Encryptor.create(S,k)},createDecryptor:function(S,k){return this.Decryptor.create(S,k)},init:function(S,k){this._cipher=S,this._iv=k}}),y=p.CBC=function(){var S=_.extend();S.Encryptor=S.extend({processBlock:function(B,R){var W=this._cipher,z=W.blockSize;k.call(this,B,R,z),W.encryptBlock(B,R),this._prevBlock=B.slice(R,R+z)}}),S.Decryptor=S.extend({processBlock:function(B,R){var W=this._cipher,z=W.blockSize,q=B.slice(R,R+z);W.decryptBlock(B,R),k.call(this,B,R,z),this._prevBlock=q}});function k(B,R,W){var z,q=this._iv;q?(z=q,this._iv=n):z=this._prevBlock;for(var ee=0;ee<W;ee++)B[R+ee]^=z[ee]}return S}(),E=s.pad={},g=E.Pkcs7={pad:function(S,k){for(var B=k*4,R=B-S.sigBytes%B,W=R<<24|R<<16|R<<8|R,z=[],q=0;q<R;q+=4)z.push(W);var ee=f.create(z,R);S.concat(ee)},unpad:function(S){var k=S.words[S.sigBytes-1>>>2]&255;S.sigBytes-=k}};o.BlockCipher=m.extend({cfg:m.cfg.extend({mode:y,padding:g}),reset:function(){var S;m.reset.call(this);var k=this.cfg,B=k.iv,R=k.mode;this._xformMode==this._ENC_XFORM_MODE?S=R.createEncryptor:(S=R.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==S?this._mode.init(this,B&&B.words):(this._mode=S.call(R,this,B&&B.words),this._mode.__creator=S)},_doProcessBlock:function(S,k){this._mode.processBlock(S,k)},_doFinalize:function(){var S,k=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(k.pad(this._data,this.blockSize),S=this._process(!0)):(S=this._process(!0),k.unpad(S)),S},blockSize:128/32});var v=o.CipherParams=x.extend({init:function(S){this.mixIn(S)},toString:function(S){return(S||this.formatter).stringify(this)}}),b=s.format={},w=b.OpenSSL={stringify:function(S){var k,B=S.ciphertext,R=S.salt;return R?k=f.create([1398893684,1701076831]).concat(R).concat(B):k=B,k.toString(c)},parse:function(S){var k,B=c.parse(S),R=B.words;return R[0]==1398893684&&R[1]==1701076831&&(k=f.create(R.slice(2,4)),R.splice(0,4),B.sigBytes-=16),v.create({ciphertext:B,salt:k})}},A=o.SerializableCipher=x.extend({cfg:x.extend({format:w}),encrypt:function(S,k,B,R){R=this.cfg.extend(R);var W=S.createEncryptor(B,R),z=W.finalize(k),q=W.cfg;return v.create({ciphertext:z,key:B,iv:q.iv,algorithm:S,mode:q.mode,padding:q.padding,blockSize:S.blockSize,formatter:R.format})},decrypt:function(S,k,B,R){R=this.cfg.extend(R),k=this._parse(k,R.format);var W=S.createDecryptor(B,R).finalize(k.ciphertext);return W},_parse:function(S,k){return typeof S=="string"?k.parse(S,this):S}}),T=s.kdf={},P=T.OpenSSL={execute:function(S,k,B,R){R||(R=f.random(64/8));var W=d.create({keySize:k+B}).compute(S,R),z=f.create(W.words.slice(k),B*4);return W.sigBytes=k*4,v.create({key:W,iv:z,salt:R})}},F=o.PasswordBasedCipher=A.extend({cfg:A.cfg.extend({kdf:P}),encrypt:function(S,k,B,R){R=this.cfg.extend(R);var W=R.kdf.execute(B,S.keySize,S.ivSize);R.iv=W.iv;var z=A.encrypt.call(this,S,k,W.key,R);return z.mixIn(W),z},decrypt:function(S,k,B,R){R=this.cfg.extend(R),k=this._parse(k,R.format);var W=R.kdf.execute(B,S.keySize,S.ivSize,k.salt);R.iv=W.iv;var z=A.decrypt.call(this,S,k,W.key,R);return z}})}()})}(E0)),E0.exports}var w0={exports:{}},Sn;function Hd(){return Sn||(Sn=1,function(e,t){(function(r,n,s){e.exports=n(j(),xe())})(X,function(r){return r.mode.CFB=function(){var n=r.lib.BlockCipherMode.extend();n.Encryptor=n.extend({processBlock:function(o,x){var f=this._cipher,l=f.blockSize;s.call(this,o,x,l,f),this._prevBlock=o.slice(x,x+l)}}),n.Decryptor=n.extend({processBlock:function(o,x){var f=this._cipher,l=f.blockSize,i=o.slice(x,x+l);s.call(this,o,x,l,f),this._prevBlock=i}});function s(o,x,f,l){var i,c=this._iv;c?(i=c.slice(0),this._iv=void 0):i=this._prevBlock,l.encryptBlock(i,0);for(var a=0;a<f;a++)o[x+a]^=i[a]}return n}(),r.mode.CFB})}(w0)),w0.exports}var A0={exports:{}},En;function Fd(){return En||(En=1,function(e,t){(function(r,n,s){e.exports=n(j(),xe())})(X,function(r){return r.mode.CTR=function(){var n=r.lib.BlockCipherMode.extend(),s=n.Encryptor=n.extend({processBlock:function(o,x){var f=this._cipher,l=f.blockSize,i=this._iv,c=this._counter;i&&(c=this._counter=i.slice(0),this._iv=void 0);var a=c.slice(0);f.encryptBlock(a,0),c[l-1]=c[l-1]+1|0;for(var d=0;d<l;d++)o[x+d]^=a[d]}});return n.Decryptor=s,n}(),r.mode.CTR})}(A0)),A0.exports}var k0={exports:{}},wn;function Ld(){return wn||(wn=1,function(e,t){(function(r,n,s){e.exports=n(j(),xe())})(X,function(r){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return r.mode.CTRGladman=function(){var n=r.lib.BlockCipherMode.extend();function s(f){if((f>>24&255)===255){var l=f>>16&255,i=f>>8&255,c=f&255;l===255?(l=0,i===255?(i=0,c===255?c=0:++c):++i):++l,f=0,f+=l<<16,f+=i<<8,f+=c}else f+=1<<24;return f}function o(f){return(f[0]=s(f[0]))===0&&(f[1]=s(f[1])),f}var x=n.Encryptor=n.extend({processBlock:function(f,l){var i=this._cipher,c=i.blockSize,a=this._iv,d=this._counter;a&&(d=this._counter=a.slice(0),this._iv=void 0),o(d);var m=d.slice(0);i.encryptBlock(m,0);for(var p=0;p<c;p++)f[l+p]^=m[p]}});return n.Decryptor=x,n}(),r.mode.CTRGladman})}(k0)),k0.exports}var C0={exports:{}},An;function Od(){return An||(An=1,function(e,t){(function(r,n,s){e.exports=n(j(),xe())})(X,function(r){return r.mode.OFB=function(){var n=r.lib.BlockCipherMode.extend(),s=n.Encryptor=n.extend({processBlock:function(o,x){var f=this._cipher,l=f.blockSize,i=this._iv,c=this._keystream;i&&(c=this._keystream=i.slice(0),this._iv=void 0),f.encryptBlock(c,0);for(var a=0;a<l;a++)o[x+a]^=c[a]}});return n.Decryptor=s,n}(),r.mode.OFB})}(C0)),C0.exports}var T0={exports:{}},kn;function Ud(){return kn||(kn=1,function(e,t){(function(r,n,s){e.exports=n(j(),xe())})(X,function(r){return r.mode.ECB=function(){var n=r.lib.BlockCipherMode.extend();return n.Encryptor=n.extend({processBlock:function(s,o){this._cipher.encryptBlock(s,o)}}),n.Decryptor=n.extend({processBlock:function(s,o){this._cipher.decryptBlock(s,o)}}),n}(),r.mode.ECB})}(T0)),T0.exports}var B0={exports:{}},Cn;function Wd(){return Cn||(Cn=1,function(e,t){(function(r,n,s){e.exports=n(j(),xe())})(X,function(r){return r.pad.AnsiX923={pad:function(n,s){var o=n.sigBytes,x=s*4,f=x-o%x,l=o+f-1;n.clamp(),n.words[l>>>2]|=f<<24-l%4*8,n.sigBytes+=f},unpad:function(n){var s=n.words[n.sigBytes-1>>>2]&255;n.sigBytes-=s}},r.pad.Ansix923})}(B0)),B0.exports}var P0={exports:{}},Tn;function Gd(){return Tn||(Tn=1,function(e,t){(function(r,n,s){e.exports=n(j(),xe())})(X,function(r){return r.pad.Iso10126={pad:function(n,s){var o=s*4,x=o-n.sigBytes%o;n.concat(r.lib.WordArray.random(x-1)).concat(r.lib.WordArray.create([x<<24],1))},unpad:function(n){var s=n.words[n.sigBytes-1>>>2]&255;n.sigBytes-=s}},r.pad.Iso10126})}(P0)),P0.exports}var D0={exports:{}},Bn;function zd(){return Bn||(Bn=1,function(e,t){(function(r,n,s){e.exports=n(j(),xe())})(X,function(r){return r.pad.Iso97971={pad:function(n,s){n.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(n,s)},unpad:function(n){r.pad.ZeroPadding.unpad(n),n.sigBytes--}},r.pad.Iso97971})}(D0)),D0.exports}var R0={exports:{}},Pn;function qd(){return Pn||(Pn=1,function(e,t){(function(r,n,s){e.exports=n(j(),xe())})(X,function(r){return r.pad.ZeroPadding={pad:function(n,s){var o=s*4;n.clamp(),n.sigBytes+=o-(n.sigBytes%o||o)},unpad:function(n){for(var s=n.words,o=n.sigBytes-1,o=n.sigBytes-1;o>=0;o--)if(s[o>>>2]>>>24-o%4*8&255){n.sigBytes=o+1;break}}},r.pad.ZeroPadding})}(R0)),R0.exports}var I0={exports:{}},Dn;function Yd(){return Dn||(Dn=1,function(e,t){(function(r,n,s){e.exports=n(j(),xe())})(X,function(r){return r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding})}(I0)),I0.exports}var M0={exports:{}},Rn;function Vd(){return Rn||(Rn=1,function(e,t){(function(r,n,s){e.exports=n(j(),xe())})(X,function(r){return function(n){var s=r,o=s.lib,x=o.CipherParams,f=s.enc,l=f.Hex,i=s.format;i.Hex={stringify:function(c){return c.ciphertext.toString(l)},parse:function(c){var a=l.parse(c);return x.create({ciphertext:a})}}}(),r.format.Hex})}(M0)),M0.exports}var N0={exports:{}},In;function Kd(){return In||(In=1,function(e,t){(function(r,n,s){e.exports=n(j(),rt(),nt(),Ke(),xe())})(X,function(r){return function(){var n=r,s=n.lib,o=s.BlockCipher,x=n.algo,f=[],l=[],i=[],c=[],a=[],d=[],m=[],p=[],_=[],y=[];(function(){for(var v=[],b=0;b<256;b++)b<128?v[b]=b<<1:v[b]=b<<1^283;for(var w=0,A=0,b=0;b<256;b++){var T=A^A<<1^A<<2^A<<3^A<<4;T=T>>>8^T&255^99,f[w]=T,l[T]=w;var P=v[w],F=v[P],S=v[F],k=v[T]*257^T*16843008;i[w]=k<<24|k>>>8,c[w]=k<<16|k>>>16,a[w]=k<<8|k>>>24,d[w]=k;var k=S*16843009^F*65537^P*257^w*16843008;m[T]=k<<24|k>>>8,p[T]=k<<16|k>>>16,_[T]=k<<8|k>>>24,y[T]=k,w?(w=P^v[v[v[S^P]]],A^=v[v[A]]):w=A=1}})();var E=[0,1,2,4,8,16,32,64,128,27,54],g=x.AES=o.extend({_doReset:function(){var v;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var b=this._keyPriorReset=this._key,w=b.words,A=b.sigBytes/4,T=this._nRounds=A+6,P=(T+1)*4,F=this._keySchedule=[],S=0;S<P;S++)S<A?F[S]=w[S]:(v=F[S-1],S%A?A>6&&S%A==4&&(v=f[v>>>24]<<24|f[v>>>16&255]<<16|f[v>>>8&255]<<8|f[v&255]):(v=v<<8|v>>>24,v=f[v>>>24]<<24|f[v>>>16&255]<<16|f[v>>>8&255]<<8|f[v&255],v^=E[S/A|0]<<24),F[S]=F[S-A]^v);for(var k=this._invKeySchedule=[],B=0;B<P;B++){var S=P-B;if(B%4)var v=F[S];else var v=F[S-4];B<4||S<=4?k[B]=v:k[B]=m[f[v>>>24]]^p[f[v>>>16&255]]^_[f[v>>>8&255]]^y[f[v&255]]}}},encryptBlock:function(v,b){this._doCryptBlock(v,b,this._keySchedule,i,c,a,d,f)},decryptBlock:function(v,b){var w=v[b+1];v[b+1]=v[b+3],v[b+3]=w,this._doCryptBlock(v,b,this._invKeySchedule,m,p,_,y,l);var w=v[b+1];v[b+1]=v[b+3],v[b+3]=w},_doCryptBlock:function(v,b,w,A,T,P,F,S){for(var k=this._nRounds,B=v[b]^w[0],R=v[b+1]^w[1],W=v[b+2]^w[2],z=v[b+3]^w[3],q=4,ee=1;ee<k;ee++){var Z=A[B>>>24]^T[R>>>16&255]^P[W>>>8&255]^F[z&255]^w[q++],te=A[R>>>24]^T[W>>>16&255]^P[z>>>8&255]^F[B&255]^w[q++],re=A[W>>>24]^T[z>>>16&255]^P[B>>>8&255]^F[R&255]^w[q++],D=A[z>>>24]^T[B>>>16&255]^P[R>>>8&255]^F[W&255]^w[q++];B=Z,R=te,W=re,z=D}var Z=(S[B>>>24]<<24|S[R>>>16&255]<<16|S[W>>>8&255]<<8|S[z&255])^w[q++],te=(S[R>>>24]<<24|S[W>>>16&255]<<16|S[z>>>8&255]<<8|S[B&255])^w[q++],re=(S[W>>>24]<<24|S[z>>>16&255]<<16|S[B>>>8&255]<<8|S[R&255])^w[q++],D=(S[z>>>24]<<24|S[B>>>16&255]<<16|S[R>>>8&255]<<8|S[W&255])^w[q++];v[b]=Z,v[b+1]=te,v[b+2]=re,v[b+3]=D},keySize:256/32});n.AES=o._createHelper(g)}(),r.AES})}(N0)),N0.exports}var H0={exports:{}},Mn;function Xd(){return Mn||(Mn=1,function(e,t){(function(r,n,s){e.exports=n(j(),rt(),nt(),Ke(),xe())})(X,function(r){return function(){var n=r,s=n.lib,o=s.WordArray,x=s.BlockCipher,f=n.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],i=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],a=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],m=f.DES=x.extend({_doReset:function(){for(var E=this._key,g=E.words,v=[],b=0;b<56;b++){var w=l[b]-1;v[b]=g[w>>>5]>>>31-w%32&1}for(var A=this._subKeys=[],T=0;T<16;T++){for(var P=A[T]=[],F=c[T],b=0;b<24;b++)P[b/6|0]|=v[(i[b]-1+F)%28]<<31-b%6,P[4+(b/6|0)]|=v[28+(i[b+24]-1+F)%28]<<31-b%6;P[0]=P[0]<<1|P[0]>>>31;for(var b=1;b<7;b++)P[b]=P[b]>>>(b-1)*4+3;P[7]=P[7]<<5|P[7]>>>27}for(var S=this._invSubKeys=[],b=0;b<16;b++)S[b]=A[15-b]},encryptBlock:function(E,g){this._doCryptBlock(E,g,this._subKeys)},decryptBlock:function(E,g){this._doCryptBlock(E,g,this._invSubKeys)},_doCryptBlock:function(E,g,v){this._lBlock=E[g],this._rBlock=E[g+1],p.call(this,4,252645135),p.call(this,16,65535),_.call(this,2,858993459),_.call(this,8,16711935),p.call(this,1,1431655765);for(var b=0;b<16;b++){for(var w=v[b],A=this._lBlock,T=this._rBlock,P=0,F=0;F<8;F++)P|=a[F][((T^w[F])&d[F])>>>0];this._lBlock=T,this._rBlock=A^P}var S=this._lBlock;this._lBlock=this._rBlock,this._rBlock=S,p.call(this,1,1431655765),_.call(this,8,16711935),_.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),E[g]=this._lBlock,E[g+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function p(E,g){var v=(this._lBlock>>>E^this._rBlock)&g;this._rBlock^=v,this._lBlock^=v<<E}function _(E,g){var v=(this._rBlock>>>E^this._lBlock)&g;this._lBlock^=v,this._rBlock^=v<<E}n.DES=x._createHelper(m);var y=f.TripleDES=x.extend({_doReset:function(){var E=this._key,g=E.words;if(g.length!==2&&g.length!==4&&g.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var v=g.slice(0,2),b=g.length<4?g.slice(0,2):g.slice(2,4),w=g.length<6?g.slice(0,2):g.slice(4,6);this._des1=m.createEncryptor(o.create(v)),this._des2=m.createEncryptor(o.create(b)),this._des3=m.createEncryptor(o.create(w))},encryptBlock:function(E,g){this._des1.encryptBlock(E,g),this._des2.decryptBlock(E,g),this._des3.encryptBlock(E,g)},decryptBlock:function(E,g){this._des3.decryptBlock(E,g),this._des2.encryptBlock(E,g),this._des1.decryptBlock(E,g)},keySize:192/32,ivSize:64/32,blockSize:64/32});n.TripleDES=x._createHelper(y)}(),r.TripleDES})}(H0)),H0.exports}var F0={exports:{}},Nn;function $d(){return Nn||(Nn=1,function(e,t){(function(r,n,s){e.exports=n(j(),rt(),nt(),Ke(),xe())})(X,function(r){return function(){var n=r,s=n.lib,o=s.StreamCipher,x=n.algo,f=x.RC4=o.extend({_doReset:function(){for(var c=this._key,a=c.words,d=c.sigBytes,m=this._S=[],p=0;p<256;p++)m[p]=p;for(var p=0,_=0;p<256;p++){var y=p%d,E=a[y>>>2]>>>24-y%4*8&255;_=(_+m[p]+E)%256;var g=m[p];m[p]=m[_],m[_]=g}this._i=this._j=0},_doProcessBlock:function(c,a){c[a]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var c=this._S,a=this._i,d=this._j,m=0,p=0;p<4;p++){a=(a+1)%256,d=(d+c[a])%256;var _=c[a];c[a]=c[d],c[d]=_,m|=c[(c[a]+c[d])%256]<<24-p*8}return this._i=a,this._j=d,m}n.RC4=o._createHelper(f);var i=x.RC4Drop=f.extend({cfg:f.cfg.extend({drop:192}),_doReset:function(){f._doReset.call(this);for(var c=this.cfg.drop;c>0;c--)l.call(this)}});n.RC4Drop=o._createHelper(i)}(),r.RC4})}(F0)),F0.exports}var L0={exports:{}},Hn;function Zd(){return Hn||(Hn=1,function(e,t){(function(r,n,s){e.exports=n(j(),rt(),nt(),Ke(),xe())})(X,function(r){return function(){var n=r,s=n.lib,o=s.StreamCipher,x=n.algo,f=[],l=[],i=[],c=x.Rabbit=o.extend({_doReset:function(){for(var d=this._key.words,m=this.cfg.iv,p=0;p<4;p++)d[p]=(d[p]<<8|d[p]>>>24)&16711935|(d[p]<<24|d[p]>>>8)&4278255360;var _=this._X=[d[0],d[3]<<16|d[2]>>>16,d[1],d[0]<<16|d[3]>>>16,d[2],d[1]<<16|d[0]>>>16,d[3],d[2]<<16|d[1]>>>16],y=this._C=[d[2]<<16|d[2]>>>16,d[0]&4294901760|d[1]&65535,d[3]<<16|d[3]>>>16,d[1]&4294901760|d[2]&65535,d[0]<<16|d[0]>>>16,d[2]&4294901760|d[3]&65535,d[1]<<16|d[1]>>>16,d[3]&4294901760|d[0]&65535];this._b=0;for(var p=0;p<4;p++)a.call(this);for(var p=0;p<8;p++)y[p]^=_[p+4&7];if(m){var E=m.words,g=E[0],v=E[1],b=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,w=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,A=b>>>16|w&4294901760,T=w<<16|b&65535;y[0]^=b,y[1]^=A,y[2]^=w,y[3]^=T,y[4]^=b,y[5]^=A,y[6]^=w,y[7]^=T;for(var p=0;p<4;p++)a.call(this)}},_doProcessBlock:function(d,m){var p=this._X;a.call(this),f[0]=p[0]^p[5]>>>16^p[3]<<16,f[1]=p[2]^p[7]>>>16^p[5]<<16,f[2]=p[4]^p[1]>>>16^p[7]<<16,f[3]=p[6]^p[3]>>>16^p[1]<<16;for(var _=0;_<4;_++)f[_]=(f[_]<<8|f[_]>>>24)&16711935|(f[_]<<24|f[_]>>>8)&4278255360,d[m+_]^=f[_]},blockSize:128/32,ivSize:64/32});function a(){for(var d=this._X,m=this._C,p=0;p<8;p++)l[p]=m[p];m[0]=m[0]+1295307597+this._b|0,m[1]=m[1]+3545052371+(m[0]>>>0<l[0]>>>0?1:0)|0,m[2]=m[2]+886263092+(m[1]>>>0<l[1]>>>0?1:0)|0,m[3]=m[3]+1295307597+(m[2]>>>0<l[2]>>>0?1:0)|0,m[4]=m[4]+3545052371+(m[3]>>>0<l[3]>>>0?1:0)|0,m[5]=m[5]+886263092+(m[4]>>>0<l[4]>>>0?1:0)|0,m[6]=m[6]+1295307597+(m[5]>>>0<l[5]>>>0?1:0)|0,m[7]=m[7]+3545052371+(m[6]>>>0<l[6]>>>0?1:0)|0,this._b=m[7]>>>0<l[7]>>>0?1:0;for(var p=0;p<8;p++){var _=d[p]+m[p],y=_&65535,E=_>>>16,g=((y*y>>>17)+y*E>>>15)+E*E,v=((_&4294901760)*_|0)+((_&65535)*_|0);i[p]=g^v}d[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,d[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,d[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,d[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,d[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,d[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,d[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,d[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}n.Rabbit=o._createHelper(c)}(),r.Rabbit})}(L0)),L0.exports}var O0={exports:{}},Fn;function jd(){return Fn||(Fn=1,function(e,t){(function(r,n,s){e.exports=n(j(),rt(),nt(),Ke(),xe())})(X,function(r){return function(){var n=r,s=n.lib,o=s.StreamCipher,x=n.algo,f=[],l=[],i=[],c=x.RabbitLegacy=o.extend({_doReset:function(){var d=this._key.words,m=this.cfg.iv,p=this._X=[d[0],d[3]<<16|d[2]>>>16,d[1],d[0]<<16|d[3]>>>16,d[2],d[1]<<16|d[0]>>>16,d[3],d[2]<<16|d[1]>>>16],_=this._C=[d[2]<<16|d[2]>>>16,d[0]&4294901760|d[1]&65535,d[3]<<16|d[3]>>>16,d[1]&4294901760|d[2]&65535,d[0]<<16|d[0]>>>16,d[2]&4294901760|d[3]&65535,d[1]<<16|d[1]>>>16,d[3]&4294901760|d[0]&65535];this._b=0;for(var y=0;y<4;y++)a.call(this);for(var y=0;y<8;y++)_[y]^=p[y+4&7];if(m){var E=m.words,g=E[0],v=E[1],b=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,w=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,A=b>>>16|w&4294901760,T=w<<16|b&65535;_[0]^=b,_[1]^=A,_[2]^=w,_[3]^=T,_[4]^=b,_[5]^=A,_[6]^=w,_[7]^=T;for(var y=0;y<4;y++)a.call(this)}},_doProcessBlock:function(d,m){var p=this._X;a.call(this),f[0]=p[0]^p[5]>>>16^p[3]<<16,f[1]=p[2]^p[7]>>>16^p[5]<<16,f[2]=p[4]^p[1]>>>16^p[7]<<16,f[3]=p[6]^p[3]>>>16^p[1]<<16;for(var _=0;_<4;_++)f[_]=(f[_]<<8|f[_]>>>24)&16711935|(f[_]<<24|f[_]>>>8)&4278255360,d[m+_]^=f[_]},blockSize:128/32,ivSize:64/32});function a(){for(var d=this._X,m=this._C,p=0;p<8;p++)l[p]=m[p];m[0]=m[0]+1295307597+this._b|0,m[1]=m[1]+3545052371+(m[0]>>>0<l[0]>>>0?1:0)|0,m[2]=m[2]+886263092+(m[1]>>>0<l[1]>>>0?1:0)|0,m[3]=m[3]+1295307597+(m[2]>>>0<l[2]>>>0?1:0)|0,m[4]=m[4]+3545052371+(m[3]>>>0<l[3]>>>0?1:0)|0,m[5]=m[5]+886263092+(m[4]>>>0<l[4]>>>0?1:0)|0,m[6]=m[6]+1295307597+(m[5]>>>0<l[5]>>>0?1:0)|0,m[7]=m[7]+3545052371+(m[6]>>>0<l[6]>>>0?1:0)|0,this._b=m[7]>>>0<l[7]>>>0?1:0;for(var p=0;p<8;p++){var _=d[p]+m[p],y=_&65535,E=_>>>16,g=((y*y>>>17)+y*E>>>15)+E*E,v=((_&4294901760)*_|0)+((_&65535)*_|0);i[p]=g^v}d[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,d[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,d[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,d[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,d[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,d[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,d[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,d[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}n.RabbitLegacy=o._createHelper(c)}(),r.RabbitLegacy})}(O0)),O0.exports}(function(e,t){(function(r,n,s){e.exports=n(j(),Gt(),Td(),Bd(),rt(),Pd(),nt(),hr(),ys(),Dd(),Ss(),Rd(),Id(),Md(),fr(),Nd(),Ke(),xe(),Hd(),Fd(),Ld(),Od(),Ud(),Wd(),Gd(),zd(),qd(),Yd(),Vd(),Kd(),Xd(),$d(),Zd(),jd())})(X,function(r){return r})})(Ed);var ge;(e=>{e.DEFEAT_THE_EYE_KEEPER=72391,e.DEFEAT_THE_KILLER_OF_PETALS=72392,e.GET_A_COMPANION=72393,e.WIN_STREAK_3=72394,e.WIN_STREAK_5=72395,e.WIN_STREAK_10=72396,e.HALF_MILL=72397,e.ONE_MILL=72398,e.CHAIN_10=72399,e.CHAIN_20=72400,e.CHAIN_30=72401})(ge||(ge={}));var Ht;(e=>{e.ONE_PLAYER=12443,e.TWO_PLAYER=12444})(Ht||(Ht={}));function Qd(e,t){e!==void 0&&(t.winStreak>=3&&e.unlockMedal(ge.WIN_STREAK_3),t.winStreak>=5&&e.unlockMedal(ge.WIN_STREAK_5),t.winStreak>=10&&e.unlockMedal(ge.WIN_STREAK_10),t.gameProgress==="win"?(e.unlockMedal(ge.DEFEAT_THE_EYE_KEEPER),e.unlockMedal(ge.DEFEAT_THE_KILLER_OF_PETALS)):t.gameProgress==="eye"&&e.unlockMedal(ge.DEFEAT_THE_EYE_KEEPER),t.getHighScore(1)>=5e5&&e.unlockMedal(ge.HALF_MILL),t.getHighScore(1)>=1e6&&e.unlockMedal(ge.ONE_MILL),t.scorePosted||(t.getHighScore(1)>0&&e.postScore(Ht.ONE_PLAYER,t.getHighScore(1),t),t.getHighScore(2)>0&&e.postScore(Ht.TWO_PLAYER,t.getHighScore(2),t)))}const Es="itch",{canvas:Jd,gl:Et}=Sl(),ws=new bt(Et,pe),eh=new yd(Et,ws),se=new Xl(Et,ws),Ve=void 0,Y=new vl(Es==="development");G.updateAllSettings(Y);Qd(Ve,Y);const Z0=new Hl(Et),Ln=e=>u.Nudge.is(e)&&!Y0(e),U0=new md(Et,eh,se,Z0),Ye=new Lc(ft,h(8,4)),th=34;function rh(e,t,r){let n=e+t.leftoverTime,s=0;for(;n>t.scaledStepMs;)r(),n-=t.scaledStepMs,s++;return[n,s]}const xt=new rl,As=new ol,zt=new J;u.Sprite.add(zt,Oc(O.whiteDot,qe));u.Ticks.add(zt);u.Rainbow.add(zt,{ticksPerCycle:1e3});const nh=32;function W0(e){const t=e===1?L.rgb(1,0,0):L.rgb(0,1,1),r=new J;return u.Pos.add(r,pe.divComps(-2,2).addComps(3+(e===2?nh:0),0)),u.Text.add(r,{message:"",hAlign:"left",vAlign:"top",hSpacing:0,color:t.setBrightnesses(1,0,-.5),func:n=>n instanceof rr?`\u2665${n.getPlayer(e)?.player.health??0}`:""}),r}const ks=new vt(Jd,pe),sh=new Vn(0,.1,.9,32),oh=new Vn(1,.1,.9,32),ze=new bo(ks,sh,oh),C=new rr(ze);ks.addFullscreenExitCallback(()=>{if(ze.get(1,C.numPlayers)instanceof vt&&C.gameState===_e.TITLE){const e=mt(`in browsers, esc always exits fullscreen.
please use q/p when in fullscreen for menu
navigation and pausing. thanks!`,L.named("white"),C,!0);u.Sprite.add(e,[{spriteSheet:O.whiteDot,frame:0,scale:h(210,18),depth:Ie-.001,color:L.named("black").setBrightnesses(.3,.2,0)}])}});function ah(){if(C.gameState===_e.PLAY){const e=new ul(()=>{Cs()},()=>{j0(C,C.numPlayers)},()=>{qt(C)});C.forceSpawn(e.entity),C.setGameState(_e.PAUSE)}}function Cs(){C.gameState===_e.PAUSE&&(C.filterEntities(e=>!u.Named.is(e)||e.named!==hl),C.setGameState(_e.PLAY))}document.addEventListener("mousedown",()=>{C.filterEntities(e=>!u.Named.is(e)||e.named!==_s)},{once:!0});let On=0;function Ts(e){e.spawnerOrEnemyCount=0,e.bossTotalHealth=0,e.bossCurrentHealth=0,e.bossName="",e.lastWaveResult=void 0,e.resetHyper(),e.resetLuck(),e.points=0,e.roundTimer=0,e.waveHits=0,e.chain=1,e.clearPlayers(),e.spawner=void 0,e.clearActiveAndSpawnedEntities()}function Un(){C.animateUniform(se.blendAmount,0,1e3),C.animateUniform(se.blendColor,[1,1,1],1e3),It(C,"dark",se)}function qt(e){let t;if(Y.saveSettingsJson(),Y.isCustomGame())Y.customHighScore<e.points&&(Y.customHighScore=e.points);else{const v=e.numPlayers;Y.getHighScore(v)<e.points&&(Y.setHighScore(e.points,v),t={players:v,score:e.points})}if(Y.inProgress&&!Y.isCustomGame()&&Y.setWinStreak(0),Y.setInProgress(!1),e.setGameState(_e.TITLE),Un(),e.resetSlowMo(),Ts(e),_t(e,.25,2e3,se),t!==void 0){const v=mt(`new ${t.players}p hi score!
${t.score}`,L.rgb(1,0,0).setBrightnesses(...me),e,!1);u.Rainbow.add(v,{ticksPerCycle:100})}const r=()=>j0(e,1),n=()=>j0(e,2),s=()=>{document.body.requestFullscreen()},o=er.copy(),x=qn.copy(),f=new ad(r,n,s,()=>qt(e),()=>Un(),e,o,x,Y,Es==="development");f.spawn(e);const l=fd();e.spawn(l),e.spawn(pd()),Y.gameProgress==="none"&&e.spawn(xd()),e.spawn(hd(Y));const i=Y.gameProgress==="eye"?[.2,.054901960784313725,.21176470588235294]:L.named("aliceblue").data,c=Y.gameProgress==="eye"?[.09803921568627451,.054901960784313725,.1803921568627451]:L.named("pink").data,a=Y.gameProgress==="eye"?L.named("purple").data:L.named("magenta").data,d=Y.gameProgress==="eye"?450:400,m=Y.gameProgress==="eye"?.8:.2,p=Y.gameProgress==="eye"?5:.2,_=Y.gameProgress==="eye"?"deader petals":`\u2665${Zl.pick()} petals\u2665`,y=Y.gameProgress==="eye",E=Y.gameProgress==="eye"?V.EYE_OPEN:V.EYE_OPEN_WIN;e.titleScreenFirstTime&&e.spawn(ud());const g=Ql(h(0,90),Y.gameProgress!=="none",d,()=>{e.animateUniform(se.color1Uniform,i,1e3),e.animateUniform(se.color2Uniform,c,1e3),_t(e,p,2e3,se),e.animateUniform(se.blendColor,a,1e3),e.animateUniform(se.blendAmount,m,1e3),f.setTitle(_),f.unblock(),y&&(l.text.message=`V6.6.6
FIND IT KILL IT`),V.play(E)});e.forceSpawn(g),e.titleScreenFirstTime=!1}function Wn(e){const t=e===1?2:1,r=C.getPlayer(e),n=C.getPlayer(t),s=ze.get(e,C.numPlayers);if(r===void 0&&n!==void 0&&n.player.health>1&&s!==void 0&&s.controlState.primaryButton.pressed){const o=Rt(e,Q);o.player.invincibilityTicks=o.player.invincibilityMax,o.player.health=1,C.setPlayer(o),C.spawn(o),n.player.health--}}function j0(e,t){if(ie(G.speakBossNames)&&gs("Victoria",""),Ts(e),Y.inProgress?Y.setWinStreak(0):Y.isCustomGame()||Y.setInProgress(!0),e.animateUniform(se.blendColor,[1,1,1],1e3),e.animateUniform(se.blendAmount,0,1e3),e.setGameState(_e.PLAY),e.filterEntities(()=>!1),e.spawn(zt,As.entity,xt.entity,Bi(h(0,pe.y/2)),nl()),t===1){const r=Rt(1,Q);e.setPlayer(r),e.numPlayers=1;const n=W0(1);e.spawn(r,n)}else{const r=Rt(1,h(-32,0)),n=Rt(2,h(32,0));e.setPlayer(r),e.setPlayer(n),e.numPlayers=2;const s=W0(1),o=W0(2);e.spawn(r,s,n,o)}e.spawner=new Gl(ie(G.normalEnemiesGenerated),ie(G.numBosses),0,ie(G.maxDifficulty),ie(G.wavesPerLevel)+1,G.maxWaveSize.min,ie(G.maxWaveSize),ie(G.normalEnemyWindow),Y.gameProgress==="eye"||Y.gameProgress==="win")}function Gn(e){C.animateUniform(se.blendAmount,1,3e3),C.animateUniform(se.blendColor,e==="win"?[2,2,2]:[.1,.1,.1],3e3),_t(C,.1,3e3,se),C.spawn($l(1e3,()=>{qt(C)}))}qt(C);function Bs(e){U0.ready();const t=Math.min(e-On,th),[r,n]=rh(t,C,()=>{if(C.points,ze.update(),ze.get(1,C.numPlayers)?.controlState.start.pressed&&(C.gameState===_e.PLAY?ah():C.gameState===_e.PAUSE&&Cs()),C.gameState===_e.PLAY&&C.numPlayers===2&&(Wn(1),Wn(2)),we.menu(C,ze),C.gameState!==_e.PAUSE){if(pt.beginStep(C,ze),we.move(C,gt.STEP_MS),we.setupSpatialHash(C,Ye),we.collide(Ye,s=>H.BulletCancel.is(s),s=>H.Bullet.is(s)&&s.bullet.team==="enemy",(s,o)=>{u.Destroyed.add(o),s.bulletCancel?u.SpawnOnDestroy.add(o,Ta):H.Disappeared.add(o)}),we.collide(Ye,s=>H.Player.is(s)||H.Charmed.is(s),s=>H.Bullet.is(s)&&s.bullet.team==="enemy"||H.Gem.is(s)||H.BossDrop.is(s)&&!u.Destroyed.is(s)&&s.ticks>qc,(s,o)=>{if(H.Gem.is(o)){u.Destroyed.add(o),C.addHyper(ie(G.hyperGain)*o.gem),C.points+=o.gem*Ca;for(let l=0;l<3;l++)C.spawn(Le.sparkle(o.pos,"rainbow"));H.Explode.remove(o),V.play(V.GEM_COLLECT);return}if(H.BossDrop.is(o)){if(H.Player.is(s)){switch(o.bossDrop.type){case"health":s.player.health+=o.bossDrop.amount;break;case"hyper":C.addHyper(o.bossDrop.amount);break;case"companion":if(C.spawner!==void 0){const l=sl(Q,C.spawner,o.bossDrop.amount);C.spawn(...l)}else console.warn("no spawner");!Y.isCustomGame()&&Ve!==void 0&&Ve.unlockMedal(ge.GET_A_COMPANION);break;case"luck":C.addLuck(o.bossDrop.amount);break;case"eye":Y.setInProgress(!1),Y.isCustomGame()||(Y.gameProgress==="none"?Y.setGameProgress("eye"):Y.gameProgress==="eye"&&Y.setGameProgress("win"),Y.setWinStreak(Y.winStreak+1)),Gn("win");break}C.forEachEntityWithCriteria(l=>{u.Destroyed.add(l)},l=>H.BossDrop.is(l)),V.play(V.ZOOP)}return}const f=o.bullet.damage;H.Player.is(s)?$a(s,f)&&(C.tempSlowMo(15,.025),C.spawn(ts(s.pos,!1)),C.waveHits++,C.chain=1,u.Destroyed.is(s)||ie(G.flashOnHit)&&(se.blendColor.set([1,1,1]),se.blendAmount.set(1),C.animateUniform(se.blendAmount,0,2e3)),V.play(V.PLAYER_HIT),Z0.aberration.set(16),C.animateUniform(Z0.aberration,0,2e3),H.DidDamage.add(o),u.Destroyed.add(o)):H.Charmed.is(s)&&(H.Health.is(s)&&(s.health-=f,Wr(s),s.health<=0&&(V.play(V.ENEMY_EXPLOSION),u.Destroyed.add(s))),H.DidDamage.add(o),u.Destroyed.add(o))}),we.collide(Ye,s=>H.Enemy.is(s),s=>H.Bullet.is(s)&&s.bullet.team==="player",(s,o)=>{const f=o.bullet.damage;if(H.Health.is(s)&&(s.health-=f,Wr(s),H.Shadow.is(s)&&u.Vel.is(s)&&(s.vel=s.vel.multComps(Mc)),s.health<=0&&!u.Destroyed.is(s))){if(V.play(V.ENEMY_EXPLOSION),C?.spawner?.trueFinalBossUnlocked===!0&&!u.Destroyed.is(s)&&!H.Shadow.is(s)&&!H.Boss.is(s)&&Math.random()<ie(G.shadowChance)&&C.spawn(Hc(s)),u.Destroyed.add(s),H.Points.is(s)&&u.Ticks.is(s)){let i=1,c=!1;C.hyperDraining&&(c=!0,i=C.chain,V.play(V.makeChainSound(i)));const a=s.points,d=H.Boss.is(s)?cs:vi,m=Math.max(d-s.ticks,0)/d,p=Math.floor(m*a);p>0&&(c||V.play(V.makeQuickKillSound(m)),C.spawn(V0(s.pos,2))),C.spawn(ht(s.pos,a,!1,[1,1,1],[0,0,0]));let _=-6;p>0&&(C.spawn(ht(s.pos.addComps(0,_),p,!0,[1,1,0],[.5,.5,0])),_-=6),c&&C.spawn(ht(s.pos.addComps(0,_),i,!1,[1,.5,.5],[1,.2,.2],!0,"chain ")),C.points+=(a+p)*i,C.chain++,!Y.isCustomGame()&&Ve!==void 0&&(C.chain===10?Ve.unlockMedal(ge.CHAIN_10):C.chain===20?Ve.unlockMedal(ge.CHAIN_20):C.chain===30&&Ve.unlockMedal(ge.CHAIN_30))}const l=H.Boss.is(s)?10:3;for(let i=0;i<l;i++)C.spawn(V0(s.pos,1));if(H.Boss.is(s)){const i=s.boss.dropsEye??!1;if(!s.boss.final&&!i){const c=[];(C.luck>=is||C.lastWaveResult===Re.BOSS_RUSH)&&c.push("luck");const a=C.lastWaveResult===Re.BOSS_RUSH?1:void 0,d=C.waveHits===0?1:0;C.spawn(...el(C.luck+d,s.pos,c,a))}else s.boss.final?C.spawn(X0(s.pos,"eye",1)):C.spawn(X0(s.pos,"eye",0))}}H.DidDamage.add(o),u.Destroyed.add(o)}),we.collide(Ye,Ln,Ln,(s,o)=>{const x=s,f=x.pos.sub(o.pos),l=.5*(x.circleCollider+o.circleCollider-f.length);x.nudge.length<l&&(x.nudge=f.normalize()?.multComps(l)??h((Math.random()-.5)*.001,(Math.random()-.5)*.001))}),we.tick(C),we.endStep(C,Ye),pt.endStep(C,Ye,ze),C.lastWaveResult!==Re.DONE&&C.spawnerOrEnemyCount===0&&C.spawner!==void 0&&!C.bossDropActive){const s=C.lastWaveResult===Re.FINAL_BOSS&&(Y.gameProgress==="eye"||Y.gameProgress==="win")?Si:yi,o=Math.max(C.roundTimer,0)*bi+s,x=C.getPlayer(1)??C.getPlayer(2);if(x!==void 0&&C.lastWaveResult!==void 0){const l=x.pos;C.spawn(ht(l,o,!0,[0,1,0],[0,.2,0],!1));const[i,c,a,d]=C.waveHits===0?[3,"no miss",Ei,wi]:C.waveHits===1?[2,"1 miss",Ai,ki]:[1,"no bonus",Ci,Ti];C.spawn(ht(l.addComps(0,-6),i,!1,a,d,!0,c+" ")),C.points+=o*i}C.roundTimer=gi,C.waveHits=0;const f=C.spawner.spawnNextWave(C);f===Re.DONE||(f===Re.NEW_LEVEL?(It(C,"random",se),zr(C,Gr,se),V.play(V.RISING_NOTES)):f===Re.BOSS_RUSH?It(C,"random",se):f===Re.BOSS?(V.play(V.SPOOKY_TRILLS),zc(C,Gr,se)):f===Re.FINAL_BOSS?(It(C,C.spawner.trueFinalBossUnlocked?"dark":"random",se),zr(C,Gc,se),V.play(V.COMPUTER)):V.play(V.PASSING_BY)),C.lastWaveResult=f}C.drainHyper(),C.roundTimer--,C.hyperDraining||(C.chain=1),C.removeDestroyedEntities(),C.gameState==_e.PLAY&&C.getPlayer(1)===void 0&&C.getPlayer(2)===void 0&&(Gn("lose"),Y.setInProgress(!1),Y.isCustomGame()||Y.setWinStreak(0)),C.activateSpawnedEntities(),C.stepSlowMo(),V.tickSounds()}});C.gameState!==_e.PAUSE?(C.leftoverTime=r,C.ticks+=n,C.realTime+=t,we.tween(C),se.ticksUniform.set(C.tweenedTicks)):C.activateSpawnedEntities(),On=e,C.bossTotalHealth>0?(xt.setHidden(!1),xt.setFill(C.bossCurrentHealth/C.bossTotalHealth),xt.setName(C.bossName)):xt.setHidden(!0),As.setNumber(C.hyperMeter),pt.onDraw(C),we.draw(C,U0),U0.draw(C.realTime),requestAnimationFrame(Bs)}requestAnimationFrame(Bs);
